(* TEST
   { native; }
*)
open Nativeint

let test_cases =
  let rng = Random.State.make_self_init () in
  (* sparse test cases, concentrated around 0, the limits, and powers of 2 *)
  List.init (size - 1) (fun size ->
      let bit = (shift_left one) size in
      let rand () =
        Random.State.nativeint_in_range rng
          ~min:(shift_right_logical bit 1)
          ~max:(pred bit)
      in
      ListLabels.concat_map
        [pred bit; bit; succ bit; rand ()]
        ~f:(fun x -> [x; lognot x; sub max_int x; lognot (sub max_int x)]))
  |> List.concat |> List.sort_uniq compare |> Array.of_list

let[@inline never] check_result ~dividend ~divisor ~quotient ~remainder =
  let[@inline] sign x = if x < 0n then -1 else if x = 0n then 0 else 1 in
  let identity = dividend = add (mul quotient divisor) remainder in
  let magnitude =
    if divisor = min_int
    then remainder <> min_int
    else abs remainder < abs divisor
  in
  let sign = (remainder = 0n || sign remainder = sign dividend) in
  if not (identity && magnitude && sign) then (
    Printf.fprintf
      stderr
      "FAILED: dividend=%nd, divisor=%nd, quotient=%nd, remainder=%nd\n%!"
      dividend
      divisor
      quotient
      remainder;
    exit 1)


(* test that the order of side effects are preserved in all cases *)

let[@inline never] test_effects f ~expect =
  let rev_effects = ref [] in
  let result =
    match f ~push:(fun x -> rev_effects := x :: !rev_effects) with
    | x -> `result x
    | exception exn -> `exn exn
  in
  let effects = List.rev (result :: !rev_effects) in
  assert (effects = expect)

let () =
  test_effects
    (fun ~push ->
      let[@inline never] divide_by_3 x =
        div
          (push `divisor;
           x)
          (push `dividend;
           3n)
      in
      divide_by_3 42n)
    ~expect:[`dividend; `divisor; `result 14n];
  test_effects
    (fun ~push ->
      div
        (push `divisor;
         42n)
        (push `dividend;
         3n))
    ~expect:[`dividend; `divisor; `result 14n];
  test_effects
    (fun ~push ->
      let[@inline never] divide_by_0 x =
        div
          (push `divisor;
           x)
          (push `dividend;
           0n)
      in
      divide_by_0 42n)
    ~expect:[`dividend; `divisor; `exn Division_by_zero];
  test_effects (fun ~push ->
      div
        (push `divisor;
         42n)
        (push `dividend;
         0n))
    ~expect:[`dividend; `divisor; `exn Division_by_zero]


(* Since [check] is always inlined, the division-by-constant optimization should
   trigger in every case when called with a literal ~divisor
*)
let[@inline always] check ~divisor =
  let[@inline always] quotient ~dividend = div dividend divisor in
  let[@inline always] remainder ~dividend = rem dividend divisor in
  ArrayLabels.iter test_cases ~f:(fun dividend ->
    check_result ~dividend ~divisor ~quotient:(quotient ~dividend)
      ~remainder:(remainder ~dividend))

(* manual tests *)

let () = check ~divisor:3n
let () = check ~divisor:(-3n)
let () = check ~divisor:5n
let () = check ~divisor:(-5n)
let () = check ~divisor:7n
let () = check ~divisor:(-7n)
let () = check ~divisor:65537n
let () = check ~divisor:(-65537n)

(* The following tests are generated by a manual run of test_cases with seed
   [[| int_size |]] to test against a hard-coded list of dividends. *)

let () = check ~divisor:0x1n
let () = check ~divisor:0x2n
let () = check ~divisor:0x3n
let () = check ~divisor:0x4n
let () = check ~divisor:0x5n
let () = check ~divisor:0x7n
let () = check ~divisor:0x8n
let () = check ~divisor:0x9n
let () = check ~divisor:0xen
let () = check ~divisor:0xfn
let () = check ~divisor:0x10n
let () = check ~divisor:0x11n
let () = check ~divisor:0x15n
let () = check ~divisor:0x1fn
let () = check ~divisor:0x20n
let () = check ~divisor:0x21n
let () = check ~divisor:0x39n
let () = check ~divisor:0x3fn
let () = check ~divisor:0x40n
let () = check ~divisor:0x41n
let () = check ~divisor:0x54n
let () = check ~divisor:0x7fn
let () = check ~divisor:0x80n
let () = check ~divisor:0x81n
let () = check ~divisor:0xa8n
let () = check ~divisor:0xffn
let () = check ~divisor:0x100n
let () = check ~divisor:0x101n
let () = check ~divisor:0x1b2n
let () = check ~divisor:0x1ffn
let () = check ~divisor:0x200n
let () = check ~divisor:0x201n
let () = check ~divisor:0x2c7n
let () = check ~divisor:0x3ffn
let () = check ~divisor:0x400n
let () = check ~divisor:0x401n
let () = check ~divisor:0x4d6n
let () = check ~divisor:0x7ffn
let () = check ~divisor:0x800n
let () = check ~divisor:0x801n
let () = check ~divisor:0xb15n
let () = check ~divisor:0xfffn
let () = check ~divisor:0x1000n
let () = check ~divisor:0x1001n
let () = check ~divisor:0x1017n
let () = check ~divisor:0x1fffn
let () = check ~divisor:0x2000n
let () = check ~divisor:0x2001n
let () = check ~divisor:0x33fbn
let () = check ~divisor:0x3fffn
let () = check ~divisor:0x4000n
let () = check ~divisor:0x4001n
let () = check ~divisor:0x45bfn
let () = check ~divisor:0x7fffn
let () = check ~divisor:0x8000n
let () = check ~divisor:0x8001n
let () = check ~divisor:0x846dn
let () = check ~divisor:0xffffn
let () = check ~divisor:0x10000n
let () = check ~divisor:0x10001n
let () = check ~divisor:0x199dbn
let () = check ~divisor:0x1ffffn
let () = check ~divisor:0x20000n
let () = check ~divisor:0x20001n
let () = check ~divisor:0x301f3n
let () = check ~divisor:0x3ffffn
let () = check ~divisor:0x40000n
let () = check ~divisor:0x40001n
let () = check ~divisor:0x5252dn
let () = check ~divisor:0x7ffffn
let () = check ~divisor:0x80000n
let () = check ~divisor:0x80001n
let () = check ~divisor:0x853f7n
let () = check ~divisor:0xfffffn
let () = check ~divisor:0x100000n
let () = check ~divisor:0x100001n
let () = check ~divisor:0x17364cn
let () = check ~divisor:0x1fffffn
let () = check ~divisor:0x200000n
let () = check ~divisor:0x200001n
let () = check ~divisor:0x2c0b6dn
let () = check ~divisor:0x3fffffn
let () = check ~divisor:0x400000n
let () = check ~divisor:0x400001n
let () = check ~divisor:0x472c65n
let () = check ~divisor:0x7fffffn
let () = check ~divisor:0x800000n
let () = check ~divisor:0x800001n
let () = check ~divisor:0xc922c8n
let () = check ~divisor:0xffffffn
let () = check ~divisor:0x1000000n
let () = check ~divisor:0x1000001n
let () = check ~divisor:0x13db6b8n
let () = check ~divisor:0x1ffffffn
let () = check ~divisor:0x2000000n
let () = check ~divisor:0x2000001n
let () = check ~divisor:0x234316en
let () = check ~divisor:0x3ffffffn
let () = check ~divisor:0x4000000n
let () = check ~divisor:0x4000001n
let () = check ~divisor:0x6417e4an
let () = check ~divisor:0x7ffffffn
let () = check ~divisor:0x8000000n
let () = check ~divisor:0x8000001n
let () = check ~divisor:0xf42bd1an
let () = check ~divisor:0xfffffffn
let () = check ~divisor:0x10000000n
let () = check ~divisor:0x10000001n
let () = check ~divisor:0x157f83d8n
let () = check ~divisor:0x1fffffffn
let () = check ~divisor:0x20000000n
let () = check ~divisor:0x20000001n
let () = check ~divisor:0x23fc9a89n
let () = check ~divisor:0x3fffffffn
let () = check ~divisor:0x40000000n
let () = check ~divisor:0x40000001n
let () = check ~divisor:0x606407cfn
let () = check ~divisor:0x7fffffffn
let () = check ~divisor:0x80000000n
let () = check ~divisor:0x80000001n
let () = check ~divisor:0xff459362n
let () = check ~divisor:0xffffffffn
let () = check ~divisor:0x100000000n
let () = check ~divisor:0x100000001n
let () = check ~divisor:0x16d2325een
let () = check ~divisor:0x1ffffffffn
let () = check ~divisor:0x200000000n
let () = check ~divisor:0x200000001n
let () = check ~divisor:0x215c110bfn
let () = check ~divisor:0x3ffffffffn
let () = check ~divisor:0x400000000n
let () = check ~divisor:0x400000001n
let () = check ~divisor:0x5027c5723n
let () = check ~divisor:0x7ffffffffn
let () = check ~divisor:0x800000000n
let () = check ~divisor:0x800000001n
let () = check ~divisor:0xd4d0827e3n
let () = check ~divisor:0xfffffffffn
let () = check ~divisor:0x1000000000n
let () = check ~divisor:0x1000000001n
let () = check ~divisor:0x15d1d001d9n
let () = check ~divisor:0x1fffffffffn
let () = check ~divisor:0x2000000000n
let () = check ~divisor:0x2000000001n
let () = check ~divisor:0x2820fa6d55n
let () = check ~divisor:0x3fffffffffn
let () = check ~divisor:0x4000000000n
let () = check ~divisor:0x4000000001n
let () = check ~divisor:0x4bfe819254n
let () = check ~divisor:0x7fffffffffn
let () = check ~divisor:0x8000000000n
let () = check ~divisor:0x8000000001n
let () = check ~divisor:0xd963cf14dbn
let () = check ~divisor:0xffffffffffn
let () = check ~divisor:0x10000000000n
let () = check ~divisor:0x10000000001n
let () = check ~divisor:0x140e77596edn
let () = check ~divisor:0x1ffffffffffn
let () = check ~divisor:0x20000000000n
let () = check ~divisor:0x20000000001n
let () = check ~divisor:0x2f02862416dn
let () = check ~divisor:0x3ffffffffffn
let () = check ~divisor:0x40000000000n
let () = check ~divisor:0x40000000001n
let () = check ~divisor:0x4d6529dd139n
let () = check ~divisor:0x7ffffffffffn
let () = check ~divisor:0x80000000000n
let () = check ~divisor:0x80000000001n
let () = check ~divisor:0xbc7a5d6d2efn
let () = check ~divisor:0xfffffffffffn
let () = check ~divisor:0x100000000000n
let () = check ~divisor:0x100000000001n
let () = check ~divisor:0x13e1e859d117n
let () = check ~divisor:0x1fffffffffffn
let () = check ~divisor:0x200000000000n
let () = check ~divisor:0x200000000001n
let () = check ~divisor:0x37449ec5407en
let () = check ~divisor:0x3fffffffffffn
let () = check ~divisor:0x400000000000n
let () = check ~divisor:0x400000000001n
let () = check ~divisor:0x4e37e6399ecfn
let () = check ~divisor:0x7fffffffffffn
let () = check ~divisor:0x800000000000n
let () = check ~divisor:0x800000000001n
let () = check ~divisor:0xbd55865839e2n
let () = check ~divisor:0xffffffffffffn
let () = check ~divisor:0x1000000000000n
let () = check ~divisor:0x1000000000001n
let () = check ~divisor:0x1c863e16a635dn
let () = check ~divisor:0x1ffffffffffffn
let () = check ~divisor:0x2000000000000n
let () = check ~divisor:0x2000000000001n
let () = check ~divisor:0x31b40893d1566n
let () = check ~divisor:0x3ffffffffffffn
let () = check ~divisor:0x4000000000000n
let () = check ~divisor:0x4000000000001n
let () = check ~divisor:0x7868b5768b820n
let () = check ~divisor:0x7ffffffffffffn
let () = check ~divisor:0x8000000000000n
let () = check ~divisor:0x8000000000001n
let () = check ~divisor:0xc98a65538b0dan
let () = check ~divisor:0xfffffffffffffn
let () = check ~divisor:0x10000000000000n
let () = check ~divisor:0x10000000000001n
let () = check ~divisor:0x19dfa30e2bc30en
let () = check ~divisor:0x1fffffffffffffn
let () = check ~divisor:0x20000000000000n
let () = check ~divisor:0x20000000000001n
let () = check ~divisor:0x2141bc1b7fd898n
let () = check ~divisor:0x3fffffffffffffn
let () = check ~divisor:0x40000000000000n
let () = check ~divisor:0x40000000000001n
let () = check ~divisor:0x47a1f2eef0007an
let () = check ~divisor:0x7fffffffffffffn
let () = check ~divisor:0x80000000000000n
let () = check ~divisor:0x80000000000001n
let () = check ~divisor:0xdd74b0801605c6n
let () = check ~divisor:0xffffffffffffffn
let () = check ~divisor:0x100000000000000n
let () = check ~divisor:0x100000000000001n
let () = check ~divisor:0x1828a556a36abc3n
let () = check ~divisor:0x1ffffffffffffffn
let () = check ~divisor:0x200000000000000n
let () = check ~divisor:0x200000000000001n
let () = check ~divisor:0x2a42f222c7d6b0cn
let () = check ~divisor:0x3ffffffffffffffn
let () = check ~divisor:0x400000000000000n
let () = check ~divisor:0x400000000000001n
let () = check ~divisor:0x44578a4bd765334n
let () = check ~divisor:0x7ffffffffffffffn
let () = check ~divisor:0x800000000000000n
let () = check ~divisor:0x800000000000001n
let () = check ~divisor:0xf3c26b221ceaa1dn
let () = check ~divisor:0xfffffffffffffffn
let () = check ~divisor:0x1000000000000000n
let () = check ~divisor:0x1000000000000001n
let () = check ~divisor:0x10056da6bfdde918n
let () = check ~divisor:0x1fffffffffffffffn
let () = check ~divisor:0x2000000000000000n
let () = check ~divisor:0x2000000000000001n
let () = check ~divisor:0x2d145e4f69d39854n
let () = check ~divisor:0x3ffffffffffffffen
let () = check ~divisor:0x3fffffffffffffffn
let () = check ~divisor:0x4000000000000000n
let () = check ~divisor:0x4000000000000001n
let () = check ~divisor:0x52eba1b0962c67abn
let () = check ~divisor:0x5ffffffffffffffen
let () = check ~divisor:0x5fffffffffffffffn
let () = check ~divisor:0x6000000000000000n
let () = check ~divisor:0x6ffa9259402216e7n
let () = check ~divisor:0x6ffffffffffffffen
let () = check ~divisor:0x6fffffffffffffffn
let () = check ~divisor:0x7000000000000000n
let () = check ~divisor:0x70c3d94dde3155e2n
let () = check ~divisor:0x77fffffffffffffen
let () = check ~divisor:0x77ffffffffffffffn
let () = check ~divisor:0x7800000000000000n
let () = check ~divisor:0x7bba875b4289accbn
let () = check ~divisor:0x7bfffffffffffffen
let () = check ~divisor:0x7bffffffffffffffn
let () = check ~divisor:0x7c00000000000000n
let () = check ~divisor:0x7d5bd0ddd38294f3n
let () = check ~divisor:0x7dfffffffffffffen
let () = check ~divisor:0x7dffffffffffffffn
let () = check ~divisor:0x7e00000000000000n
let () = check ~divisor:0x7e7d75aa95c9543cn
let () = check ~divisor:0x7efffffffffffffen
let () = check ~divisor:0x7effffffffffffffn
let () = check ~divisor:0x7f00000000000000n
let () = check ~divisor:0x7f228b4f7fe9fa39n
let () = check ~divisor:0x7f7ffffffffffffen
let () = check ~divisor:0x7f7fffffffffffffn
let () = check ~divisor:0x7f80000000000000n
let () = check ~divisor:0x7fb85e0d110fff85n
let () = check ~divisor:0x7fbffffffffffffen
let () = check ~divisor:0x7fbfffffffffffffn
let () = check ~divisor:0x7fc0000000000000n
let () = check ~divisor:0x7fdebe43e4802767n
let () = check ~divisor:0x7fdffffffffffffen
let () = check ~divisor:0x7fdfffffffffffffn
let () = check ~divisor:0x7fe0000000000000n
let () = check ~divisor:0x7fe6205cf1d43cf1n
let () = check ~divisor:0x7feffffffffffffen
let () = check ~divisor:0x7fefffffffffffffn
let () = check ~divisor:0x7ff0000000000000n
let () = check ~divisor:0x7ff36759aac74f25n
let () = check ~divisor:0x7ff7fffffffffffen
let () = check ~divisor:0x7ff7ffffffffffffn
let () = check ~divisor:0x7ff8000000000000n
let () = check ~divisor:0x7ff87974a89747dfn
let () = check ~divisor:0x7ffbfffffffffffen
let () = check ~divisor:0x7ffbffffffffffffn
let () = check ~divisor:0x7ffc000000000000n
let () = check ~divisor:0x7ffce4bf76c2ea99n
let () = check ~divisor:0x7ffdfffffffffffen
let () = check ~divisor:0x7ffdffffffffffffn
let () = check ~divisor:0x7ffe000000000000n
let () = check ~divisor:0x7ffe379c1e959ca2n
let () = check ~divisor:0x7ffefffffffffffen
let () = check ~divisor:0x7ffeffffffffffffn
let () = check ~divisor:0x7fff000000000000n
let () = check ~divisor:0x7fff42aa79a7c61dn
let () = check ~divisor:0x7fff7ffffffffffen
let () = check ~divisor:0x7fff7fffffffffffn
let () = check ~divisor:0x7fff800000000000n
let () = check ~divisor:0x7fffb1c819c66130n
let () = check ~divisor:0x7fffbffffffffffen
let () = check ~divisor:0x7fffbfffffffffffn
let () = check ~divisor:0x7fffc00000000000n
let () = check ~divisor:0x7fffc8bb613abf81n
let () = check ~divisor:0x7fffdffffffffffen
let () = check ~divisor:0x7fffdfffffffffffn
let () = check ~divisor:0x7fffe00000000000n
let () = check ~divisor:0x7fffec1e17a62ee8n
let () = check ~divisor:0x7fffeffffffffffen
let () = check ~divisor:0x7fffefffffffffffn
let () = check ~divisor:0x7ffff00000000000n
let () = check ~divisor:0x7ffff4385a292d10n
let () = check ~divisor:0x7ffff7fffffffffen
let () = check ~divisor:0x7ffff7ffffffffffn
let () = check ~divisor:0x7ffff80000000000n
let () = check ~divisor:0x7ffffb29ad622ec6n
let () = check ~divisor:0x7ffffbfffffffffen
let () = check ~divisor:0x7ffffbffffffffffn
let () = check ~divisor:0x7ffffc0000000000n
let () = check ~divisor:0x7ffffd0fd79dbe92n
let () = check ~divisor:0x7ffffdfffffffffen
let () = check ~divisor:0x7ffffdffffffffffn
let () = check ~divisor:0x7ffffe0000000000n
let () = check ~divisor:0x7ffffebf188a6912n
let () = check ~divisor:0x7ffffefffffffffen
let () = check ~divisor:0x7ffffeffffffffffn
let () = check ~divisor:0x7fffff0000000000n
let () = check ~divisor:0x7fffff269c30eb24n
let () = check ~divisor:0x7fffff7ffffffffen
let () = check ~divisor:0x7fffff7fffffffffn
let () = check ~divisor:0x7fffff8000000000n
let () = check ~divisor:0x7fffffb4017e6dabn
let () = check ~divisor:0x7fffffbffffffffen
let () = check ~divisor:0x7fffffbfffffffffn
let () = check ~divisor:0x7fffffc000000000n
let () = check ~divisor:0x7fffffd7df0592aan
let () = check ~divisor:0x7fffffdffffffffen
let () = check ~divisor:0x7fffffdfffffffffn
let () = check ~divisor:0x7fffffe000000000n
let () = check ~divisor:0x7fffffea2e2ffe26n
let () = check ~divisor:0x7fffffeffffffffen
let () = check ~divisor:0x7fffffefffffffffn
let () = check ~divisor:0x7ffffff000000000n
let () = check ~divisor:0x7ffffff2b2f7d81cn
let () = check ~divisor:0x7ffffff7fffffffen
let () = check ~divisor:0x7ffffff7ffffffffn
let () = check ~divisor:0x7ffffff800000000n
let () = check ~divisor:0x7ffffffafd83a8dcn
let () = check ~divisor:0x7ffffffbfffffffen
let () = check ~divisor:0x7ffffffbffffffffn
let () = check ~divisor:0x7ffffffc00000000n
let () = check ~divisor:0x7ffffffdea3eef40n
let () = check ~divisor:0x7ffffffdfffffffen
let () = check ~divisor:0x7ffffffdffffffffn
let () = check ~divisor:0x7ffffffe00000000n
let () = check ~divisor:0x7ffffffe92dcda11n
let () = check ~divisor:0x7ffffffefffffffen
let () = check ~divisor:0x7ffffffeffffffffn
let () = check ~divisor:0x7fffffff00000000n
let () = check ~divisor:0x7fffffff00ba6c9dn
let () = check ~divisor:0x7fffffff7ffffffen
let () = check ~divisor:0x7fffffff7fffffffn
let () = check ~divisor:0x7fffffff80000000n
let () = check ~divisor:0x7fffffff9f9bf830n
let () = check ~divisor:0x7fffffffbffffffen
let () = check ~divisor:0x7fffffffbfffffffn
let () = check ~divisor:0x7fffffffc0000000n
let () = check ~divisor:0x7fffffffdc036576n
let () = check ~divisor:0x7fffffffdffffffen
let () = check ~divisor:0x7fffffffdfffffffn
let () = check ~divisor:0x7fffffffe0000000n
let () = check ~divisor:0x7fffffffea807c27n
let () = check ~divisor:0x7fffffffeffffffen
let () = check ~divisor:0x7fffffffefffffffn
let () = check ~divisor:0x7ffffffff0000000n
let () = check ~divisor:0x7ffffffff0bd42e5n
let () = check ~divisor:0x7ffffffff7fffffen
let () = check ~divisor:0x7ffffffff7ffffffn
let () = check ~divisor:0x7ffffffff8000000n
let () = check ~divisor:0x7ffffffff9be81b5n
let () = check ~divisor:0x7ffffffffbfffffen
let () = check ~divisor:0x7ffffffffbffffffn
let () = check ~divisor:0x7ffffffffc000000n
let () = check ~divisor:0x7ffffffffdcbce91n
let () = check ~divisor:0x7ffffffffdfffffen
let () = check ~divisor:0x7ffffffffdffffffn
let () = check ~divisor:0x7ffffffffe000000n
let () = check ~divisor:0x7ffffffffec24947n
let () = check ~divisor:0x7ffffffffefffffen
let () = check ~divisor:0x7ffffffffeffffffn
let () = check ~divisor:0x7fffffffff000000n
let () = check ~divisor:0x7fffffffff36dd37n
let () = check ~divisor:0x7fffffffff7ffffen
let () = check ~divisor:0x7fffffffff7fffffn
let () = check ~divisor:0x7fffffffff800000n
let () = check ~divisor:0x7fffffffffb8d39an
let () = check ~divisor:0x7fffffffffbffffen
let () = check ~divisor:0x7fffffffffbfffffn
let () = check ~divisor:0x7fffffffffc00000n
let () = check ~divisor:0x7fffffffffd3f492n
let () = check ~divisor:0x7fffffffffdffffen
let () = check ~divisor:0x7fffffffffdfffffn
let () = check ~divisor:0x7fffffffffe00000n
let () = check ~divisor:0x7fffffffffe8c9b3n
let () = check ~divisor:0x7fffffffffeffffen
let () = check ~divisor:0x7fffffffffefffffn
let () = check ~divisor:0x7ffffffffff00000n
let () = check ~divisor:0x7ffffffffff7ac08n
let () = check ~divisor:0x7ffffffffff7fffen
let () = check ~divisor:0x7ffffffffff7ffffn
let () = check ~divisor:0x7ffffffffff80000n
let () = check ~divisor:0x7ffffffffffadad2n
let () = check ~divisor:0x7ffffffffffbfffen
let () = check ~divisor:0x7ffffffffffbffffn
let () = check ~divisor:0x7ffffffffffc0000n
let () = check ~divisor:0x7ffffffffffcfe0cn
let () = check ~divisor:0x7ffffffffffdfffen
let () = check ~divisor:0x7ffffffffffdffffn
let () = check ~divisor:0x7ffffffffffe0000n
let () = check ~divisor:0x7ffffffffffe6624n
let () = check ~divisor:0x7ffffffffffefffen
let () = check ~divisor:0x7ffffffffffeffffn
let () = check ~divisor:0x7fffffffffff0000n
let () = check ~divisor:0x7fffffffffff7b92n
let () = check ~divisor:0x7fffffffffff7ffen
let () = check ~divisor:0x7fffffffffff7fffn
let () = check ~divisor:0x7fffffffffff8000n
let () = check ~divisor:0x7fffffffffffba40n
let () = check ~divisor:0x7fffffffffffbffen
let () = check ~divisor:0x7fffffffffffbfffn
let () = check ~divisor:0x7fffffffffffc000n
let () = check ~divisor:0x7fffffffffffcc04n
let () = check ~divisor:0x7fffffffffffdffen
let () = check ~divisor:0x7fffffffffffdfffn
let () = check ~divisor:0x7fffffffffffe000n
let () = check ~divisor:0x7fffffffffffefe8n
let () = check ~divisor:0x7fffffffffffeffen
let () = check ~divisor:0x7fffffffffffefffn
let () = check ~divisor:0x7ffffffffffff000n
let () = check ~divisor:0x7ffffffffffff4ean
let () = check ~divisor:0x7ffffffffffff7fen
let () = check ~divisor:0x7ffffffffffff7ffn
let () = check ~divisor:0x7ffffffffffff800n
let () = check ~divisor:0x7ffffffffffffb29n
let () = check ~divisor:0x7ffffffffffffbfen
let () = check ~divisor:0x7ffffffffffffbffn
let () = check ~divisor:0x7ffffffffffffc00n
let () = check ~divisor:0x7ffffffffffffd38n
let () = check ~divisor:0x7ffffffffffffdfen
let () = check ~divisor:0x7ffffffffffffdffn
let () = check ~divisor:0x7ffffffffffffe00n
let () = check ~divisor:0x7ffffffffffffe4dn
let () = check ~divisor:0x7ffffffffffffefen
let () = check ~divisor:0x7ffffffffffffeffn
let () = check ~divisor:0x7fffffffffffff00n
let () = check ~divisor:0x7fffffffffffff57n
let () = check ~divisor:0x7fffffffffffff7en
let () = check ~divisor:0x7fffffffffffff7fn
let () = check ~divisor:0x7fffffffffffff80n
let () = check ~divisor:0x7fffffffffffffabn
let () = check ~divisor:0x7fffffffffffffben
let () = check ~divisor:0x7fffffffffffffbfn
let () = check ~divisor:0x7fffffffffffffc0n
let () = check ~divisor:0x7fffffffffffffc6n
let () = check ~divisor:0x7fffffffffffffden
let () = check ~divisor:0x7fffffffffffffdfn
let () = check ~divisor:0x7fffffffffffffe0n
let () = check ~divisor:0x7fffffffffffffean
let () = check ~divisor:0x7fffffffffffffeen
let () = check ~divisor:0x7fffffffffffffefn
let () = check ~divisor:0x7ffffffffffffff0n
let () = check ~divisor:0x7ffffffffffffff1n
let () = check ~divisor:0x7ffffffffffffff6n
let () = check ~divisor:0x7ffffffffffffff7n
let () = check ~divisor:0x7ffffffffffffff8n
let () = check ~divisor:0x7ffffffffffffffan
let () = check ~divisor:0x7ffffffffffffffbn
let () = check ~divisor:0x7ffffffffffffffcn
let () = check ~divisor:0x7ffffffffffffffdn
let () = check ~divisor:0x7ffffffffffffffen
let () = check ~divisor:0x7fffffffffffffffn
let () = check ~divisor:0x8000000000000000n
let () = check ~divisor:0x8000000000000001n
let () = check ~divisor:0x8000000000000002n
let () = check ~divisor:0x8000000000000003n
let () = check ~divisor:0x8000000000000004n
let () = check ~divisor:0x8000000000000005n
let () = check ~divisor:0x8000000000000007n
let () = check ~divisor:0x8000000000000008n
let () = check ~divisor:0x8000000000000009n
let () = check ~divisor:0x800000000000000en
let () = check ~divisor:0x800000000000000fn
let () = check ~divisor:0x8000000000000010n
let () = check ~divisor:0x8000000000000011n
let () = check ~divisor:0x8000000000000015n
let () = check ~divisor:0x800000000000001fn
let () = check ~divisor:0x8000000000000020n
let () = check ~divisor:0x8000000000000021n
let () = check ~divisor:0x8000000000000039n
let () = check ~divisor:0x800000000000003fn
let () = check ~divisor:0x8000000000000040n
let () = check ~divisor:0x8000000000000041n
let () = check ~divisor:0x8000000000000054n
let () = check ~divisor:0x800000000000007fn
let () = check ~divisor:0x8000000000000080n
let () = check ~divisor:0x8000000000000081n
let () = check ~divisor:0x80000000000000a8n
let () = check ~divisor:0x80000000000000ffn
let () = check ~divisor:0x8000000000000100n
let () = check ~divisor:0x8000000000000101n
let () = check ~divisor:0x80000000000001b2n
let () = check ~divisor:0x80000000000001ffn
let () = check ~divisor:0x8000000000000200n
let () = check ~divisor:0x8000000000000201n
let () = check ~divisor:0x80000000000002c7n
let () = check ~divisor:0x80000000000003ffn
let () = check ~divisor:0x8000000000000400n
let () = check ~divisor:0x8000000000000401n
let () = check ~divisor:0x80000000000004d6n
let () = check ~divisor:0x80000000000007ffn
let () = check ~divisor:0x8000000000000800n
let () = check ~divisor:0x8000000000000801n
let () = check ~divisor:0x8000000000000b15n
let () = check ~divisor:0x8000000000000fffn
let () = check ~divisor:0x8000000000001000n
let () = check ~divisor:0x8000000000001001n
let () = check ~divisor:0x8000000000001017n
let () = check ~divisor:0x8000000000001fffn
let () = check ~divisor:0x8000000000002000n
let () = check ~divisor:0x8000000000002001n
let () = check ~divisor:0x80000000000033fbn
let () = check ~divisor:0x8000000000003fffn
let () = check ~divisor:0x8000000000004000n
let () = check ~divisor:0x8000000000004001n
let () = check ~divisor:0x80000000000045bfn
let () = check ~divisor:0x8000000000007fffn
let () = check ~divisor:0x8000000000008000n
let () = check ~divisor:0x8000000000008001n
let () = check ~divisor:0x800000000000846dn
let () = check ~divisor:0x800000000000ffffn
let () = check ~divisor:0x8000000000010000n
let () = check ~divisor:0x8000000000010001n
let () = check ~divisor:0x80000000000199dbn
let () = check ~divisor:0x800000000001ffffn
let () = check ~divisor:0x8000000000020000n
let () = check ~divisor:0x8000000000020001n
let () = check ~divisor:0x80000000000301f3n
let () = check ~divisor:0x800000000003ffffn
let () = check ~divisor:0x8000000000040000n
let () = check ~divisor:0x8000000000040001n
let () = check ~divisor:0x800000000005252dn
let () = check ~divisor:0x800000000007ffffn
let () = check ~divisor:0x8000000000080000n
let () = check ~divisor:0x8000000000080001n
let () = check ~divisor:0x80000000000853f7n
let () = check ~divisor:0x80000000000fffffn
let () = check ~divisor:0x8000000000100000n
let () = check ~divisor:0x8000000000100001n
let () = check ~divisor:0x800000000017364cn
let () = check ~divisor:0x80000000001fffffn
let () = check ~divisor:0x8000000000200000n
let () = check ~divisor:0x8000000000200001n
let () = check ~divisor:0x80000000002c0b6dn
let () = check ~divisor:0x80000000003fffffn
let () = check ~divisor:0x8000000000400000n
let () = check ~divisor:0x8000000000400001n
let () = check ~divisor:0x8000000000472c65n
let () = check ~divisor:0x80000000007fffffn
let () = check ~divisor:0x8000000000800000n
let () = check ~divisor:0x8000000000800001n
let () = check ~divisor:0x8000000000c922c8n
let () = check ~divisor:0x8000000000ffffffn
let () = check ~divisor:0x8000000001000000n
let () = check ~divisor:0x8000000001000001n
let () = check ~divisor:0x80000000013db6b8n
let () = check ~divisor:0x8000000001ffffffn
let () = check ~divisor:0x8000000002000000n
let () = check ~divisor:0x8000000002000001n
let () = check ~divisor:0x800000000234316en
let () = check ~divisor:0x8000000003ffffffn
let () = check ~divisor:0x8000000004000000n
let () = check ~divisor:0x8000000004000001n
let () = check ~divisor:0x8000000006417e4an
let () = check ~divisor:0x8000000007ffffffn
let () = check ~divisor:0x8000000008000000n
let () = check ~divisor:0x8000000008000001n
let () = check ~divisor:0x800000000f42bd1an
let () = check ~divisor:0x800000000fffffffn
let () = check ~divisor:0x8000000010000000n
let () = check ~divisor:0x8000000010000001n
let () = check ~divisor:0x80000000157f83d8n
let () = check ~divisor:0x800000001fffffffn
let () = check ~divisor:0x8000000020000000n
let () = check ~divisor:0x8000000020000001n
let () = check ~divisor:0x8000000023fc9a89n
let () = check ~divisor:0x800000003fffffffn
let () = check ~divisor:0x8000000040000000n
let () = check ~divisor:0x8000000040000001n
let () = check ~divisor:0x80000000606407cfn
let () = check ~divisor:0x800000007fffffffn
let () = check ~divisor:0x8000000080000000n
let () = check ~divisor:0x8000000080000001n
let () = check ~divisor:0x80000000ff459362n
let () = check ~divisor:0x80000000ffffffffn
let () = check ~divisor:0x8000000100000000n
let () = check ~divisor:0x8000000100000001n
let () = check ~divisor:0x800000016d2325een
let () = check ~divisor:0x80000001ffffffffn
let () = check ~divisor:0x8000000200000000n
let () = check ~divisor:0x8000000200000001n
let () = check ~divisor:0x8000000215c110bfn
let () = check ~divisor:0x80000003ffffffffn
let () = check ~divisor:0x8000000400000000n
let () = check ~divisor:0x8000000400000001n
let () = check ~divisor:0x80000005027c5723n
let () = check ~divisor:0x80000007ffffffffn
let () = check ~divisor:0x8000000800000000n
let () = check ~divisor:0x8000000800000001n
let () = check ~divisor:0x8000000d4d0827e3n
let () = check ~divisor:0x8000000fffffffffn
let () = check ~divisor:0x8000001000000000n
let () = check ~divisor:0x8000001000000001n
let () = check ~divisor:0x80000015d1d001d9n
let () = check ~divisor:0x8000001fffffffffn
let () = check ~divisor:0x8000002000000000n
let () = check ~divisor:0x8000002000000001n
let () = check ~divisor:0x8000002820fa6d55n
let () = check ~divisor:0x8000003fffffffffn
let () = check ~divisor:0x8000004000000000n
let () = check ~divisor:0x8000004000000001n
let () = check ~divisor:0x8000004bfe819254n
let () = check ~divisor:0x8000007fffffffffn
let () = check ~divisor:0x8000008000000000n
let () = check ~divisor:0x8000008000000001n
let () = check ~divisor:0x800000d963cf14dbn
let () = check ~divisor:0x800000ffffffffffn
let () = check ~divisor:0x8000010000000000n
let () = check ~divisor:0x8000010000000001n
let () = check ~divisor:0x80000140e77596edn
let () = check ~divisor:0x800001ffffffffffn
let () = check ~divisor:0x8000020000000000n
let () = check ~divisor:0x8000020000000001n
let () = check ~divisor:0x800002f02862416dn
let () = check ~divisor:0x800003ffffffffffn
let () = check ~divisor:0x8000040000000000n
let () = check ~divisor:0x8000040000000001n
let () = check ~divisor:0x800004d6529dd139n
let () = check ~divisor:0x800007ffffffffffn
let () = check ~divisor:0x8000080000000000n
let () = check ~divisor:0x8000080000000001n
let () = check ~divisor:0x80000bc7a5d6d2efn
let () = check ~divisor:0x80000fffffffffffn
let () = check ~divisor:0x8000100000000000n
let () = check ~divisor:0x8000100000000001n
let () = check ~divisor:0x800013e1e859d117n
let () = check ~divisor:0x80001fffffffffffn
let () = check ~divisor:0x8000200000000000n
let () = check ~divisor:0x8000200000000001n
let () = check ~divisor:0x800037449ec5407en
let () = check ~divisor:0x80003fffffffffffn
let () = check ~divisor:0x8000400000000000n
let () = check ~divisor:0x8000400000000001n
let () = check ~divisor:0x80004e37e6399ecfn
let () = check ~divisor:0x80007fffffffffffn
let () = check ~divisor:0x8000800000000000n
let () = check ~divisor:0x8000800000000001n
let () = check ~divisor:0x8000bd55865839e2n
let () = check ~divisor:0x8000ffffffffffffn
let () = check ~divisor:0x8001000000000000n
let () = check ~divisor:0x8001000000000001n
let () = check ~divisor:0x8001c863e16a635dn
let () = check ~divisor:0x8001ffffffffffffn
let () = check ~divisor:0x8002000000000000n
let () = check ~divisor:0x8002000000000001n
let () = check ~divisor:0x80031b40893d1566n
let () = check ~divisor:0x8003ffffffffffffn
let () = check ~divisor:0x8004000000000000n
let () = check ~divisor:0x8004000000000001n
let () = check ~divisor:0x8007868b5768b820n
let () = check ~divisor:0x8007ffffffffffffn
let () = check ~divisor:0x8008000000000000n
let () = check ~divisor:0x8008000000000001n
let () = check ~divisor:0x800c98a65538b0dan
let () = check ~divisor:0x800fffffffffffffn
let () = check ~divisor:0x8010000000000000n
let () = check ~divisor:0x8010000000000001n
let () = check ~divisor:0x8019dfa30e2bc30en
let () = check ~divisor:0x801fffffffffffffn
let () = check ~divisor:0x8020000000000000n
let () = check ~divisor:0x8020000000000001n
let () = check ~divisor:0x802141bc1b7fd898n
let () = check ~divisor:0x803fffffffffffffn
let () = check ~divisor:0x8040000000000000n
let () = check ~divisor:0x8040000000000001n
let () = check ~divisor:0x8047a1f2eef0007an
let () = check ~divisor:0x807fffffffffffffn
let () = check ~divisor:0x8080000000000000n
let () = check ~divisor:0x8080000000000001n
let () = check ~divisor:0x80dd74b0801605c6n
let () = check ~divisor:0x80ffffffffffffffn
let () = check ~divisor:0x8100000000000000n
let () = check ~divisor:0x8100000000000001n
let () = check ~divisor:0x81828a556a36abc3n
let () = check ~divisor:0x81ffffffffffffffn
let () = check ~divisor:0x8200000000000000n
let () = check ~divisor:0x8200000000000001n
let () = check ~divisor:0x82a42f222c7d6b0cn
let () = check ~divisor:0x83ffffffffffffffn
let () = check ~divisor:0x8400000000000000n
let () = check ~divisor:0x8400000000000001n
let () = check ~divisor:0x844578a4bd765334n
let () = check ~divisor:0x87ffffffffffffffn
let () = check ~divisor:0x8800000000000000n
let () = check ~divisor:0x8800000000000001n
let () = check ~divisor:0x8f3c26b221ceaa1dn
let () = check ~divisor:0x8fffffffffffffffn
let () = check ~divisor:0x9000000000000000n
let () = check ~divisor:0x9000000000000001n
let () = check ~divisor:0x90056da6bfdde918n
let () = check ~divisor:0x9fffffffffffffffn
let () = check ~divisor:0xa000000000000000n
let () = check ~divisor:0xa000000000000001n
let () = check ~divisor:0xad145e4f69d39854n
let () = check ~divisor:0xbffffffffffffffen
let () = check ~divisor:0xbfffffffffffffffn
let () = check ~divisor:0xc000000000000000n
let () = check ~divisor:0xc000000000000001n
let () = check ~divisor:0xd2eba1b0962c67abn
let () = check ~divisor:0xdffffffffffffffen
let () = check ~divisor:0xdfffffffffffffffn
let () = check ~divisor:0xe000000000000000n
let () = check ~divisor:0xeffa9259402216e7n
let () = check ~divisor:0xeffffffffffffffen
let () = check ~divisor:0xefffffffffffffffn
let () = check ~divisor:0xf000000000000000n
let () = check ~divisor:0xf0c3d94dde3155e2n
let () = check ~divisor:0xf7fffffffffffffen
let () = check ~divisor:0xf7ffffffffffffffn
let () = check ~divisor:0xf800000000000000n
let () = check ~divisor:0xfbba875b4289accbn
let () = check ~divisor:0xfbfffffffffffffen
let () = check ~divisor:0xfbffffffffffffffn
let () = check ~divisor:0xfc00000000000000n
let () = check ~divisor:0xfd5bd0ddd38294f3n
let () = check ~divisor:0xfdfffffffffffffen
let () = check ~divisor:0xfdffffffffffffffn
let () = check ~divisor:0xfe00000000000000n
let () = check ~divisor:0xfe7d75aa95c9543cn
let () = check ~divisor:0xfefffffffffffffen
let () = check ~divisor:0xfeffffffffffffffn
let () = check ~divisor:0xff00000000000000n
let () = check ~divisor:0xff228b4f7fe9fa39n
let () = check ~divisor:0xff7ffffffffffffen
let () = check ~divisor:0xff7fffffffffffffn
let () = check ~divisor:0xff80000000000000n
let () = check ~divisor:0xffb85e0d110fff85n
let () = check ~divisor:0xffbffffffffffffen
let () = check ~divisor:0xffbfffffffffffffn
let () = check ~divisor:0xffc0000000000000n
let () = check ~divisor:0xffdebe43e4802767n
let () = check ~divisor:0xffdffffffffffffen
let () = check ~divisor:0xffdfffffffffffffn
let () = check ~divisor:0xffe0000000000000n
let () = check ~divisor:0xffe6205cf1d43cf1n
let () = check ~divisor:0xffeffffffffffffen
let () = check ~divisor:0xffefffffffffffffn
let () = check ~divisor:0xfff0000000000000n
let () = check ~divisor:0xfff36759aac74f25n
let () = check ~divisor:0xfff7fffffffffffen
let () = check ~divisor:0xfff7ffffffffffffn
let () = check ~divisor:0xfff8000000000000n
let () = check ~divisor:0xfff87974a89747dfn
let () = check ~divisor:0xfffbfffffffffffen
let () = check ~divisor:0xfffbffffffffffffn
let () = check ~divisor:0xfffc000000000000n
let () = check ~divisor:0xfffce4bf76c2ea99n
let () = check ~divisor:0xfffdfffffffffffen
let () = check ~divisor:0xfffdffffffffffffn
let () = check ~divisor:0xfffe000000000000n
let () = check ~divisor:0xfffe379c1e959ca2n
let () = check ~divisor:0xfffefffffffffffen
let () = check ~divisor:0xfffeffffffffffffn
let () = check ~divisor:0xffff000000000000n
let () = check ~divisor:0xffff42aa79a7c61dn
let () = check ~divisor:0xffff7ffffffffffen
let () = check ~divisor:0xffff7fffffffffffn
let () = check ~divisor:0xffff800000000000n
let () = check ~divisor:0xffffb1c819c66130n
let () = check ~divisor:0xffffbffffffffffen
let () = check ~divisor:0xffffbfffffffffffn
let () = check ~divisor:0xffffc00000000000n
let () = check ~divisor:0xffffc8bb613abf81n
let () = check ~divisor:0xffffdffffffffffen
let () = check ~divisor:0xffffdfffffffffffn
let () = check ~divisor:0xffffe00000000000n
let () = check ~divisor:0xffffec1e17a62ee8n
let () = check ~divisor:0xffffeffffffffffen
let () = check ~divisor:0xffffefffffffffffn
let () = check ~divisor:0xfffff00000000000n
let () = check ~divisor:0xfffff4385a292d10n
let () = check ~divisor:0xfffff7fffffffffen
let () = check ~divisor:0xfffff7ffffffffffn
let () = check ~divisor:0xfffff80000000000n
let () = check ~divisor:0xfffffb29ad622ec6n
let () = check ~divisor:0xfffffbfffffffffen
let () = check ~divisor:0xfffffbffffffffffn
let () = check ~divisor:0xfffffc0000000000n
let () = check ~divisor:0xfffffd0fd79dbe92n
let () = check ~divisor:0xfffffdfffffffffen
let () = check ~divisor:0xfffffdffffffffffn
let () = check ~divisor:0xfffffe0000000000n
let () = check ~divisor:0xfffffebf188a6912n
let () = check ~divisor:0xfffffefffffffffen
let () = check ~divisor:0xfffffeffffffffffn
let () = check ~divisor:0xffffff0000000000n
let () = check ~divisor:0xffffff269c30eb24n
let () = check ~divisor:0xffffff7ffffffffen
let () = check ~divisor:0xffffff7fffffffffn
let () = check ~divisor:0xffffff8000000000n
let () = check ~divisor:0xffffffb4017e6dabn
let () = check ~divisor:0xffffffbffffffffen
let () = check ~divisor:0xffffffbfffffffffn
let () = check ~divisor:0xffffffc000000000n
let () = check ~divisor:0xffffffd7df0592aan
let () = check ~divisor:0xffffffdffffffffen
let () = check ~divisor:0xffffffdfffffffffn
let () = check ~divisor:0xffffffe000000000n
let () = check ~divisor:0xffffffea2e2ffe26n
let () = check ~divisor:0xffffffeffffffffen
let () = check ~divisor:0xffffffefffffffffn
let () = check ~divisor:0xfffffff000000000n
let () = check ~divisor:0xfffffff2b2f7d81cn
let () = check ~divisor:0xfffffff7fffffffen
let () = check ~divisor:0xfffffff7ffffffffn
let () = check ~divisor:0xfffffff800000000n
let () = check ~divisor:0xfffffffafd83a8dcn
let () = check ~divisor:0xfffffffbfffffffen
let () = check ~divisor:0xfffffffbffffffffn
let () = check ~divisor:0xfffffffc00000000n
let () = check ~divisor:0xfffffffdea3eef40n
let () = check ~divisor:0xfffffffdfffffffen
let () = check ~divisor:0xfffffffdffffffffn
let () = check ~divisor:0xfffffffe00000000n
let () = check ~divisor:0xfffffffe92dcda11n
let () = check ~divisor:0xfffffffefffffffen
let () = check ~divisor:0xfffffffeffffffffn
let () = check ~divisor:0xffffffff00000000n
let () = check ~divisor:0xffffffff00ba6c9dn
let () = check ~divisor:0xffffffff7ffffffen
let () = check ~divisor:0xffffffff7fffffffn
let () = check ~divisor:0xffffffff80000000n
let () = check ~divisor:0xffffffff9f9bf830n
let () = check ~divisor:0xffffffffbffffffen
let () = check ~divisor:0xffffffffbfffffffn
let () = check ~divisor:0xffffffffc0000000n
let () = check ~divisor:0xffffffffdc036576n
let () = check ~divisor:0xffffffffdffffffen
let () = check ~divisor:0xffffffffdfffffffn
let () = check ~divisor:0xffffffffe0000000n
let () = check ~divisor:0xffffffffea807c27n
let () = check ~divisor:0xffffffffeffffffen
let () = check ~divisor:0xffffffffefffffffn
let () = check ~divisor:0xfffffffff0000000n
let () = check ~divisor:0xfffffffff0bd42e5n
let () = check ~divisor:0xfffffffff7fffffen
let () = check ~divisor:0xfffffffff7ffffffn
let () = check ~divisor:0xfffffffff8000000n
let () = check ~divisor:0xfffffffff9be81b5n
let () = check ~divisor:0xfffffffffbfffffen
let () = check ~divisor:0xfffffffffbffffffn
let () = check ~divisor:0xfffffffffc000000n
let () = check ~divisor:0xfffffffffdcbce91n
let () = check ~divisor:0xfffffffffdfffffen
let () = check ~divisor:0xfffffffffdffffffn
let () = check ~divisor:0xfffffffffe000000n
let () = check ~divisor:0xfffffffffec24947n
let () = check ~divisor:0xfffffffffefffffen
let () = check ~divisor:0xfffffffffeffffffn
let () = check ~divisor:0xffffffffff000000n
let () = check ~divisor:0xffffffffff36dd37n
let () = check ~divisor:0xffffffffff7ffffen
let () = check ~divisor:0xffffffffff7fffffn
let () = check ~divisor:0xffffffffff800000n
let () = check ~divisor:0xffffffffffb8d39an
let () = check ~divisor:0xffffffffffbffffen
let () = check ~divisor:0xffffffffffbfffffn
let () = check ~divisor:0xffffffffffc00000n
let () = check ~divisor:0xffffffffffd3f492n
let () = check ~divisor:0xffffffffffdffffen
let () = check ~divisor:0xffffffffffdfffffn
let () = check ~divisor:0xffffffffffe00000n
let () = check ~divisor:0xffffffffffe8c9b3n
let () = check ~divisor:0xffffffffffeffffen
let () = check ~divisor:0xffffffffffefffffn
let () = check ~divisor:0xfffffffffff00000n
let () = check ~divisor:0xfffffffffff7ac08n
let () = check ~divisor:0xfffffffffff7fffen
let () = check ~divisor:0xfffffffffff7ffffn
let () = check ~divisor:0xfffffffffff80000n
let () = check ~divisor:0xfffffffffffadad2n
let () = check ~divisor:0xfffffffffffbfffen
let () = check ~divisor:0xfffffffffffbffffn
let () = check ~divisor:0xfffffffffffc0000n
let () = check ~divisor:0xfffffffffffcfe0cn
let () = check ~divisor:0xfffffffffffdfffen
let () = check ~divisor:0xfffffffffffdffffn
let () = check ~divisor:0xfffffffffffe0000n
let () = check ~divisor:0xfffffffffffe6624n
let () = check ~divisor:0xfffffffffffefffen
let () = check ~divisor:0xfffffffffffeffffn
let () = check ~divisor:0xffffffffffff0000n
let () = check ~divisor:0xffffffffffff7b92n
let () = check ~divisor:0xffffffffffff7ffen
let () = check ~divisor:0xffffffffffff7fffn
let () = check ~divisor:0xffffffffffff8000n
let () = check ~divisor:0xffffffffffffba40n
let () = check ~divisor:0xffffffffffffbffen
let () = check ~divisor:0xffffffffffffbfffn
let () = check ~divisor:0xffffffffffffc000n
let () = check ~divisor:0xffffffffffffcc04n
let () = check ~divisor:0xffffffffffffdffen
let () = check ~divisor:0xffffffffffffdfffn
let () = check ~divisor:0xffffffffffffe000n
let () = check ~divisor:0xffffffffffffefe8n
let () = check ~divisor:0xffffffffffffeffen
let () = check ~divisor:0xffffffffffffefffn
let () = check ~divisor:0xfffffffffffff000n
let () = check ~divisor:0xfffffffffffff4ean
let () = check ~divisor:0xfffffffffffff7fen
let () = check ~divisor:0xfffffffffffff7ffn
let () = check ~divisor:0xfffffffffffff800n
let () = check ~divisor:0xfffffffffffffb29n
let () = check ~divisor:0xfffffffffffffbfen
let () = check ~divisor:0xfffffffffffffbffn
let () = check ~divisor:0xfffffffffffffc00n
let () = check ~divisor:0xfffffffffffffd38n
let () = check ~divisor:0xfffffffffffffdfen
let () = check ~divisor:0xfffffffffffffdffn
let () = check ~divisor:0xfffffffffffffe00n
let () = check ~divisor:0xfffffffffffffe4dn
let () = check ~divisor:0xfffffffffffffefen
let () = check ~divisor:0xfffffffffffffeffn
let () = check ~divisor:0xffffffffffffff00n
let () = check ~divisor:0xffffffffffffff57n
let () = check ~divisor:0xffffffffffffff7en
let () = check ~divisor:0xffffffffffffff7fn
let () = check ~divisor:0xffffffffffffff80n
let () = check ~divisor:0xffffffffffffffabn
let () = check ~divisor:0xffffffffffffffben
let () = check ~divisor:0xffffffffffffffbfn
let () = check ~divisor:0xffffffffffffffc0n
let () = check ~divisor:0xffffffffffffffc6n
let () = check ~divisor:0xffffffffffffffden
let () = check ~divisor:0xffffffffffffffdfn
let () = check ~divisor:0xffffffffffffffe0n
let () = check ~divisor:0xffffffffffffffean
let () = check ~divisor:0xffffffffffffffeen
let () = check ~divisor:0xffffffffffffffefn
let () = check ~divisor:0xfffffffffffffff0n
let () = check ~divisor:0xfffffffffffffff1n
let () = check ~divisor:0xfffffffffffffff6n
let () = check ~divisor:0xfffffffffffffff7n
let () = check ~divisor:0xfffffffffffffff8n
let () = check ~divisor:0xfffffffffffffffan
let () = check ~divisor:0xfffffffffffffffbn
let () = check ~divisor:0xfffffffffffffffcn
let () = check ~divisor:0xfffffffffffffffdn
let () = check ~divisor:0xfffffffffffffffen
let () = check ~divisor:0xffffffffffffffffn
