(* TEST
   flags = "-extension comprehensions"
   * expect
*)

(* Generated by quickcheck_lists_arrays_haskell_python.ml; filtered down to all
   tests of reasonable size; and reflowed to fit in 80-character lines.  This
   still wasn't enough to get this file to execute in a reasonable amount of
   time, and most of the test cases return empty lists, so this file also had a
   lot of tests that looked uninteresting removed:

   - Most tests that were just a single [for] iterator.
   - All but one test whose first [for] iterator was over an empty sequence, and
     all but one other test whose first [for]-[and] iterator had an empty
     sequence after an [and].
   - As above, but for empty [to]/[downto] ranges.

   This brought the file down to a manageable size, although in a quick test it
   was still the 14th-slowest test in the compiler. *)

[(e, f, h, o, t, w)
   for f in [-3; -1; 3] and w in [2; 1; -3]
   for e in [] and o = -3 downto -1
   for t in [3; 1; -3; 2]
   for h = 2 downto 0];;
[%%expect{|
- : ('a * int * int * int * int * int) list = []
|}];;

[|(e, f, h, o, t, w)
    for f in [|-3; -1; 3|] and w in [|2; 1; -3|]
    for e in [||] and o = -3 downto -1
    for t in [|3; 1; -3; 2|]
    for h = 2 downto 0|];;
[%%expect{|
- : ('_weak1 * int * int * int * int * int) array = [||]
|}];;

[:(e, f, h, o, t, w)
    for f in [:-3; -1; 3:] and w in [:2; 1; -3:]
    for e in [::] and o = -3 downto -1
    for t in [:3; 1; -3; 2:]
    for h = 2 downto 0:];;
[%%expect{|
- : ('a * int * int * int * int * int) iarray = [::]
|}];;

[(e, q, t)
   for e = 3 to -3
   when e <> 0
   for q = 3 downto 0 and t in [e]
   when abs q mod 2 = 1
   when abs e mod 2 = 1];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(e, q, t)
    for e = 3 to -3
    when e <> 0
    for q = 3 downto 0 and t in [|e|]
    when abs q mod 2 = 1
    when abs e mod 2 = 1|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(e, q, t)
    for e = 3 to -3
    when e <> 0
    for q = 3 downto 0 and t in [:e:]
    when abs q mod 2 = 1
    when abs e mod 2 = 1:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(a, j, s, u, z)
   for j = 1 downto 1
   for s in [-1] and a in [0; 3; 3; j; -1]
   when abs s mod 2 = 0
   for u = -3 to 0 and z = 0 downto -2
   for _ = 2 downto 1];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(a, j, s, u, z)
    for j = 1 downto 1
    for s in [|-1|] and a in [|0; 3; 3; j; -1|]
    when abs s mod 2 = 0
    for u = -3 to 0 and z = 0 downto -2
    for _ = 2 downto 1|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(a, j, s, u, z)
    for j = 1 downto 1
    for s in [:-1:] and a in [:0; 3; 3; j; -1:]
    when abs s mod 2 = 0
    for u = -3 to 0 and z = 0 downto -2
    for _ = 2 downto 1:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(a, g, r, s)
   for s in [-1; -2; 3] and a in [0]
   for g = a downto 2 and r = 3 to 1
   when abs r mod 2 = 0
   when a <> 0];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(a, g, r, s)
    for s in [|-1; -2; 3|] and a in [|0|]
    for g = a downto 2 and r = 3 to 1
    when abs r mod 2 = 0
    when a <> 0|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(a, g, r, s)
    for s in [:-1; -2; 3:] and a in [:0:]
    for g = a downto 2 and r = 3 to 1
    when abs r mod 2 = 0
    when a <> 0:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(f, g, w) for g = 1 downto 1 and w in [-3; -3] and f in [1; 1]];;
[%%expect{|
- : (int * int * int) list = [(1, 1, -3); (1, 1, -3); (1, 1, -3); (1, 1, -3)]
|}];;

[|(f, g, w) for g = 1 downto 1 and w in [|-3; -3|] and f in [|1; 1|]|];;
[%%expect{|
- : (int * int * int) array =
[|(1, 1, -3); (1, 1, -3); (1, 1, -3); (1, 1, -3)|]
|}];;

[:(f, g, w) for g = 1 downto 1 and w in [:-3; -3:] and f in [:1; 1:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(1, 1, -3); (1, 1, -3); (1, 1, -3); (1, 1, -3):]
|}];;

[(f, h, i, k, m, y)
   for k in [-2; 2; 2]
   for y = -3 downto -2 and m = 2 downto -1 and i = 2 downto -2
   for f = -3 downto 2 and h in [1; 1; 2] and y = -1 to 1
   when k <> 0];;
[%%expect{|
Lines 1-5, characters 0-15:
1 | [(f, h, i, k, m, y)
2 |    for k in [-2; 2; 2]
3 |    for y = -3 downto -2 and m = 2 downto -1 and i = 2 downto -2
4 |    for f = -3 downto 2 and h in [1; 1; 2] and y = -1 to 1
5 |    when k <> 0]..
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int) list = []
|}];;

[|(f, h, i, k, m, y)
    for k in [|-2; 2; 2|]
    for y = -3 downto -2 and m = 2 downto -1 and i = 2 downto -2
    for f = -3 downto 2 and h in [|1; 1; 2|] and y = -1 to 1
    when k <> 0|];;
[%%expect{|
Lines 1-5, characters 0-17:
1 | [|(f, h, i, k, m, y)
2 |     for k in [|-2; 2; 2|]
3 |     for y = -3 downto -2 and m = 2 downto -1 and i = 2 downto -2
4 |     for f = -3 downto 2 and h in [|1; 1; 2|] and y = -1 to 1
5 |     when k <> 0|]..
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(f, h, i, k, m, y)
    for k in [:-2; 2; 2:]
    for y = -3 downto -2 and m = 2 downto -1 and i = 2 downto -2
    for f = -3 downto 2 and h in [:1; 1; 2:] and y = -1 to 1
    when k <> 0:];;
[%%expect{|
Lines 1-5, characters 0-17:
1 | [:(f, h, i, k, m, y)
2 |     for k in [:-2; 2; 2:]
3 |     for y = -3 downto -2 and m = 2 downto -1 and i = 2 downto -2
4 |     for f = -3 downto 2 and h in [:1; 1; 2:] and y = -1 to 1
5 |     when k <> 0:]..
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(d, j, r, s, w)
   for r = 2 downto 1 and w in [0; 3]
   for r in [-2; -3] and d = 0 downto 1 and j = 0 downto w
   for s = -3 to j
   when abs r mod 2 = 1];;
[%%expect{|
Lines 1-5, characters 0-24:
1 | [(d, j, r, s, w)
2 |    for r = 2 downto 1 and w in [0; 3]
3 |    for r in [-2; -3] and d = 0 downto 1 and j = 0 downto w
4 |    for s = -3 to j
5 |    when abs r mod 2 = 1]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int * int) list = []
|}];;

[|(d, j, r, s, w)
    for r = 2 downto 1 and w in [|0; 3|]
    for r in [|-2; -3|] and d = 0 downto 1 and j = 0 downto w
    for s = -3 to j
    when abs r mod 2 = 1|];;
[%%expect{|
Lines 1-5, characters 0-26:
1 | [|(d, j, r, s, w)
2 |     for r = 2 downto 1 and w in [|0; 3|]
3 |     for r in [|-2; -3|] and d = 0 downto 1 and j = 0 downto w
4 |     for s = -3 to j
5 |     when abs r mod 2 = 1|]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int * int) array = [||]
|}];;

[:(d, j, r, s, w)
    for r = 2 downto 1 and w in [:0; 3:]
    for r in [:-2; -3:] and d = 0 downto 1 and j = 0 downto w
    for s = -3 to j
    when abs r mod 2 = 1:];;
[%%expect{|
Lines 1-5, characters 0-26:
1 | [:(d, j, r, s, w)
2 |     for r = 2 downto 1 and w in [:0; 3:]
3 |     for r in [:-2; -3:] and d = 0 downto 1 and j = 0 downto w
4 |     for s = -3 to j
5 |     when abs r mod 2 = 1:]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int * int) iarray = [::]
|}];;

[(i, k, m, r)
   for i in [2; 2; -2; 1; 2] and r in [] and k in [-1]
   for m in [r; -3; -2; 1; 1] and i = 0 downto -1
   when i < 0
   for k in []];;
[%%expect{|
Line 2, characters 7-8:
2 |    for i in [2; 2; -2; 1; 2] and r in [] and k in [-1]
           ^
Warning 26 [unused-var]: unused variable i.

Line 2, characters 45-46:
2 |    for i in [2; 2; -2; 1; 2] and r in [] and k in [-1]
                                                 ^
Warning 26 [unused-var]: unused variable k.

- : (int * 'a * int * int) list = []
|}];;

[|(i, k, m, r)
    for i in [|2; 2; -2; 1; 2|] and r in [||] and k in [|-1|]
    for m in [|r; -3; -2; 1; 1|] and i = 0 downto -1
    when i < 0
    for k in [||]|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for i in [|2; 2; -2; 1; 2|] and r in [||] and k in [|-1|]
            ^
Warning 26 [unused-var]: unused variable i.

Line 2, characters 50-51:
2 |     for i in [|2; 2; -2; 1; 2|] and r in [||] and k in [|-1|]
                                                      ^
Warning 26 [unused-var]: unused variable k.

- : (int * '_weak2 * int * int) array = [||]
|}];;

[:(i, k, m, r)
    for i in [:2; 2; -2; 1; 2:] and r in [::] and k in [:-1:]
    for m in [:r; -3; -2; 1; 1:] and i = 0 downto -1
    when i < 0
    for k in [::]:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for i in [:2; 2; -2; 1; 2:] and r in [::] and k in [:-1:]
            ^
Warning 26 [unused-var]: unused variable i.

Line 2, characters 50-51:
2 |     for i in [:2; 2; -2; 1; 2:] and r in [::] and k in [:-1:]
                                                      ^
Warning 26 [unused-var]: unused variable k.

- : (int * 'a * int * int) iarray = [::]
|}];;

[q for q = 3 downto -1 when q > 0 when q <> 0];;
[%%expect{|
- : int list = [3; 2; 1]
|}];;

[|q for q = 3 downto -1 when q > 0 when q <> 0|];;
[%%expect{|
- : int array = [|3; 2; 1|]
|}];;

[:q for q = 3 downto -1 when q > 0 when q <> 0:];;
[%%expect{|
- : int iarray = [:3; 2; 1:]
|}];;

[(g, i, n, t)
   for g in [-2; 0; 2; -3; 0; 2; -3] and t in [-2; 3; -3; -2; 1]
   for i = g downto 3
   for n = g downto 3];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(g, i, n, t)
    for g in [|-2; 0; 2; -3; 0; 2; -3|] and t in [|-2; 3; -3; -2; 1|]
    for i = g downto 3
    for n = g downto 3|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(g, i, n, t)
    for g in [:-2; 0; 2; -3; 0; 2; -3:] and t in [:-2; 3; -3; -2; 1:]
    for i = g downto 3
    for n = g downto 3:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[a for a = 0 to -2];;
[%%expect{|
- : int list = []
|}];;

[|a for a = 0 to -2|];;
[%%expect{|
- : int array = [||]
|}];;

[:a for a = 0 to -2:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(g, k, u, x, y)
   for x = 2 downto 2 and u = 0 downto -1 and y = 2 downto 1
   for k in []
   for g in []];;
[%%expect{|
- : ('a * 'b * int * int * int) list = []
|}];;

[|(g, k, u, x, y)
    for x = 2 downto 2 and u = 0 downto -1 and y = 2 downto 1
    for k in [||]
    for g in [||]|];;
[%%expect{|
- : ('_weak3 * '_weak4 * int * int * int) array = [||]
|}];;

[:(g, k, u, x, y)
    for x = 2 downto 2 and u = 0 downto -1 and y = 2 downto 1
    for k in [::]
    for g in [::]:];;
[%%expect{|
- : ('a * 'b * int * int * int) iarray = [::]
|}];;

[(g, n, u, v)
   for u = -3 to -3
   and v = 0 downto -3
   and n = 1 downto 0
   and g in [-3; -1; -3; -2; -1]
   when n > 0];;
[%%expect{|
- : (int * int * int * int) list =
[(-3, 1, -3, 0); (-1, 1, -3, 0); (-3, 1, -3, 0); (-2, 1, -3, 0);
 (-1, 1, -3, 0); (-3, 1, -3, -1); (-1, 1, -3, -1); (-3, 1, -3, -1);
 (-2, 1, -3, -1); (-1, 1, -3, -1); (-3, 1, -3, -2); (-1, 1, -3, -2);
 (-3, 1, -3, -2); (-2, 1, -3, -2); (-1, 1, -3, -2); (-3, 1, -3, -3);
 (-1, 1, -3, -3); (-3, 1, -3, -3); (-2, 1, -3, -3); (-1, 1, -3, -3)]
|}];;

[|(g, n, u, v)
    for u = -3 to -3
    and v = 0 downto -3
    and n = 1 downto 0
    and g in [|-3; -1; -3; -2; -1|]
    when n > 0|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-3, 1, -3, 0); (-1, 1, -3, 0); (-3, 1, -3, 0); (-2, 1, -3, 0);
  (-1, 1, -3, 0); (-3, 1, -3, -1); (-1, 1, -3, -1); (-3, 1, -3, -1);
  (-2, 1, -3, -1); (-1, 1, -3, -1); (-3, 1, -3, -2); (-1, 1, -3, -2);
  (-3, 1, -3, -2); (-2, 1, -3, -2); (-1, 1, -3, -2); (-3, 1, -3, -3);
  (-1, 1, -3, -3); (-3, 1, -3, -3); (-2, 1, -3, -3); (-1, 1, -3, -3)|]
|}];;

[:(g, n, u, v)
    for u = -3 to -3
    and v = 0 downto -3
    and n = 1 downto 0
    and g in [:-3; -1; -3; -2; -1:]
    when n > 0:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-3, 1, -3, 0); (-1, 1, -3, 0); (-3, 1, -3, 0); (-2, 1, -3, 0);
  (-1, 1, -3, 0); (-3, 1, -3, -1); (-1, 1, -3, -1); (-3, 1, -3, -1);
  (-2, 1, -3, -1); (-1, 1, -3, -1); (-3, 1, -3, -2); (-1, 1, -3, -2);
  (-3, 1, -3, -2); (-2, 1, -3, -2); (-1, 1, -3, -2); (-3, 1, -3, -3);
  (-1, 1, -3, -3); (-3, 1, -3, -3); (-2, 1, -3, -3); (-1, 1, -3, -3):]
|}];;

[(h, y) for y = 3 downto 3 when y > 0 when y > 0 for h = -1 downto -3];;
[%%expect{|
- : (int * int) list = [(-1, 3); (-2, 3); (-3, 3)]
|}];;

[|(h, y) for y = 3 downto 3 when y > 0 when y > 0 for h = -1 downto -3|];;
[%%expect{|
- : (int * int) array = [|(-1, 3); (-2, 3); (-3, 3)|]
|}];;

[:(h, y) for y = 3 downto 3 when y > 0 when y > 0 for h = -1 downto -3:];;
[%%expect{|
- : (int * int) iarray = [:(-1, 3); (-2, 3); (-3, 3):]
|}];;

[(e, k, o, x)
   for o = 0 downto -1 and k in [3; 2; 3; -1; 1; -2; -3]
   when abs k mod 2 = 0
   for e in [-3; -1; -3]
   for x in [0]];;
[%%expect{|
- : (int * int * int * int) list =
[(-3, 2, 0, 0); (-1, 2, 0, 0); (-3, 2, 0, 0); (-3, -2, 0, 0); (-1, -2, 0, 0);
 (-3, -2, 0, 0); (-3, 2, -1, 0); (-1, 2, -1, 0); (-3, 2, -1, 0);
 (-3, -2, -1, 0); (-1, -2, -1, 0); (-3, -2, -1, 0)]
|}];;

[|(e, k, o, x)
    for o = 0 downto -1 and k in [|3; 2; 3; -1; 1; -2; -3|]
    when abs k mod 2 = 0
    for e in [|-3; -1; -3|]
    for x in [|0|]|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-3, 2, 0, 0); (-1, 2, 0, 0); (-3, 2, 0, 0); (-3, -2, 0, 0);
  (-1, -2, 0, 0); (-3, -2, 0, 0); (-3, 2, -1, 0); (-1, 2, -1, 0);
  (-3, 2, -1, 0); (-3, -2, -1, 0); (-1, -2, -1, 0); (-3, -2, -1, 0)|]
|}];;

[:(e, k, o, x)
    for o = 0 downto -1 and k in [:3; 2; 3; -1; 1; -2; -3:]
    when abs k mod 2 = 0
    for e in [:-3; -1; -3:]
    for x in [:0:]:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-3, 2, 0, 0); (-1, 2, 0, 0); (-3, 2, 0, 0); (-3, -2, 0, 0);
  (-1, -2, 0, 0); (-3, -2, 0, 0); (-3, 2, -1, 0); (-1, 2, -1, 0);
  (-3, 2, -1, 0); (-3, -2, -1, 0); (-1, -2, -1, 0); (-3, -2, -1, 0):]
|}];;

[(j, s, x, y, z)
   for s = 1 downto 0 and x = -2 to 0 and z = 3 downto 0 and j in [3; -1]
   for y = -2 downto 3
   when abs z mod 2 = 0];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(j, s, x, y, z)
    for s = 1 downto 0 and x = -2 to 0 and z = 3 downto 0 and j in [|3; -1|]
    for y = -2 downto 3
    when abs z mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(j, s, x, y, z)
    for s = 1 downto 0 and x = -2 to 0 and z = 3 downto 0 and j in [:3; -1:]
    for y = -2 downto 3
    when abs z mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(g, l, w, z)
   for z = -1 downto -2
   for z = -1 downto 2 and l in [1; -2]
   for g = 1 downto 1
   when z < 0
   for w in [3; 3]];;
[%%expect{|
Lines 1-6, characters 0-19:
1 | [(g, l, w, z)
2 |    for z = -1 downto -2
3 |    for z = -1 downto 2 and l in [1; -2]
4 |    for g = 1 downto 1
5 |    when z < 0
6 |    for w in [3; 3]]..
Warning 26 [unused-var]: unused variable z.

- : (int * int * int * int) list = []
|}];;

[|(g, l, w, z)
    for z = -1 downto -2
    for z = -1 downto 2 and l in [|1; -2|]
    for g = 1 downto 1
    when z < 0
    for w in [|3; 3|]|];;
[%%expect{|
Lines 1-6, characters 0-23:
1 | [|(g, l, w, z)
2 |     for z = -1 downto -2
3 |     for z = -1 downto 2 and l in [|1; -2|]
4 |     for g = 1 downto 1
5 |     when z < 0
6 |     for w in [|3; 3|]|]..
Warning 26 [unused-var]: unused variable z.

- : (int * int * int * int) array = [||]
|}];;

[:(g, l, w, z)
    for z = -1 downto -2
    for z = -1 downto 2 and l in [:1; -2:]
    for g = 1 downto 1
    when z < 0
    for w in [:3; 3:]:];;
[%%expect{|
Lines 1-6, characters 0-23:
1 | [:(g, l, w, z)
2 |     for z = -1 downto -2
3 |     for z = -1 downto 2 and l in [:1; -2:]
4 |     for g = 1 downto 1
5 |     when z < 0
6 |     for w in [:3; 3:]:]..
Warning 26 [unused-var]: unused variable z.

- : (int * int * int * int) iarray = [::]
|}];;

[(g, h, t) for h = -2 downto 3 and g = 1 to 2 for t in [-2; -1; -2; 0; h; g]];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(d, l, p) for l = 1 to 3 for d = 2 downto 1 and p = -1 downto 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(d, l, p) for l = 1 to 3 for d = 2 downto 1 and p = -1 downto 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(h, m, n, o, p, y)
   for m in [] and h = 2 downto -1
   for m in [h; m]
   for p = 2 downto 2 and n in [3; 2; h; -2; 0; 1; 3]
   for o = 1 to n and y in [-1]
   for n = 2 to 2];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(h, m, n, o, p, y)
    for m in [||] and h = 2 downto -1
    for m in [|h; m|]
    for p = 2 downto 2 and n in [|3; 2; h; -2; 0; 1; 3|]
    for o = 1 to n and y in [|-1|]
    for n = 2 to 2|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(h, m, n, o, p, y)
    for m in [::] and h = 2 downto -1
    for m in [:h; m:]
    for p = 2 downto 2 and n in [:3; 2; h; -2; 0; 1; 3:]
    for o = 1 to n and y in [:-1:]
    for n = 2 to 2:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(a, f, g, q, y)
   for g in [1; 2; 3] and q in [3; 3]
   for y = 3 to 0 and a in [] and f = -1 downto -3];;
[%%expect{|
- : ('a * int * int * int * int) list = []
|}];;

[|(a, f, g, q, y)
    for g in [|1; 2; 3|] and q in [|3; 3|]
    for y = 3 to 0 and a in [||] and f = -1 downto -3|];;
[%%expect{|
- : ('_weak5 * int * int * int * int) array = [||]
|}];;

[:(a, f, g, q, y)
    for g in [:1; 2; 3:] and q in [:3; 3:]
    for y = 3 to 0 and a in [::] and f = -1 downto -3:];;
[%%expect{|
- : ('a * int * int * int * int) iarray = [::]
|}];;

[(c, e, o) for c in [-1] and o in [] and e = -2 to -3];;
[%%expect{|
- : (int * int * 'a) list = []
|}];;

[|(c, e, o) for c in [|-1|] and o in [||] and e = -2 to -3|];;
[%%expect{|
- : (int * int * '_weak6) array = [||]
|}];;

[:(c, e, o) for c in [:-1:] and o in [::] and e = -2 to -3:];;
[%%expect{|
- : (int * int * 'a) iarray = [::]
|}];;

[(o, y) for y = 2 to 2 and o in [0; 0; -3; 2; 1; 1]];;
[%%expect{|
- : (int * int) list = [(0, 2); (0, 2); (-3, 2); (2, 2); (1, 2); (1, 2)]
|}];;

[|(o, y) for y = 2 to 2 and o in [|0; 0; -3; 2; 1; 1|]|];;
[%%expect{|
- : (int * int) array = [|(0, 2); (0, 2); (-3, 2); (2, 2); (1, 2); (1, 2)|]
|}];;

[:(o, y) for y = 2 to 2 and o in [:0; 0; -3; 2; 1; 1:]:];;
[%%expect{|
- : (int * int) iarray = [:(0, 2); (0, 2); (-3, 2); (2, 2); (1, 2); (1, 2):]
|}];;

[(e, j, m, p, q, s, u, w)
   for w in [2; 3; 1] and p = -2 to 3
   for w = 0 downto p and j in [0; -1; 2; -2]
   for s = -1 to 2
   for e = 0 downto 0 and m in [3; w; 2; -1; -2; s]
   for u = 1 to -2 and q in [3; e; -1]];;
[%%expect{|
Line 2, characters 7-8:
2 |    for w in [2; 3; 1] and p = -2 to 3
           ^
Warning 26 [unused-var]: unused variable w.

- : (int * int * int * int * int * int * int * int) list = []
|}];;

[|(e, j, m, p, q, s, u, w)
    for w in [|2; 3; 1|] and p = -2 to 3
    for w = 0 downto p and j in [|0; -1; 2; -2|]
    for s = -1 to 2
    for e = 0 downto 0 and m in [|3; w; 2; -1; -2; s|]
    for u = 1 to -2 and q in [|3; e; -1|]|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for w in [|2; 3; 1|] and p = -2 to 3
            ^
Warning 26 [unused-var]: unused variable w.

- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(e, j, m, p, q, s, u, w)
    for w in [:2; 3; 1:] and p = -2 to 3
    for w = 0 downto p and j in [:0; -1; 2; -2:]
    for s = -1 to 2
    for e = 0 downto 0 and m in [:3; w; 2; -1; -2; s:]
    for u = 1 to -2 and q in [:3; e; -1:]:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for w in [:2; 3; 1:] and p = -2 to 3
            ^
Warning 26 [unused-var]: unused variable w.

- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(e, i, o, p, q, v)
   for p in [-1; 2] and o = 1 downto 0
   for i = 2 downto 3 and v in [2] and e = -2 to 1 and q in [2]
   for p = v downto 0];;
[%%expect{|
Line 2, characters 7-8:
2 |    for p in [-1; 2] and o = 1 downto 0
           ^
Warning 26 [unused-var]: unused variable p.

- : (int * int * int * int * int * int) list = []
|}];;

[|(e, i, o, p, q, v)
    for p in [|-1; 2|] and o = 1 downto 0
    for i = 2 downto 3 and v in [|2|] and e = -2 to 1 and q in [|2|]
    for p = v downto 0|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for p in [|-1; 2|] and o = 1 downto 0
            ^
Warning 26 [unused-var]: unused variable p.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(e, i, o, p, q, v)
    for p in [:-1; 2:] and o = 1 downto 0
    for i = 2 downto 3 and v in [:2:] and e = -2 to 1 and q in [:2:]
    for p = v downto 0:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for p in [:-1; 2:] and o = 1 downto 0
            ^
Warning 26 [unused-var]: unused variable p.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(f, m, o, v)
   for v in [3; 0; -3; -3; -1; -1; 0]
   when v < 0
   for o = 3 to 2 and m in [-1; -1; -1; 1; -2; -1; -1] and f in [v; -2; -1]];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(f, m, o, v)
    for v in [|3; 0; -3; -3; -1; -1; 0|]
    when v < 0
    for o = 3 to 2
    and m in [|-1; -1; -1; 1; -2; -1; -1|]
    and f in [|v; -2; -1|]|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(f, m, o, v)
    for v in [:3; 0; -3; -3; -1; -1; 0:]
    when v < 0
    for o = 3 to 2
    and m in [:-1; -1; -1; 1; -2; -1; -1:]
    and f in [:v; -2; -1:]:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(e, h, k, p, u, z)
   for p in [1] and h in [3; 3; 2; 3; -3; 1]
   for z = 3 to -3
   for u = 1 to -2 and e = 2 to 3
   for k in []];;
[%%expect{|
- : (int * int * 'a * int * int * int) list = []
|}];;

[|(e, h, k, p, u, z)
    for p in [|1|] and h in [|3; 3; 2; 3; -3; 1|]
    for z = 3 to -3
    for u = 1 to -2 and e = 2 to 3
    for k in [||]|];;
[%%expect{|
- : (int * int * '_weak7 * int * int * int) array = [||]
|}];;

[:(e, h, k, p, u, z)
    for p in [:1:] and h in [:3; 3; 2; 3; -3; 1:]
    for z = 3 to -3
    for u = 1 to -2 and e = 2 to 3
    for k in [::]:];;
[%%expect{|
- : (int * int * 'a * int * int * int) iarray = [::]
|}];;

[(j, k, r, t)
   for t = -1 downto -1
   for j in [-1; -2; 2; 1; 0; 2]
   for r = 1 to 0
   for k in [0]
   when j > 0];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(j, k, r, t)
    for t = -1 downto -1
    for j in [|-1; -2; 2; 1; 0; 2|]
    for r = 1 to 0
    for k in [|0|]
    when j > 0|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(j, k, r, t)
    for t = -1 downto -1
    for j in [:-1; -2; 2; 1; 0; 2:]
    for r = 1 to 0
    for k in [:0:]
    when j > 0:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(f, l) for f in [2; -3; -1; 2; 2; -2] and l in [-1; -1; -1; -2]];;
[%%expect{|
- : (int * int) list =
[(2, -1); (2, -1); (2, -1); (2, -2); (-3, -1); (-3, -1); (-3, -1); (-3, -2);
 (-1, -1); (-1, -1); (-1, -1); (-1, -2); (2, -1); (2, -1); (2, -1); (2, -2);
 (2, -1); (2, -1); (2, -1); (2, -2); (-2, -1); (-2, -1); (-2, -1); (-2, -2)]
|}];;

[|(f, l) for f in [|2; -3; -1; 2; 2; -2|] and l in [|-1; -1; -1; -2|]|];;
[%%expect{|
- : (int * int) array =
[|(2, -1); (2, -1); (2, -1); (2, -2); (-3, -1); (-3, -1); (-3, -1); (-3, -2);
  (-1, -1); (-1, -1); (-1, -1); (-1, -2); (2, -1); (2, -1); (2, -1);
  (2, -2); (2, -1); (2, -1); (2, -1); (2, -2); (-2, -1); (-2, -1); (-2, -1);
  (-2, -2)|]
|}];;

[:(f, l) for f in [:2; -3; -1; 2; 2; -2:] and l in [:-1; -1; -1; -2:]:];;
[%%expect{|
- : (int * int) iarray =
[:(2, -1); (2, -1); (2, -1); (2, -2); (-3, -1); (-3, -1); (-3, -1); (-3, -2);
  (-1, -1); (-1, -1); (-1, -1); (-1, -2); (2, -1); (2, -1); (2, -1);
  (2, -2); (2, -1); (2, -1); (2, -1); (2, -2); (-2, -1); (-2, -1); (-2, -1);
  (-2, -2):]
|}];;

[(b, r, u)
   for u in [-3; 0; -1; -2] and b in [-1; -3; 3]
   for r = b to -3];;
[%%expect{|
- : (int * int * int) list =
[(-3, -3, -3); (-3, -3, 0); (-3, -3, -1); (-3, -3, -2)]
|}];;

[|(b, r, u)
    for u in [|-3; 0; -1; -2|] and b in [|-1; -3; 3|]
    for r = b to -3|];;
[%%expect{|
- : (int * int * int) array =
[|(-3, -3, -3); (-3, -3, 0); (-3, -3, -1); (-3, -3, -2)|]
|}];;

[:(b, r, u)
    for u in [:-3; 0; -1; -2:] and b in [:-1; -3; 3:]
    for r = b to -3:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-3, -3, -3); (-3, -3, 0); (-3, -3, -1); (-3, -3, -2):]
|}];;

[x for x in [3; 1; -2; 2; 0]];;
[%%expect{|
- : int list = [3; 1; -2; 2; 0]
|}];;

[|x for x in [|3; 1; -2; 2; 0|]|];;
[%%expect{|
- : int array = [|3; 1; -2; 2; 0|]
|}];;

[:x for x in [:3; 1; -2; 2; 0:]:];;
[%%expect{|
- : int iarray = [:3; 1; -2; 2; 0:]
|}];;

[(g, q, r, s, x, y, z)
   for z = 1 to 3 and x = 2 downto 1
   for r = z downto 2 and q in [-1]
   when abs z mod 2 = 0
   for s = r to -1 and g in [r; -3; 3; 0; 1]
   for y = -3 downto 3];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(g, q, r, s, x, y, z)
    for z = 1 to 3 and x = 2 downto 1
    for r = z downto 2 and q in [|-1|]
    when abs z mod 2 = 0
    for s = r to -1 and g in [|r; -3; 3; 0; 1|]
    for y = -3 downto 3|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(g, q, r, s, x, y, z)
    for z = 1 to 3 and x = 2 downto 1
    for r = z downto 2 and q in [:-1:]
    when abs z mod 2 = 0
    for s = r to -1 and g in [:r; -3; 3; 0; 1:]
    for y = -3 downto 3:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(d, e, k, u, x)
   for k in [1; -1; 1; -3] and u in [2; -1; 3; -2; -3; 2]
   for x = -3 downto k and d in [-2; 2; 0; 1]
   for e = 0 to 2
   for e in [] and x in [0; 2]
   when u <> 0];;
[%%expect{|
Lines 1-6, characters 0-15:
1 | [(d, e, k, u, x)
2 |    for k in [1; -1; 1; -3] and u in [2; -1; 3; -2; -3; 2]
3 |    for x = -3 downto k and d in [-2; 2; 0; 1]
4 |    for e = 0 to 2
5 |    for e in [] and x in [0; 2]
6 |    when u <> 0]..
Warning 26 [unused-var]: unused variable x.

Lines 1-6, characters 0-15:
1 | [(d, e, k, u, x)
2 |    for k in [1; -1; 1; -3] and u in [2; -1; 3; -2; -3; 2]
3 |    for x = -3 downto k and d in [-2; 2; 0; 1]
4 |    for e = 0 to 2
5 |    for e in [] and x in [0; 2]
6 |    when u <> 0]..
Warning 26 [unused-var]: unused variable e.

- : (int * 'a * int * int * int) list = []
|}];;

[|(d, e, k, u, x)
    for k in [|1; -1; 1; -3|] and u in [|2; -1; 3; -2; -3; 2|]
    for x = -3 downto k and d in [|-2; 2; 0; 1|]
    for e = 0 to 2
    for e in [||] and x in [|0; 2|]
    when u <> 0|];;
[%%expect{|
Lines 1-6, characters 0-17:
1 | [|(d, e, k, u, x)
2 |     for k in [|1; -1; 1; -3|] and u in [|2; -1; 3; -2; -3; 2|]
3 |     for x = -3 downto k and d in [|-2; 2; 0; 1|]
4 |     for e = 0 to 2
5 |     for e in [||] and x in [|0; 2|]
6 |     when u <> 0|]..
Warning 26 [unused-var]: unused variable x.

Lines 1-6, characters 0-17:
1 | [|(d, e, k, u, x)
2 |     for k in [|1; -1; 1; -3|] and u in [|2; -1; 3; -2; -3; 2|]
3 |     for x = -3 downto k and d in [|-2; 2; 0; 1|]
4 |     for e = 0 to 2
5 |     for e in [||] and x in [|0; 2|]
6 |     when u <> 0|]..
Warning 26 [unused-var]: unused variable e.

- : (int * '_weak8 * int * int * int) array = [||]
|}];;

[:(d, e, k, u, x)
    for k in [:1; -1; 1; -3:] and u in [:2; -1; 3; -2; -3; 2:]
    for x = -3 downto k and d in [:-2; 2; 0; 1:]
    for e = 0 to 2
    for e in [::] and x in [:0; 2:]
    when u <> 0:];;
[%%expect{|
Lines 1-6, characters 0-17:
1 | [:(d, e, k, u, x)
2 |     for k in [:1; -1; 1; -3:] and u in [:2; -1; 3; -2; -3; 2:]
3 |     for x = -3 downto k and d in [:-2; 2; 0; 1:]
4 |     for e = 0 to 2
5 |     for e in [::] and x in [:0; 2:]
6 |     when u <> 0:]..
Warning 26 [unused-var]: unused variable x.

Lines 1-6, characters 0-17:
1 | [:(d, e, k, u, x)
2 |     for k in [:1; -1; 1; -3:] and u in [:2; -1; 3; -2; -3; 2:]
3 |     for x = -3 downto k and d in [:-2; 2; 0; 1:]
4 |     for e = 0 to 2
5 |     for e in [::] and x in [:0; 2:]
6 |     when u <> 0:]..
Warning 26 [unused-var]: unused variable e.

- : (int * 'a * int * int * int) iarray = [::]
|}];;

[(h, l, m, p, q)
   for _ = -1 to 2 and l = -3 to -1
   for p in []
   for h in [-3; -2; 1]
   for q in [p; 1; -3; 1; l; 2]
   for m in [-1; -2; 2]];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(h, l, m, p, q)
    for _ = -1 to 2 and l = -3 to -1
    for p in [||]
    for h in [|-3; -2; 1|]
    for q in [|p; 1; -3; 1; l; 2|]
    for m in [|-1; -2; 2|]|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(h, l, m, p, q)
    for _ = -1 to 2 and l = -3 to -1
    for p in [::]
    for h in [:-3; -2; 1:]
    for q in [:p; 1; -3; 1; l; 2:]
    for m in [:-1; -2; 2:]:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(b, e, f, x, y, z)
   for x = 2 downto 0
   for y = x to x and f = -1 to -3
   for b in [1; 2; 2; -3; -2; 0] and _ = -3 downto 3 and e in [-1; -3; -2; 1]
   for z in [0; -2]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|p for _ in [|-3; 2|] and p = -1 to 1 when abs p mod 2 = 1|];;
[%%expect{|
- : int array = [|-1; 1; -1; 1|]
|}];;

[:p for _ in [:-3; 2:] and p = -1 to 1 when abs p mod 2 = 1:];;
[%%expect{|
- : int iarray = [:-1; 1; -1; 1:]
|}];;

[(i, m, o, q, s, t, w)
   for q in [3; -3; -2] and t in [-1; 3; 1]
   for w in [0; -3; 2] and _ = -3 downto 1
   for m in [] and s in [-1; -1; 3; t]
   when s > 0
   for i = 1 to -2 and o in [-1; q; 0; 1]];;
[%%expect{|
- : (int * 'a * int * int * int * int * int) list = []
|}];;

[|(i, m, o, q, s, t, w)
    for q in [|3; -3; -2|] and t in [|-1; 3; 1|]
    for w in [|0; -3; 2|] and _ = -3 downto 1
    for m in [||] and s in [|-1; -1; 3; t|]
    when s > 0
    for i = 1 to -2 and o in [|-1; q; 0; 1|]|];;
[%%expect{|
- : (int * '_weak9 * int * int * int * int * int) array = [||]
|}];;

[:(i, m, o, q, s, t, w)
    for q in [:3; -3; -2:] and t in [:-1; 3; 1:]
    for w in [:0; -3; 2:] and _ = -3 downto 1
    for m in [::] and s in [:-1; -1; 3; t:]
    when s > 0
    for i = 1 to -2 and o in [:-1; q; 0; 1:]:];;
[%%expect{|
- : (int * 'a * int * int * int * int * int) iarray = [::]
|}];;

[v for v in [3; 0; 2; -3; 1] for _ = 2 downto 2];;
[%%expect{|
- : int list = [3; 0; 2; -3; 1]
|}];;

[|v for v in [|3; 0; 2; -3; 1|] for _ = 2 downto 2|];;
[%%expect{|
- : int array = [|3; 0; 2; -3; 1|]
|}];;

[:v for v in [:3; 0; 2; -3; 1:] for _ = 2 downto 2:];;
[%%expect{|
- : int iarray = [:3; 0; 2; -3; 1:]
|}];;

[(a, i, v)
   for a = -3 to 0
   when a <> 0
   for i in [1; -2; -1; -3; 1]
   when i < 0
   for v = -3 to 2];;
[%%expect{|
- : (int * int * int) list =
[(-3, -2, -3); (-3, -2, -2); (-3, -2, -1); (-3, -2, 0); (-3, -2, 1);
 (-3, -2, 2); (-3, -1, -3); (-3, -1, -2); (-3, -1, -1); (-3, -1, 0);
 (-3, -1, 1); (-3, -1, 2); (-3, -3, -3); (-3, -3, -2); (-3, -3, -1);
 (-3, -3, 0); (-3, -3, 1); (-3, -3, 2); (-2, -2, -3); (-2, -2, -2);
 (-2, -2, -1); (-2, -2, 0); (-2, -2, 1); (-2, -2, 2); (-2, -1, -3);
 (-2, -1, -2); (-2, -1, -1); (-2, -1, 0); (-2, -1, 1); (-2, -1, 2);
 (-2, -3, -3); (-2, -3, -2); (-2, -3, -1); (-2, -3, 0); (-2, -3, 1);
 (-2, -3, 2); (-1, -2, -3); (-1, -2, -2); (-1, -2, -1); (-1, -2, 0);
 (-1, -2, 1); (-1, -2, 2); (-1, -1, -3); (-1, -1, -2); (-1, -1, -1);
 (-1, -1, 0); (-1, -1, 1); (-1, -1, 2); (-1, -3, -3); (-1, -3, -2);
 (-1, -3, -1); (-1, -3, 0); (-1, -3, 1); (-1, -3, 2)]
|}];;

[|(a, i, v)
    for a = -3 to 0
    when a <> 0
    for i in [|1; -2; -1; -3; 1|]
    when i < 0
    for v = -3 to 2|];;
[%%expect{|
- : (int * int * int) array =
[|(-3, -2, -3); (-3, -2, -2); (-3, -2, -1); (-3, -2, 0); (-3, -2, 1);
  (-3, -2, 2); (-3, -1, -3); (-3, -1, -2); (-3, -1, -1); (-3, -1, 0);
  (-3, -1, 1); (-3, -1, 2); (-3, -3, -3); (-3, -3, -2); (-3, -3, -1);
  (-3, -3, 0); (-3, -3, 1); (-3, -3, 2); (-2, -2, -3); (-2, -2, -2);
  (-2, -2, -1); (-2, -2, 0); (-2, -2, 1); (-2, -2, 2); (-2, -1, -3);
  (-2, -1, -2); (-2, -1, -1); (-2, -1, 0); (-2, -1, 1); (-2, -1, 2);
  (-2, -3, -3); (-2, -3, -2); (-2, -3, -1); (-2, -3, 0); (-2, -3, 1);
  (-2, -3, 2); (-1, -2, -3); (-1, -2, -2); (-1, -2, -1); (-1, -2, 0);
  (-1, -2, 1); (-1, -2, 2); (-1, -1, -3); (-1, -1, -2); (-1, -1, -1);
  (-1, -1, 0); (-1, -1, 1); (-1, -1, 2); (-1, -3, -3); (-1, -3, -2);
  (-1, -3, -1); (-1, -3, 0); (-1, -3, 1); (-1, -3, 2)|]
|}];;

[:(a, i, v)
    for a = -3 to 0
    when a <> 0
    for i in [:1; -2; -1; -3; 1:]
    when i < 0
    for v = -3 to 2:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-3, -2, -3); (-3, -2, -2); (-3, -2, -1); (-3, -2, 0); (-3, -2, 1);
  (-3, -2, 2); (-3, -1, -3); (-3, -1, -2); (-3, -1, -1); (-3, -1, 0);
  (-3, -1, 1); (-3, -1, 2); (-3, -3, -3); (-3, -3, -2); (-3, -3, -1);
  (-3, -3, 0); (-3, -3, 1); (-3, -3, 2); (-2, -2, -3); (-2, -2, -2);
  (-2, -2, -1); (-2, -2, 0); (-2, -2, 1); (-2, -2, 2); (-2, -1, -3);
  (-2, -1, -2); (-2, -1, -1); (-2, -1, 0); (-2, -1, 1); (-2, -1, 2);
  (-2, -3, -3); (-2, -3, -2); (-2, -3, -1); (-2, -3, 0); (-2, -3, 1);
  (-2, -3, 2); (-1, -2, -3); (-1, -2, -2); (-1, -2, -1); (-1, -2, 0);
  (-1, -2, 1); (-1, -2, 2); (-1, -1, -3); (-1, -1, -2); (-1, -1, -1);
  (-1, -1, 0); (-1, -1, 1); (-1, -1, 2); (-1, -3, -3); (-1, -3, -2);
  (-1, -3, -1); (-1, -3, 0); (-1, -3, 1); (-1, -3, 2):]
|}];;

[(a, d, i, v, y)
   for d = -2 to -2
   for a in [] and i = d to -3 and v in [2; 0; -1]
   when abs v mod 2 = 1
   for y in [-2]];;
[%%expect{|
- : ('a * int * int * int * int) list = []
|}];;

[|(a, d, i, v, y)
    for d = -2 to -2
    for a in [||] and i = d to -3 and v in [|2; 0; -1|]
    when abs v mod 2 = 1
    for y in [|-2|]|];;
[%%expect{|
- : ('_weak10 * int * int * int * int) array = [||]
|}];;

[:(a, d, i, v, y)
    for d = -2 to -2
    for a in [::] and i = d to -3 and v in [:2; 0; -1:]
    when abs v mod 2 = 1
    for y in [:-2:]:];;
[%%expect{|
- : ('a * int * int * int * int) iarray = [::]
|}];;

[(l, m, n, y)
   for l in [2; 3; -2]
   when l < 0
   for n = -2 downto 1
   for m in [n; 2; n; 1; -2; -1; -1] and y in []
   when abs y mod 2 = 0];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(l, m, n, y)
    for l in [|2; 3; -2|]
    when l < 0
    for n = -2 downto 1
    for m in [|n; 2; n; 1; -2; -1; -1|] and y in [||]
    when abs y mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(l, m, n, y)
    for l in [:2; 3; -2:]
    when l < 0
    for n = -2 downto 1
    for m in [:n; 2; n; 1; -2; -1; -1:] and y in [::]
    when abs y mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(c, f, j, k, q, x)
   for q = -3 to -2
   for k = -1 to -3 and c in [0]
   for x in [-1; 1; -3; -3]
   for f in [3; 0; 2; 3] and j in [-3]
   when c < 0];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(c, f, j, k, q, x)
    for q = -3 to -2
    for k = -1 to -3 and c in [|0|]
    for x in [|-1; 1; -3; -3|]
    for f in [|3; 0; 2; 3|] and j in [|-3|]
    when c < 0|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(c, f, j, k, q, x)
    for q = -3 to -2
    for k = -1 to -3 and c in [:0:]
    for x in [:-1; 1; -3; -3:]
    for f in [:3; 0; 2; 3:] and j in [:-3:]
    when c < 0:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(c, g) for c in [-2; -2] and g = 0 to 2];;
[%%expect{|
- : (int * int) list = [(-2, 0); (-2, 1); (-2, 2); (-2, 0); (-2, 1); (-2, 2)]
|}];;

[|(c, g) for c in [|-2; -2|] and g = 0 to 2|];;
[%%expect{|
- : (int * int) array =
[|(-2, 0); (-2, 1); (-2, 2); (-2, 0); (-2, 1); (-2, 2)|]
|}];;

[:(c, g) for c in [:-2; -2:] and g = 0 to 2:];;
[%%expect{|
- : (int * int) iarray =
[:(-2, 0); (-2, 1); (-2, 2); (-2, 0); (-2, 1); (-2, 2):]
|}];;

[r for r = -1 downto 3 when r > 0];;
[%%expect{|
- : int list = []
|}];;

[|r for r = -1 downto 3 when r > 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:r for r = -1 downto 3 when r > 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(n, s, u) for u = 1 downto -1 and s in [-1] and n = -2 to 1];;
[%%expect{|
- : (int * int * int) list =
[(-2, -1, 1); (-1, -1, 1); (0, -1, 1); (1, -1, 1); (-2, -1, 0); (-1, -1, 0);
 (0, -1, 0); (1, -1, 0); (-2, -1, -1); (-1, -1, -1); (0, -1, -1);
 (1, -1, -1)]
|}];;

[|(n, s, u) for u = 1 downto -1 and s in [|-1|] and n = -2 to 1|];;
[%%expect{|
- : (int * int * int) array =
[|(-2, -1, 1); (-1, -1, 1); (0, -1, 1); (1, -1, 1); (-2, -1, 0); (-1, -1, 0);
  (0, -1, 0); (1, -1, 0); (-2, -1, -1); (-1, -1, -1); (0, -1, -1);
  (1, -1, -1)|]
|}];;

[:(n, s, u) for u = 1 downto -1 and s in [:-1:] and n = -2 to 1:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-2, -1, 1); (-1, -1, 1); (0, -1, 1); (1, -1, 1); (-2, -1, 0); (-1, -1, 0);
  (0, -1, 0); (1, -1, 0); (-2, -1, -1); (-1, -1, -1); (0, -1, -1);
  (1, -1, -1):]
|}];;

[w for w = 0 to -2 and _ in [3; -1] when w > 0 when abs w mod 2 = 1];;
[%%expect{|
- : int list = []
|}];;

[|w for w = 0 to -2 and _ in [|3; -1|] when w > 0 when abs w mod 2 = 1|];;
[%%expect{|
- : int array = [||]
|}];;

[:w for w = 0 to -2 and _ in [:3; -1:] when w > 0 when abs w mod 2 = 1:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(e, h, k, p, s)
   for p = -2 downto -3 and k in [-1; 2; -1; 2; 2; 0]
   for _ in []
   for e = 2 to 1
   for h in [3; 1; 0; 2; 0; 1] and s in [-2; p; 0; -1; 2; -3; 3]
   for p in [0; h]];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(e, h, k, p, s)
    for p = -2 downto -3 and k in [|-1; 2; -1; 2; 2; 0|]
    for _ in [||]
    for e = 2 to 1
    for h in [|3; 1; 0; 2; 0; 1|] and s in [|-2; p; 0; -1; 2; -3; 3|]
    for p in [|0; h|]|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(e, h, k, p, s)
    for p = -2 downto -3 and k in [:-1; 2; -1; 2; 2; 0:]
    for _ in [::]
    for e = 2 to 1
    for h in [:3; 1; 0; 2; 0; 1:] and s in [:-2; p; 0; -1; 2; -3; 3:]
    for p in [:0; h:]:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(j, m, y) for y = 3 to 3 and j in [-2; 3; -1; -2; 1] and m = -2 to 2];;
[%%expect{|
- : (int * int * int) list =
[(-2, -2, 3); (-2, -1, 3); (-2, 0, 3); (-2, 1, 3); (-2, 2, 3); (3, -2, 3);
 (3, -1, 3); (3, 0, 3); (3, 1, 3); (3, 2, 3); (-1, -2, 3); (-1, -1, 3);
 (-1, 0, 3); (-1, 1, 3); (-1, 2, 3); (-2, -2, 3); (-2, -1, 3); (-2, 0, 3);
 (-2, 1, 3); (-2, 2, 3); (1, -2, 3); (1, -1, 3); (1, 0, 3); (1, 1, 3);
 (1, 2, 3)]
|}];;

[|(j, m, y) for y = 3 to 3 and j in [|-2; 3; -1; -2; 1|] and m = -2 to 2|];;
[%%expect{|
- : (int * int * int) array =
[|(-2, -2, 3); (-2, -1, 3); (-2, 0, 3); (-2, 1, 3); (-2, 2, 3); (3, -2, 3);
  (3, -1, 3); (3, 0, 3); (3, 1, 3); (3, 2, 3); (-1, -2, 3); (-1, -1, 3);
  (-1, 0, 3); (-1, 1, 3); (-1, 2, 3); (-2, -2, 3); (-2, -1, 3); (-2, 0, 3);
  (-2, 1, 3); (-2, 2, 3); (1, -2, 3); (1, -1, 3); (1, 0, 3); (1, 1, 3);
  (1, 2, 3)|]
|}];;

[:(j, m, y) for y = 3 to 3 and j in [:-2; 3; -1; -2; 1:] and m = -2 to 2:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-2, -2, 3); (-2, -1, 3); (-2, 0, 3); (-2, 1, 3); (-2, 2, 3); (3, -2, 3);
  (3, -1, 3); (3, 0, 3); (3, 1, 3); (3, 2, 3); (-1, -2, 3); (-1, -1, 3);
  (-1, 0, 3); (-1, 1, 3); (-1, 2, 3); (-2, -2, 3); (-2, -1, 3); (-2, 0, 3);
  (-2, 1, 3); (-2, 2, 3); (1, -2, 3); (1, -1, 3); (1, 0, 3); (1, 1, 3);
  (1, 2, 3):]
|}];;

[(r, x) for x in [2] and r = -1 downto -1];;
[%%expect{|
- : (int * int) list = [(-1, 2)]
|}];;

[|(r, x) for x in [|2|] and r = -1 downto -1|];;
[%%expect{|
- : (int * int) array = [|(-1, 2)|]
|}];;

[:(r, x) for x in [:2:] and r = -1 downto -1:];;
[%%expect{|
- : (int * int) iarray = [:(-1, 2):]
|}];;

[(q, w, z)
   for w = -1 downto -1 and z in [0; -1; -2; 2; -3; 1]
   for q in [-3; 3] and z = -3 downto -1
   when q <> 0];;
[%%expect{|
Line 2, characters 28-29:
2 |    for w = -1 downto -1 and z in [0; -1; -2; 2; -3; 1]
                                ^
Warning 26 [unused-var]: unused variable z.

- : (int * int * int) list = []
|}];;

[|(q, w, z)
    for w = -1 downto -1 and z in [|0; -1; -2; 2; -3; 1|]
    for q in [|-3; 3|] and z = -3 downto -1
    when q <> 0|];;
[%%expect{|
Line 2, characters 29-30:
2 |     for w = -1 downto -1 and z in [|0; -1; -2; 2; -3; 1|]
                                 ^
Warning 26 [unused-var]: unused variable z.

- : (int * int * int) array = [||]
|}];;

[:(q, w, z)
    for w = -1 downto -1 and z in [:0; -1; -2; 2; -3; 1:]
    for q in [:-3; 3:] and z = -3 downto -1
    when q <> 0:];;
[%%expect{|
Line 2, characters 29-30:
2 |     for w = -1 downto -1 and z in [:0; -1; -2; 2; -3; 1:]
                                 ^
Warning 26 [unused-var]: unused variable z.

- : (int * int * int) iarray = [::]
|}];;

[(o, p, u, w)
   for o = 0 downto -2
   when o > 0
   when abs o mod 2 = 1
   for u = -1 to 0
   for w = -3 downto 2 and p in [o; -1]];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(o, p, u, w)
    for o = 0 downto -2
    when o > 0
    when abs o mod 2 = 1
    for u = -1 to 0
    for w = -3 downto 2 and p in [|o; -1|]|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(o, p, u, w)
    for o = 0 downto -2
    when o > 0
    when abs o mod 2 = 1
    for u = -1 to 0
    for w = -3 downto 2 and p in [:o; -1:]:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(h, j, k, m, n, z)
   for z = 2 downto 0 and h = -1 downto 2 and j in [1; 2]
   for n in [0; -2] and k = -3 to -3
   when abs k mod 2 = 1
   for h in [h; j; -1; -1; 3; -3] and m in [z; -3; 2; -1; -3; 3; -2]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(h, j, k, m, n, z)
    for z = 2 downto 0 and h = -1 downto 2 and j in [|1; 2|]
    for n in [|0; -2|] and k = -3 to -3
    when abs k mod 2 = 1
    for h in [|h; j; -1; -1; 3; -3|] and m in [|z; -3; 2; -1; -3; 3; -2|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(h, j, k, m, n, z)
    for z = 2 downto 0 and h = -1 downto 2 and j in [:1; 2:]
    for n in [:0; -2:] and k = -3 to -3
    when abs k mod 2 = 1
    for h in [:h; j; -1; -1; 3; -3:] and m in [:z; -3; 2; -1; -3; 3; -2:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(d, n, p)
   for p in [1; 3; 0; 2; -1; -2]
   for d in [2; -2; 3]
   when d < 0
   when d < 0
   for n = -1 downto -2];;
[%%expect{|
- : (int * int * int) list =
[(-2, -1, 1); (-2, -2, 1); (-2, -1, 3); (-2, -2, 3); (-2, -1, 0);
 (-2, -2, 0); (-2, -1, 2); (-2, -2, 2); (-2, -1, -1); (-2, -2, -1);
 (-2, -1, -2); (-2, -2, -2)]
|}];;

[|(d, n, p)
    for p in [|1; 3; 0; 2; -1; -2|]
    for d in [|2; -2; 3|]
    when d < 0
    when d < 0
    for n = -1 downto -2|];;
[%%expect{|
- : (int * int * int) array =
[|(-2, -1, 1); (-2, -2, 1); (-2, -1, 3); (-2, -2, 3); (-2, -1, 0);
  (-2, -2, 0); (-2, -1, 2); (-2, -2, 2); (-2, -1, -1); (-2, -2, -1);
  (-2, -1, -2); (-2, -2, -2)|]
|}];;

[:(d, n, p)
    for p in [:1; 3; 0; 2; -1; -2:]
    for d in [:2; -2; 3:]
    when d < 0
    when d < 0
    for n = -1 downto -2:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-2, -1, 1); (-2, -2, 1); (-2, -1, 3); (-2, -2, 3); (-2, -1, 0);
  (-2, -2, 0); (-2, -1, 2); (-2, -2, 2); (-2, -1, -1); (-2, -2, -1);
  (-2, -1, -2); (-2, -2, -2):]
|}];;

[(e, i, k, n, r, w, x, y)
   for i in [3; -2; -3; -3] and w in [0; -1; 1; 3; -2] and x in [1; -2; 1; 3; 0]
   for x in [0; -1; 3] and e in [x; -2; -2; 1] and y in [1; 3; -3; 3; w]
   for n = -1 to -3
   for n = n to -3 and r = -2 to 2 and k in [i; -1; i; 2; 3; 2]];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) list = []
|}];;

[|(e, i, k, n, r, w, x, y)
    for i in [|3; -2; -3; -3|]
    and w in [|0; -1; 1; 3; -2|]
    and x in [|1; -2; 1; 3; 0|]
    for x in [|0; -1; 3|]
    and e in [|x; -2; -2; 1|]
    and y in [|1; 3; -3; 3; w|]
    for n = -1 to -3
    for n = n to -3
    and r = -2 to 2
    and k in [|i; -1; i; 2; 3; 2|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(e, i, k, n, r, w, x, y)
    for i in [:3; -2; -3; -3:]
    and w in [:0; -1; 1; 3; -2:]
    and x in [:1; -2; 1; 3; 0:]
    for x in [:0; -1; 3:]
    and e in [:x; -2; -2; 1:]
    and y in [:1; 3; -3; 3; w:]
    for n = -1 to -3
    for n = n to -3
    and r = -2 to 2
    and k in [:i; -1; i; 2; 3; 2:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(r, s, v, w)
   for s = -1 to 2
   when s > 0
   for r in [-1] and v in [] and w = -3 to 1
   for r in [-3; r; 2; -1; -1; 2; 0]];;
[%%expect{|
- : (int * int * 'a * int) list = []
|}];;

[|(r, s, v, w)
    for s = -1 to 2
    when s > 0
    for r in [|-1|] and v in [||] and w = -3 to 1
    for r in [|-3; r; 2; -1; -1; 2; 0|]|];;
[%%expect{|
- : (int * int * '_weak11 * int) array = [||]
|}];;

[:(r, s, v, w)
    for s = -1 to 2
    when s > 0
    for r in [:-1:] and v in [::] and w = -3 to 1
    for r in [:-3; r; 2; -1; -1; 2; 0:]:];;
[%%expect{|
- : (int * int * 'a * int) iarray = [::]
|}];;

[(d, e, n, p, w)
   for w in [3; -3; -3]
   for p in [0; -2; w; -2; 1; -2]
   for e = 3 to 0
   for n = 1 to w
   for d in [-2; -2; 3; 2; 2; -1; 3]];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(d, e, n, p, w)
    for w in [|3; -3; -3|]
    for p in [|0; -2; w; -2; 1; -2|]
    for e = 3 to 0
    for n = 1 to w
    for d in [|-2; -2; 3; 2; 2; -1; 3|]|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(d, e, n, p, w)
    for w in [:3; -3; -3:]
    for p in [:0; -2; w; -2; 1; -2:]
    for e = 3 to 0
    for n = 1 to w
    for d in [:-2; -2; 3; 2; 2; -1; 3:]:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(d, e, f, i, k, m, q, y)
   for q in [1; 3; -1] and i = 3 downto 2
   for m = -3 to -3 and f in [-3; -2]
   for e = -3 to 3 and d = -1 downto -3
   for k in []
   for y in [0; -3; 2] and f = 1 to f];;
[%%expect{|
- : (int * int * int * int * 'a * int * int * int) list = []
|}];;

[|(d, e, f, i, k, m, q, y)
    for q in [|1; 3; -1|] and i = 3 downto 2
    for m = -3 to -3 and f in [|-3; -2|]
    for e = -3 to 3 and d = -1 downto -3
    for k in [||]
    for y in [|0; -3; 2|] and f = 1 to f|];;
[%%expect{|
- : (int * int * int * int * '_weak12 * int * int * int) array = [||]
|}];;

[:(d, e, f, i, k, m, q, y)
    for q in [:1; 3; -1:] and i = 3 downto 2
    for m = -3 to -3 and f in [:-3; -2:]
    for e = -3 to 3 and d = -1 downto -3
    for k in [::]
    for y in [:0; -3; 2:] and f = 1 to f:];;
[%%expect{|
- : (int * int * int * int * 'a * int * int * int) iarray = [::]
|}];;

[f for f in [-1] when abs f mod 2 = 0];;
[%%expect{|
- : int list = []
|}];;

[|f for f in [|-1|] when abs f mod 2 = 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:f for f in [:-1:] when abs f mod 2 = 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(k, m) for m = -3 to 2 when m > 0 for k in [1]];;
[%%expect{|
- : (int * int) list = [(1, 1); (1, 2)]
|}];;

[|(k, m) for m = -3 to 2 when m > 0 for k in [|1|]|];;
[%%expect{|
- : (int * int) array = [|(1, 1); (1, 2)|]
|}];;

[:(k, m) for m = -3 to 2 when m > 0 for k in [:1:]:];;
[%%expect{|
- : (int * int) iarray = [:(1, 1); (1, 2):]
|}];;

[(f, o, p, t, y)
   for t in [2; 1; 1; 3; 3; -2] and p in [0; 3]
   when p <> 0
   for t in [1] and o = 2 to -2
   for f in [2; -1; 3; 0; -2; -3; 1] and y in [p; 2; 3; -2]
   when abs f mod 2 = 0];;
[%%expect{|
Line 2, characters 7-8:
2 |    for t in [2; 1; 1; 3; 3; -2] and p in [0; 3]
           ^
Warning 26 [unused-var]: unused variable t.

- : (int * int * int * int * int) list = []
|}];;

[|(f, o, p, t, y)
    for t in [|2; 1; 1; 3; 3; -2|] and p in [|0; 3|]
    when p <> 0
    for t in [|1|] and o = 2 to -2
    for f in [|2; -1; 3; 0; -2; -3; 1|] and y in [|p; 2; 3; -2|]
    when abs f mod 2 = 0|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for t in [|2; 1; 1; 3; 3; -2|] and p in [|0; 3|]
            ^
Warning 26 [unused-var]: unused variable t.

- : (int * int * int * int * int) array = [||]
|}];;

[:(f, o, p, t, y)
    for t in [:2; 1; 1; 3; 3; -2:] and p in [:0; 3:]
    when p <> 0
    for t in [:1:] and o = 2 to -2
    for f in [:2; -1; 3; 0; -2; -3; 1:] and y in [:p; 2; 3; -2:]
    when abs f mod 2 = 0:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for t in [:2; 1; 1; 3; 3; -2:] and p in [:0; 3:]
            ^
Warning 26 [unused-var]: unused variable t.

- : (int * int * int * int * int) iarray = [::]
|}];;

[(d, j, o, z)
   for o = 2 downto -3
   for j = -2 to 3
   for z in [2; 3; -3] and d = 0 downto 1];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(d, j, o, z)
    for o = 2 downto -3
    for j = -2 to 3
    for z in [|2; 3; -3|] and d = 0 downto 1|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(d, j, o, z)
    for o = 2 downto -3
    for j = -2 to 3
    for z in [:2; 3; -3:] and d = 0 downto 1:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[j for j in [-3; 0; 3; 2; -1] when abs j mod 2 = 1];;
[%%expect{|
- : int list = [-3; 3; -1]
|}];;

[|j for j in [|-3; 0; 3; 2; -1|] when abs j mod 2 = 1|];;
[%%expect{|
- : int array = [|-3; 3; -1|]
|}];;

[:j for j in [:-3; 0; 3; 2; -1:] when abs j mod 2 = 1:];;
[%%expect{|
- : int iarray = [:-3; 3; -1:]
|}];;

[(e, f, l, t)
   for t in [1; 1; -2; 1; -2] and e = 0 to 3 and f = 2 downto 0 and l = -1 to -1
   when t > 0
   when e <> 0];;
[%%expect{|
- : (int * int * int * int) list =
[(1, 2, -1, 1); (1, 1, -1, 1); (1, 0, -1, 1); (2, 2, -1, 1); (2, 1, -1, 1);
 (2, 0, -1, 1); (3, 2, -1, 1); (3, 1, -1, 1); (3, 0, -1, 1); (1, 2, -1, 1);
 (1, 1, -1, 1); (1, 0, -1, 1); (2, 2, -1, 1); (2, 1, -1, 1); (2, 0, -1, 1);
 (3, 2, -1, 1); (3, 1, -1, 1); (3, 0, -1, 1); (1, 2, -1, 1); (1, 1, -1, 1);
 (1, 0, -1, 1); (2, 2, -1, 1); (2, 1, -1, 1); (2, 0, -1, 1); (3, 2, -1, 1);
 (3, 1, -1, 1); (3, 0, -1, 1)]
|}];;

[|(e, f, l, t)
    for t in [|1; 1; -2; 1; -2|]
    and e = 0 to 3
    and f = 2 downto 0
    and l = -1 to -1
    when t > 0
    when e <> 0|];;
[%%expect{|
- : (int * int * int * int) array =
[|(1, 2, -1, 1); (1, 1, -1, 1); (1, 0, -1, 1); (2, 2, -1, 1); (2, 1, -1, 1);
  (2, 0, -1, 1); (3, 2, -1, 1); (3, 1, -1, 1); (3, 0, -1, 1); (1, 2, -1, 1);
  (1, 1, -1, 1); (1, 0, -1, 1); (2, 2, -1, 1); (2, 1, -1, 1); (2, 0, -1, 1);
  (3, 2, -1, 1); (3, 1, -1, 1); (3, 0, -1, 1); (1, 2, -1, 1); (1, 1, -1, 1);
  (1, 0, -1, 1); (2, 2, -1, 1); (2, 1, -1, 1); (2, 0, -1, 1); (3, 2, -1, 1);
  (3, 1, -1, 1); (3, 0, -1, 1)|]
|}];;

[:(e, f, l, t)
    for t in [:1; 1; -2; 1; -2:]
    and e = 0 to 3
    and f = 2 downto 0
    and l = -1 to -1
    when t > 0
    when e <> 0:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(1, 2, -1, 1); (1, 1, -1, 1); (1, 0, -1, 1); (2, 2, -1, 1); (2, 1, -1, 1);
  (2, 0, -1, 1); (3, 2, -1, 1); (3, 1, -1, 1); (3, 0, -1, 1); (1, 2, -1, 1);
  (1, 1, -1, 1); (1, 0, -1, 1); (2, 2, -1, 1); (2, 1, -1, 1); (2, 0, -1, 1);
  (3, 2, -1, 1); (3, 1, -1, 1); (3, 0, -1, 1); (1, 2, -1, 1); (1, 1, -1, 1);
  (1, 0, -1, 1); (2, 2, -1, 1); (2, 1, -1, 1); (2, 0, -1, 1); (3, 2, -1, 1);
  (3, 1, -1, 1); (3, 0, -1, 1):]
|}];;

[(e, g, n, o, p, s)
   for o in [1] and n = -1 to -1
   when abs n mod 2 = 0
   for s = -1 downto 1 and p = 1 to 1
   for g in [1; -2; 3; -3; 0; 0]
   for _ = 0 downto 0 and e in [0; 3; 1; p]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(e, g, n, o, p, s)
    for o in [|1|] and n = -1 to -1
    when abs n mod 2 = 0
    for s = -1 downto 1 and p = 1 to 1
    for g in [|1; -2; 3; -3; 0; 0|]
    for _ = 0 downto 0 and e in [|0; 3; 1; p|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(e, g, n, o, p, s)
    for o in [:1:] and n = -1 to -1
    when abs n mod 2 = 0
    for s = -1 downto 1 and p = 1 to 1
    for g in [:1; -2; 3; -3; 0; 0:]
    for _ = 0 downto 0 and e in [:0; 3; 1; p:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(b, c, e, g, k, q, t)
   for b in [-2; -2; -1; 1; -2] and k in [-2; 3; 3]
   for e in [0; 1; -3; -2; 1] and t in [0]
   for g = b downto 1 and q = 3 to 2 and c = -3 downto 2];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(b, c, e, g, k, q, t)
    for b in [|-2; -2; -1; 1; -2|] and k in [|-2; 3; 3|]
    for e in [|0; 1; -3; -2; 1|] and t in [|0|]
    for g = b downto 1 and q = 3 to 2 and c = -3 downto 2|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(b, c, e, g, k, q, t)
    for b in [:-2; -2; -1; 1; -2:] and k in [:-2; 3; 3:]
    for e in [:0; 1; -3; -2; 1:] and t in [:0:]
    for g = b downto 1 and q = 3 to 2 and c = -3 downto 2:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(f, t, u, z)
   for z in [2; 1; -1; 0; -3] and f in [2; 3; -1]
   for u = -1 downto 3 and t = -2 downto 3];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(f, t, u, z)
    for z in [|2; 1; -1; 0; -3|] and f in [|2; 3; -1|]
    for u = -1 downto 3 and t = -2 downto 3|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(f, t, u, z)
    for z in [:2; 1; -1; 0; -3:] and f in [:2; 3; -1:]
    for u = -1 downto 3 and t = -2 downto 3:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(l, o, q) for q in [-3; 2] and o in [3; -1; 1; 0; 1; -2] for l = -1 to -1];;
[%%expect{|
- : (int * int * int) list =
[(-1, 3, -3); (-1, -1, -3); (-1, 1, -3); (-1, 0, -3); (-1, 1, -3);
 (-1, -2, -3); (-1, 3, 2); (-1, -1, 2); (-1, 1, 2); (-1, 0, 2); (-1, 1, 2);
 (-1, -2, 2)]
|}];;

[|(l, o, q)
    for q in [|-3; 2|] and o in [|3; -1; 1; 0; 1; -2|]
    for l = -1 to -1|];;
[%%expect{|
- : (int * int * int) array =
[|(-1, 3, -3); (-1, -1, -3); (-1, 1, -3); (-1, 0, -3); (-1, 1, -3);
  (-1, -2, -3); (-1, 3, 2); (-1, -1, 2); (-1, 1, 2); (-1, 0, 2); (-1, 1, 2);
  (-1, -2, 2)|]
|}];;

[:(l, o, q)
    for q in [:-3; 2:] and o in [:3; -1; 1; 0; 1; -2:]
    for l = -1 to -1:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-1, 3, -3); (-1, -1, -3); (-1, 1, -3); (-1, 0, -3); (-1, 1, -3);
  (-1, -2, -3); (-1, 3, 2); (-1, -1, 2); (-1, 1, 2); (-1, 0, 2); (-1, 1, 2);
  (-1, -2, 2):]
|}];;

[(a, s, v)
   for s in [2; -1; 2; -2]
   and a in [1; 2]
   and _ = 3 downto 2
   and v in [2; 0; 0; 1]];;
[%%expect{|
- : (int * int * int) list =
[(1, 2, 2); (1, 2, 0); (1, 2, 0); (1, 2, 1); (1, 2, 2); (1, 2, 0); (1, 2, 0);
 (1, 2, 1); (2, 2, 2); (2, 2, 0); (2, 2, 0); (2, 2, 1); (2, 2, 2); (2, 2, 0);
 (2, 2, 0); (2, 2, 1); (1, -1, 2); (1, -1, 0); (1, -1, 0); (1, -1, 1);
 (1, -1, 2); (1, -1, 0); (1, -1, 0); (1, -1, 1); (2, -1, 2); (2, -1, 0);
 (2, -1, 0); (2, -1, 1); (2, -1, 2); (2, -1, 0); (2, -1, 0); (2, -1, 1);
 (1, 2, 2); (1, 2, 0); (1, 2, 0); (1, 2, 1); (1, 2, 2); (1, 2, 0); (1, 2, 0);
 (1, 2, 1); (2, 2, 2); (2, 2, 0); (2, 2, 0); (2, 2, 1); (2, 2, 2); (2, 2, 0);
 (2, 2, 0); (2, 2, 1); (1, -2, 2); (1, -2, 0); (1, -2, 0); (1, -2, 1);
 (1, -2, 2); (1, -2, 0); (1, -2, 0); (1, -2, 1); (2, -2, 2); (2, -2, 0);
 (2, -2, 0); (2, -2, 1); (2, -2, 2); (2, -2, 0); (2, -2, 0); (2, -2, 1)]
|}];;

[|(a, s, v)
    for s in [|2; -1; 2; -2|]
    and a in [|1; 2|]
    and _ = 3 downto 2
    and v in [|2; 0; 0; 1|]|];;
[%%expect{|
- : (int * int * int) array =
[|(1, 2, 2); (1, 2, 0); (1, 2, 0); (1, 2, 1); (1, 2, 2); (1, 2, 0);
  (1, 2, 0); (1, 2, 1); (2, 2, 2); (2, 2, 0); (2, 2, 0); (2, 2, 1);
  (2, 2, 2); (2, 2, 0); (2, 2, 0); (2, 2, 1); (1, -1, 2); (1, -1, 0);
  (1, -1, 0); (1, -1, 1); (1, -1, 2); (1, -1, 0); (1, -1, 0); (1, -1, 1);
  (2, -1, 2); (2, -1, 0); (2, -1, 0); (2, -1, 1); (2, -1, 2); (2, -1, 0);
  (2, -1, 0); (2, -1, 1); (1, 2, 2); (1, 2, 0); (1, 2, 0); (1, 2, 1);
  (1, 2, 2); (1, 2, 0); (1, 2, 0); (1, 2, 1); (2, 2, 2); (2, 2, 0);
  (2, 2, 0); (2, 2, 1); (2, 2, 2); (2, 2, 0); (2, 2, 0); (2, 2, 1);
  (1, -2, 2); (1, -2, 0); (1, -2, 0); (1, -2, 1); (1, -2, 2); (1, -2, 0);
  (1, -2, 0); (1, -2, 1); (2, -2, 2); (2, -2, 0); (2, -2, 0); (2, -2, 1);
  (2, -2, 2); (2, -2, 0); (2, -2, 0); (2, -2, 1)|]
|}];;

[:(a, s, v)
    for s in [:2; -1; 2; -2:]
    and a in [:1; 2:]
    and _ = 3 downto 2
    and v in [:2; 0; 0; 1:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(1, 2, 2); (1, 2, 0); (1, 2, 0); (1, 2, 1); (1, 2, 2); (1, 2, 0);
  (1, 2, 0); (1, 2, 1); (2, 2, 2); (2, 2, 0); (2, 2, 0); (2, 2, 1);
  (2, 2, 2); (2, 2, 0); (2, 2, 0); (2, 2, 1); (1, -1, 2); (1, -1, 0);
  (1, -1, 0); (1, -1, 1); (1, -1, 2); (1, -1, 0); (1, -1, 0); (1, -1, 1);
  (2, -1, 2); (2, -1, 0); (2, -1, 0); (2, -1, 1); (2, -1, 2); (2, -1, 0);
  (2, -1, 0); (2, -1, 1); (1, 2, 2); (1, 2, 0); (1, 2, 0); (1, 2, 1);
  (1, 2, 2); (1, 2, 0); (1, 2, 0); (1, 2, 1); (2, 2, 2); (2, 2, 0);
  (2, 2, 0); (2, 2, 1); (2, 2, 2); (2, 2, 0); (2, 2, 0); (2, 2, 1);
  (1, -2, 2); (1, -2, 0); (1, -2, 0); (1, -2, 1); (1, -2, 2); (1, -2, 0);
  (1, -2, 0); (1, -2, 1); (2, -2, 2); (2, -2, 0); (2, -2, 0); (2, -2, 1);
  (2, -2, 2); (2, -2, 0); (2, -2, 0); (2, -2, 1):]
|}];;

[(i, k, p, q, t, v)
   for v = 2 downto -2 and p = 2 downto -1
   for p = 0 to -2
   for q in [3; -2; 3; -3]
   for i = 2 downto q
   for k in [2] and t = 3 to -3];;
[%%expect{|
Lines 1-6, characters 0-32:
1 | [(i, k, p, q, t, v)
2 |    for v = 2 downto -2 and p = 2 downto -1
3 |    for p = 0 to -2
4 |    for q in [3; -2; 3; -3]
5 |    for i = 2 downto q
6 |    for k in [2] and t = 3 to -3]..
Warning 26 [unused-var]: unused variable p.

- : (int * int * int * int * int * int) list = []
|}];;

[|(i, k, p, q, t, v)
    for v = 2 downto -2 and p = 2 downto -1
    for p = 0 to -2
    for q in [|3; -2; 3; -3|]
    for i = 2 downto q
    for k in [|2|] and t = 3 to -3|];;
[%%expect{|
Lines 1-6, characters 0-36:
1 | [|(i, k, p, q, t, v)
2 |     for v = 2 downto -2 and p = 2 downto -1
3 |     for p = 0 to -2
4 |     for q in [|3; -2; 3; -3|]
5 |     for i = 2 downto q
6 |     for k in [|2|] and t = 3 to -3|]..
Warning 26 [unused-var]: unused variable p.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(i, k, p, q, t, v)
    for v = 2 downto -2 and p = 2 downto -1
    for p = 0 to -2
    for q in [:3; -2; 3; -3:]
    for i = 2 downto q
    for k in [:2:] and t = 3 to -3:];;
[%%expect{|
Lines 1-6, characters 0-36:
1 | [:(i, k, p, q, t, v)
2 |     for v = 2 downto -2 and p = 2 downto -1
3 |     for p = 0 to -2
4 |     for q in [:3; -2; 3; -3:]
5 |     for i = 2 downto q
6 |     for k in [:2:] and t = 3 to -3:]..
Warning 26 [unused-var]: unused variable p.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(d, n, w) for w = -2 downto 2 and d = -3 to 3 and n = 3 downto 1 when d <> 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, i, j, k, n, t, u, v)
    for n in [|-1|] and i in [|1; -2; 3; 1; 2; 3; -2|]
    for t in [|-3; -2; 0|]
    for j = 1 downto -1 and v = 1 to -3 and a = 2 to t
    for u = -2 to 2 and k in [|-1|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, i, j, k, n, t, u, v)
    for n in [:-1:] and i in [:1; -2; 3; 1; 2; 3; -2:]
    for t in [:-3; -2; 0:]
    for j = 1 downto -1 and v = 1 to -3 and a = 2 to t
    for u = -2 to 2 and k in [:-1:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(e, l, q, z)
   for l in [-2; -3]
   for q = 3 to 0
   when l < 0
   for e in [1; 1; -1; 2; 0; -1]
   for z in [0]];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(e, l, q, z)
    for l in [|-2; -3|]
    for q = 3 to 0
    when l < 0
    for e in [|1; 1; -1; 2; 0; -1|]
    for z in [|0|]|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(e, l, q, z)
    for l in [:-2; -3:]
    for q = 3 to 0
    when l < 0
    for e in [:1; 1; -1; 2; 0; -1:]
    for z in [:0:]:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(o, r, t, v, w)
   for r in [-3; -1; 2; 3] and o = 3 downto 0
   when r > 0
   for w in [2]
   for v = 0 to r and t = 3 to -2
   for t = 0 downto t];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(o, r, t, v, w)
    for r in [|-3; -1; 2; 3|] and o = 3 downto 0
    when r > 0
    for w in [|2|]
    for v = 0 to r and t = 3 to -2
    for t = 0 downto t|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(o, r, t, v, w)
    for r in [:-3; -1; 2; 3:] and o = 3 downto 0
    when r > 0
    for w in [:2:]
    for v = 0 to r and t = 3 to -2
    for t = 0 downto t:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(s, u) for u = 3 downto 2 and s = 2 downto -2];;
[%%expect{|
- : (int * int) list =
[(2, 3); (1, 3); (0, 3); (-1, 3); (-2, 3); (2, 2); (1, 2); (0, 2); (-1, 2);
 (-2, 2)]
|}];;

[|(s, u) for u = 3 downto 2 and s = 2 downto -2|];;
[%%expect{|
- : (int * int) array =
[|(2, 3); (1, 3); (0, 3); (-1, 3); (-2, 3); (2, 2); (1, 2); (0, 2); (-1, 2);
  (-2, 2)|]
|}];;

[:(s, u) for u = 3 downto 2 and s = 2 downto -2:];;
[%%expect{|
- : (int * int) iarray =
[:(2, 3); (1, 3); (0, 3); (-1, 3); (-2, 3); (2, 2); (1, 2); (0, 2); (-1, 2);
  (-2, 2):]
|}];;

[(k, l, o)
   for l in [2; -2; 3; 3; 3]
   when l > 0
   for _ = 1 to l and k = -3 downto -2 and o = -1 to 2];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(k, l, o)
    for l in [|2; -2; 3; 3; 3|]
    when l > 0
    for _ = 1 to l and k = -3 downto -2 and o = -1 to 2|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(k, l, o)
    for l in [:2; -2; 3; 3; 3:]
    when l > 0
    for _ = 1 to l and k = -3 downto -2 and o = -1 to 2:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(a, b, v)
   for v in [3; 1; 0; -1; 1]
   and b in [0; 1; -1; 1; -3; -1]
   and a in [1; 1; 3; -3; 0; -2; 0]
   when abs b mod 2 = 0];;
[%%expect{|
- : (int * int * int) list =
[(1, 0, 3); (1, 0, 3); (3, 0, 3); (-3, 0, 3); (0, 0, 3); (-2, 0, 3);
 (0, 0, 3); (1, 0, 1); (1, 0, 1); (3, 0, 1); (-3, 0, 1); (0, 0, 1);
 (-2, 0, 1); (0, 0, 1); (1, 0, 0); (1, 0, 0); (3, 0, 0); (-3, 0, 0);
 (0, 0, 0); (-2, 0, 0); (0, 0, 0); (1, 0, -1); (1, 0, -1); (3, 0, -1);
 (-3, 0, -1); (0, 0, -1); (-2, 0, -1); (0, 0, -1); (1, 0, 1); (1, 0, 1);
 (3, 0, 1); (-3, 0, 1); (0, 0, 1); (-2, 0, 1); (0, 0, 1)]
|}];;

[|(a, b, v)
    for v in [|3; 1; 0; -1; 1|]
    and b in [|0; 1; -1; 1; -3; -1|]
    and a in [|1; 1; 3; -3; 0; -2; 0|]
    when abs b mod 2 = 0|];;
[%%expect{|
- : (int * int * int) array =
[|(1, 0, 3); (1, 0, 3); (3, 0, 3); (-3, 0, 3); (0, 0, 3); (-2, 0, 3);
  (0, 0, 3); (1, 0, 1); (1, 0, 1); (3, 0, 1); (-3, 0, 1); (0, 0, 1);
  (-2, 0, 1); (0, 0, 1); (1, 0, 0); (1, 0, 0); (3, 0, 0); (-3, 0, 0);
  (0, 0, 0); (-2, 0, 0); (0, 0, 0); (1, 0, -1); (1, 0, -1); (3, 0, -1);
  (-3, 0, -1); (0, 0, -1); (-2, 0, -1); (0, 0, -1); (1, 0, 1); (1, 0, 1);
  (3, 0, 1); (-3, 0, 1); (0, 0, 1); (-2, 0, 1); (0, 0, 1)|]
|}];;

[:(a, b, v)
    for v in [:3; 1; 0; -1; 1:]
    and b in [:0; 1; -1; 1; -3; -1:]
    and a in [:1; 1; 3; -3; 0; -2; 0:]
    when abs b mod 2 = 0:];;
[%%expect{|
- : (int * int * int) iarray =
[:(1, 0, 3); (1, 0, 3); (3, 0, 3); (-3, 0, 3); (0, 0, 3); (-2, 0, 3);
  (0, 0, 3); (1, 0, 1); (1, 0, 1); (3, 0, 1); (-3, 0, 1); (0, 0, 1);
  (-2, 0, 1); (0, 0, 1); (1, 0, 0); (1, 0, 0); (3, 0, 0); (-3, 0, 0);
  (0, 0, 0); (-2, 0, 0); (0, 0, 0); (1, 0, -1); (1, 0, -1); (3, 0, -1);
  (-3, 0, -1); (0, 0, -1); (-2, 0, -1); (0, 0, -1); (1, 0, 1); (1, 0, 1);
  (3, 0, 1); (-3, 0, 1); (0, 0, 1); (-2, 0, 1); (0, 0, 1):]
|}];;

[(b, c, i, p, w)
   for b = 3 downto 3 and p in [-1; 0]
   when b < 0
   when abs p mod 2 = 0
   for w = 0 to 2
   for i in [1; 3; 3; -3; -1; b] and c in [-3; 2; p; b; 2; 1; 1]];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(b, c, i, p, w)
    for b = 3 downto 3 and p in [|-1; 0|]
    when b < 0
    when abs p mod 2 = 0
    for w = 0 to 2
    for i in [|1; 3; 3; -3; -1; b|] and c in [|-3; 2; p; b; 2; 1; 1|]|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(b, c, i, p, w)
    for b = 3 downto 3 and p in [:-1; 0:]
    when b < 0
    when abs p mod 2 = 0
    for w = 0 to 2
    for i in [:1; 3; 3; -3; -1; b:] and c in [:-3; 2; p; b; 2; 1; 1:]:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(e, h, k, u)
   for k = 1 downto -3
   when k <> 0
   for e in [] and h in [-1; -1; 3; -1; 3]
   for u = -1 downto k
   when k < 0];;
[%%expect{|
- : ('a * int * int * int) list = []
|}];;

[|(e, h, k, u)
    for k = 1 downto -3
    when k <> 0
    for e in [||] and h in [|-1; -1; 3; -1; 3|]
    for u = -1 downto k
    when k < 0|];;
[%%expect{|
- : ('_weak13 * int * int * int) array = [||]
|}];;

[:(e, h, k, u)
    for k = 1 downto -3
    when k <> 0
    for e in [::] and h in [:-1; -1; 3; -1; 3:]
    for u = -1 downto k
    when k < 0:];;
[%%expect{|
- : ('a * int * int * int) iarray = [::]
|}];;

[(d, k, x)
   for k in [3; 2; -3] and x in [0; -1; 0; 2; -3; -3; -3]
   for d in [2; -3; -3]
   when abs d mod 2 = 0];;
[%%expect{|
- : (int * int * int) list =
[(2, 3, 0); (2, 3, -1); (2, 3, 0); (2, 3, 2); (2, 3, -3); (2, 3, -3);
 (2, 3, -3); (2, 2, 0); (2, 2, -1); (2, 2, 0); (2, 2, 2); (2, 2, -3);
 (2, 2, -3); (2, 2, -3); (2, -3, 0); (2, -3, -1); (2, -3, 0); (2, -3, 2);
 (2, -3, -3); (2, -3, -3); (2, -3, -3)]
|}];;

[|(d, k, x)
    for k in [|3; 2; -3|] and x in [|0; -1; 0; 2; -3; -3; -3|]
    for d in [|2; -3; -3|]
    when abs d mod 2 = 0|];;
[%%expect{|
- : (int * int * int) array =
[|(2, 3, 0); (2, 3, -1); (2, 3, 0); (2, 3, 2); (2, 3, -3); (2, 3, -3);
  (2, 3, -3); (2, 2, 0); (2, 2, -1); (2, 2, 0); (2, 2, 2); (2, 2, -3);
  (2, 2, -3); (2, 2, -3); (2, -3, 0); (2, -3, -1); (2, -3, 0); (2, -3, 2);
  (2, -3, -3); (2, -3, -3); (2, -3, -3)|]
|}];;

[:(d, k, x)
    for k in [:3; 2; -3:] and x in [:0; -1; 0; 2; -3; -3; -3:]
    for d in [:2; -3; -3:]
    when abs d mod 2 = 0:];;
[%%expect{|
- : (int * int * int) iarray =
[:(2, 3, 0); (2, 3, -1); (2, 3, 0); (2, 3, 2); (2, 3, -3); (2, 3, -3);
  (2, 3, -3); (2, 2, 0); (2, 2, -1); (2, 2, 0); (2, 2, 2); (2, 2, -3);
  (2, 2, -3); (2, 2, -3); (2, -3, 0); (2, -3, -1); (2, -3, 0); (2, -3, 2);
  (2, -3, -3); (2, -3, -3); (2, -3, -3):]
|}];;

[(a, x, z) for a = 2 to 2 for z = 3 to 2 and x = -2 to 3 when abs a mod 2 = 1];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, x, z)
    for a = 2 to 2
    for z = 3 to 2 and x = -2 to 3
    when abs a mod 2 = 1|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(a, x, z)
    for a = 2 to 2
    for z = 3 to 2 and x = -2 to 3
    when abs a mod 2 = 1:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(e, g, h, j, y, z)
   for g in [1; 3; 0; -2] and j in [-1]
   for y = 3 to -2 and z = 2 to g
   for e = 3 downto -1
   for h in [-3; 0]
   when abs h mod 2 = 0];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(e, g, h, j, y, z)
    for g in [|1; 3; 0; -2|] and j in [|-1|]
    for y = 3 to -2 and z = 2 to g
    for e = 3 downto -1
    for h in [|-3; 0|]
    when abs h mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(e, g, h, j, y, z)
    for g in [:1; 3; 0; -2:] and j in [:-1:]
    for y = 3 to -2 and z = 2 to g
    for e = 3 downto -1
    for h in [:-3; 0:]
    when abs h mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[l for _ in [1; 2; 0; 2; 0] and l in [-1; -3; 0; 0]];;
[%%expect{|
- : int list =
[-1; -3; 0; 0; -1; -3; 0; 0; -1; -3; 0; 0; -1; -3; 0; 0; -1; -3; 0; 0]
|}];;

[|l for _ in [|1; 2; 0; 2; 0|] and l in [|-1; -3; 0; 0|]|];;
[%%expect{|
- : int array =
[|-1; -3; 0; 0; -1; -3; 0; 0; -1; -3; 0; 0; -1; -3; 0; 0; -1; -3; 0; 0|]
|}];;

[:l for _ in [:1; 2; 0; 2; 0:] and l in [:-1; -3; 0; 0:]:];;
[%%expect{|
- : int iarray =
[:-1; -3; 0; 0; -1; -3; 0; 0; -1; -3; 0; 0; -1; -3; 0; 0; -1; -3; 0; 0:]
|}];;

[(c, d, f, g, m, o, q, r, y)
   for m in [-3; 2; -2; 0; 3; 1; -3] and o in [-2] and f = 2 downto 1
   for r = 1 to m and _ in [0] and c in [0; f; 2] and g = o downto 0
   for y = 1 downto 2 and d in [r; -2; 1; 0] and q in [-3; -1; 2; -1; -2; -3]];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int) list = []
|}];;

[|(c, d, f, g, m, o, q, r, y)
    for m in [|-3; 2; -2; 0; 3; 1; -3|]
    and o in [|-2|]
    and f = 2 downto 1
    for r = 1 to m
    and _ in [|0|]
    and c in [|0; f; 2|]
    and g = o downto 0
    for y = 1 downto 2
    and d in [|r; -2; 1; 0|]
    and q in [|-3; -1; 2; -1; -2; -3|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(c, d, f, g, m, o, q, r, y)
    for m in [:-3; 2; -2; 0; 3; 1; -3:]
    and o in [:-2:]
    and f = 2 downto 1
    for r = 1 to m
    and _ in [:0:]
    and c in [:0; f; 2:]
    and g = o downto 0
    for y = 1 downto 2
    and d in [:r; -2; 1; 0:]
    and q in [:-3; -1; 2; -1; -2; -3:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(h, k, n)
   for k in [-1; -2; 0; 2; -1]
   when abs k mod 2 = 1
   when k <> 0
   for n in [1; -2]
   for h in [-3; 3; 1; n; 0; 1; -1]];;
[%%expect{|
- : (int * int * int) list =
[(-3, -1, 1); (3, -1, 1); (1, -1, 1); (1, -1, 1); (0, -1, 1); (1, -1, 1);
 (-1, -1, 1); (-3, -1, -2); (3, -1, -2); (1, -1, -2); (-2, -1, -2);
 (0, -1, -2); (1, -1, -2); (-1, -1, -2); (-3, -1, 1); (3, -1, 1); (1, -1, 1);
 (1, -1, 1); (0, -1, 1); (1, -1, 1); (-1, -1, 1); (-3, -1, -2); (3, -1, -2);
 (1, -1, -2); (-2, -1, -2); (0, -1, -2); (1, -1, -2); (-1, -1, -2)]
|}];;

[|(h, k, n)
    for k in [|-1; -2; 0; 2; -1|]
    when abs k mod 2 = 1
    when k <> 0
    for n in [|1; -2|]
    for h in [|-3; 3; 1; n; 0; 1; -1|]|];;
[%%expect{|
- : (int * int * int) array =
[|(-3, -1, 1); (3, -1, 1); (1, -1, 1); (1, -1, 1); (0, -1, 1); (1, -1, 1);
  (-1, -1, 1); (-3, -1, -2); (3, -1, -2); (1, -1, -2); (-2, -1, -2);
  (0, -1, -2); (1, -1, -2); (-1, -1, -2); (-3, -1, 1); (3, -1, 1);
  (1, -1, 1); (1, -1, 1); (0, -1, 1); (1, -1, 1); (-1, -1, 1); (-3, -1, -2);
  (3, -1, -2); (1, -1, -2); (-2, -1, -2); (0, -1, -2); (1, -1, -2);
  (-1, -1, -2)|]
|}];;

[:(h, k, n)
    for k in [:-1; -2; 0; 2; -1:]
    when abs k mod 2 = 1
    when k <> 0
    for n in [:1; -2:]
    for h in [:-3; 3; 1; n; 0; 1; -1:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-3, -1, 1); (3, -1, 1); (1, -1, 1); (1, -1, 1); (0, -1, 1); (1, -1, 1);
  (-1, -1, 1); (-3, -1, -2); (3, -1, -2); (1, -1, -2); (-2, -1, -2);
  (0, -1, -2); (1, -1, -2); (-1, -1, -2); (-3, -1, 1); (3, -1, 1);
  (1, -1, 1); (1, -1, 1); (0, -1, 1); (1, -1, 1); (-1, -1, 1); (-3, -1, -2);
  (3, -1, -2); (1, -1, -2); (-2, -1, -2); (0, -1, -2); (1, -1, -2);
  (-1, -1, -2):]
|}];;

[(a, h, l, o)
   for o in [-1; 2; -3; 2; -3; 2]
   for h in [1] and l = 0 to -1
   for a = 0 downto 1];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(a, h, l, o)
    for o in [|-1; 2; -3; 2; -3; 2|]
    for h in [|1|] and l = 0 to -1
    for a = 0 downto 1|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(a, h, l, o)
    for o in [:-1; 2; -3; 2; -3; 2:]
    for h in [:1:] and l = 0 to -1
    for a = 0 downto 1:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(m, o, v)
   for o = 3 downto -1
   for v in [-1; -3; 1; 3] and o in [] and m = o to o];;
[%%expect{|
- : (int * 'a * int) list = []
|}];;

[|(m, o, v)
    for o = 3 downto -1
    for v in [|-1; -3; 1; 3|] and o in [||] and m = o to o|];;
[%%expect{|
- : (int * '_weak14 * int) array = [||]
|}];;

[:(m, o, v)
    for o = 3 downto -1
    for v in [:-1; -3; 1; 3:] and o in [::] and m = o to o:];;
[%%expect{|
- : (int * 'a * int) iarray = [::]
|}];;

[(b, d, i, l, o, q, u, y)
   for l in [2; -1; -3; 1; -1; 2] and y in [2; -3; 3; -1; 1; -2; 3]
   for o = 0 downto -2
   for b in [-2; -1; -1; -1] and d in [-1; -1]
   for u = -3 to y
   for q in [-3; -3] and i = 0 downto 1];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) list = []
|}];;

[|(b, d, i, l, o, q, u, y)
    for l in [|2; -1; -3; 1; -1; 2|] and y in [|2; -3; 3; -1; 1; -2; 3|]
    for o = 0 downto -2
    for b in [|-2; -1; -1; -1|] and d in [|-1; -1|]
    for u = -3 to y
    for q in [|-3; -3|] and i = 0 downto 1|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(b, d, i, l, o, q, u, y)
    for l in [:2; -1; -3; 1; -1; 2:] and y in [:2; -3; 3; -1; 1; -2; 3:]
    for o = 0 downto -2
    for b in [:-2; -1; -1; -1:] and d in [:-1; -1:]
    for u = -3 to y
    for q in [:-3; -3:] and i = 0 downto 1:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(g, o, p) for g = 1 to 2 and p in [1; 1; 0] for o in [1; 0; p]];;
[%%expect{|
- : (int * int * int) list =
[(1, 1, 1); (1, 0, 1); (1, 1, 1); (1, 1, 1); (1, 0, 1); (1, 1, 1); (1, 1, 0);
 (1, 0, 0); (1, 0, 0); (2, 1, 1); (2, 0, 1); (2, 1, 1); (2, 1, 1); (2, 0, 1);
 (2, 1, 1); (2, 1, 0); (2, 0, 0); (2, 0, 0)]
|}];;

[|(g, o, p) for g = 1 to 2 and p in [|1; 1; 0|] for o in [|1; 0; p|]|];;
[%%expect{|
- : (int * int * int) array =
[|(1, 1, 1); (1, 0, 1); (1, 1, 1); (1, 1, 1); (1, 0, 1); (1, 1, 1);
  (1, 1, 0); (1, 0, 0); (1, 0, 0); (2, 1, 1); (2, 0, 1); (2, 1, 1);
  (2, 1, 1); (2, 0, 1); (2, 1, 1); (2, 1, 0); (2, 0, 0); (2, 0, 0)|]
|}];;

[:(g, o, p) for g = 1 to 2 and p in [:1; 1; 0:] for o in [:1; 0; p:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(1, 1, 1); (1, 0, 1); (1, 1, 1); (1, 1, 1); (1, 0, 1); (1, 1, 1);
  (1, 1, 0); (1, 0, 0); (1, 0, 0); (2, 1, 1); (2, 0, 1); (2, 1, 1);
  (2, 1, 1); (2, 0, 1); (2, 1, 1); (2, 1, 0); (2, 0, 0); (2, 0, 0):]
|}];;

[(a, c, f, l, r, v, y)
   for v in [-2; 0; 1; -3] and _ in [-3; 1; 0; 0; -3]
   for a = -3 downto 3 and c = 1 downto -2
   for y in [0; 0; c; c; 3; 3] and _ in [2; v; c; 2; v]
   for r = -1 downto 2 and l = -3 downto -1
   for f in [0; 2; 2; 0; 0]];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(a, c, f, l, r, v, y)
    for v in [|-2; 0; 1; -3|] and _ in [|-3; 1; 0; 0; -3|]
    for a = -3 downto 3 and c = 1 downto -2
    for y in [|0; 0; c; c; 3; 3|] and _ in [|2; v; c; 2; v|]
    for r = -1 downto 2 and l = -3 downto -1
    for f in [|0; 2; 2; 0; 0|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, c, f, l, r, v, y)
    for v in [:-2; 0; 1; -3:] and _ in [:-3; 1; 0; 0; -3:]
    for a = -3 downto 3 and c = 1 downto -2
    for y in [:0; 0; c; c; 3; 3:] and _ in [:2; v; c; 2; v:]
    for r = -1 downto 2 and l = -3 downto -1
    for f in [:0; 2; 2; 0; 0:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(r, t, v)
   for r = 0 downto -3 and v = -3 to 2
   when r <> 0
   for t = 2 to -2
   when r <> 0
   when abs v mod 2 = 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(r, t, v)
    for r = 0 downto -3 and v = -3 to 2
    when r <> 0
    for t = 2 to -2
    when r <> 0
    when abs v mod 2 = 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(r, t, v)
    for r = 0 downto -3 and v = -3 to 2
    when r <> 0
    for t = 2 to -2
    when r <> 0
    when abs v mod 2 = 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(a, b, d, g, o, t, z)
   for t = -2 to 2 and o in [2]
   for g in [-3; 3; 0; 1; 2] and a in [-2]
   when abs o mod 2 = 0
   for b in [-1; -3; 0] and d = 1 to -1
   for z in [b; -2; 0; -1; -3; -1; d]];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(a, b, d, g, o, t, z)
    for t = -2 to 2 and o in [|2|]
    for g in [|-3; 3; 0; 1; 2|] and a in [|-2|]
    when abs o mod 2 = 0
    for b in [|-1; -3; 0|] and d = 1 to -1
    for z in [|b; -2; 0; -1; -3; -1; d|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, b, d, g, o, t, z)
    for t = -2 to 2 and o in [:2:]
    for g in [:-3; 3; 0; 1; 2:] and a in [:-2:]
    when abs o mod 2 = 0
    for b in [:-1; -3; 0:] and d = 1 to -1
    for z in [:b; -2; 0; -1; -3; -1; d:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(c, f, l, p, x)
   for c in [-3; 3; -2; -2; -1; 3; 2]
   for _ = -1 to -1
   for f = 1 to -1
   for x in [2; -3; -3; f; c; 1]
   for l = 1 downto 2 and p in [-1]];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(c, f, l, p, x)
    for c in [|-3; 3; -2; -2; -1; 3; 2|]
    for _ = -1 to -1
    for f = 1 to -1
    for x in [|2; -3; -3; f; c; 1|]
    for l = 1 downto 2 and p in [|-1|]|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(c, f, l, p, x)
    for c in [:-3; 3; -2; -2; -1; 3; 2:]
    for _ = -1 to -1
    for f = 1 to -1
    for x in [:2; -3; -3; f; c; 1:]
    for l = 1 downto 2 and p in [:-1:]:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(c, d, f, h, k, l, n, r, w, y)
   for r = 0 to 2 and n in [-3; 3; 0; 3]
   for d = 1 downto -1 and c in [3; 1; -2; -2]
   for h = n downto -3 and w = 2 to -1 and l = r downto 0
   for y in [-1; 2; -3; -1; 1] and k = d downto 2 and f = 3 downto -2];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int * int) list = []
|}];;

[|(c, d, f, h, k, l, n, r, w, y)
    for r = 0 to 2 and n in [|-3; 3; 0; 3|]
    for d = 1 downto -1 and c in [|3; 1; -2; -2|]
    for h = n downto -3 and w = 2 to -1 and l = r downto 0
    for y in [|-1; 2; -3; -1; 1|] and k = d downto 2 and f = 3 downto -2|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(c, d, f, h, k, l, n, r, w, y)
    for r = 0 to 2 and n in [:-3; 3; 0; 3:]
    for d = 1 downto -1 and c in [:3; 1; -2; -2:]
    for h = n downto -3 and w = 2 to -1 and l = r downto 0
    for y in [:-1; 2; -3; -1; 1:] and k = d downto 2 and f = 3 downto -2:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(a, b) for b in [2; -1; 2; -2; 3; 0; 0] and a = 3 to 3];;
[%%expect{|
- : (int * int) list =
[(3, 2); (3, -1); (3, 2); (3, -2); (3, 3); (3, 0); (3, 0)]
|}];;

[|(a, b) for b in [|2; -1; 2; -2; 3; 0; 0|] and a = 3 to 3|];;
[%%expect{|
- : (int * int) array =
[|(3, 2); (3, -1); (3, 2); (3, -2); (3, 3); (3, 0); (3, 0)|]
|}];;

[:(a, b) for b in [:2; -1; 2; -2; 3; 0; 0:] and a = 3 to 3:];;
[%%expect{|
- : (int * int) iarray =
[:(3, 2); (3, -1); (3, 2); (3, -2); (3, 3); (3, 0); (3, 0):]
|}];;

[(m, r) for r in [] and m in []];;
[%%expect{|
- : ('a * 'b) list = []
|}];;

[|(m, r) for r in [||] and m in [||]|];;
[%%expect{|
- : ('_weak15 * '_weak16) array = [||]
|}];;

[:(m, r) for r in [::] and m in [::]:];;
[%%expect{|
- : ('a * 'b) iarray = [::]
|}];;

[(d, j, l, o, u, v, w)
   for o in [1; 3; -2]
   and j = 1 downto -2
   and w in [-3; -1]
   and u = -3 downto -3
   for l = -3 downto 0
   and d = -2 downto -3
   and v in [j; 1; 2; -1; -1; 0]
   when o > 0];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(d, j, l, o, u, v, w)
    for o in [|1; 3; -2|]
    and j = 1 downto -2
    and w in [|-3; -1|]
    and u = -3 downto -3
    for l = -3 downto 0
    and d = -2 downto -3
    and v in [|j; 1; 2; -1; -1; 0|]
    when o > 0|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(d, j, l, o, u, v, w)
    for o in [:1; 3; -2:]
    and j = 1 downto -2
    and w in [:-3; -1:]
    and u = -3 downto -3
    for l = -3 downto 0
    and d = -2 downto -3
    and v in [:j; 1; 2; -1; -1; 0:]
    when o > 0:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(b, p, s, u)
   for s = -2 downto -2
   for b in [-2; 1; 0; s]
   for p in []
   when s <> 0
   for u = 3 downto p];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(b, p, s, u)
    for s = -2 downto -2
    for b in [|-2; 1; 0; s|]
    for p in [||]
    when s <> 0
    for u = 3 downto p|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(b, p, s, u)
    for s = -2 downto -2
    for b in [:-2; 1; 0; s:]
    for p in [::]
    when s <> 0
    for u = 3 downto p:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(a, b, f, p, u, z)
   for u = -3 to 0 and a in [-3; -3; -1; 2; -3; 3; 3]
   when a <> 0
   for p = -1 downto a
   for f = -3 to 2
   for b = 3 downto 2 and z = 3 to p];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(a, b, f, p, u, z)
    for u = -3 to 0 and a in [|-3; -3; -1; 2; -3; 3; 3|]
    when a <> 0
    for p = -1 downto a
    for f = -3 to 2
    for b = 3 downto 2 and z = 3 to p|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, b, f, p, u, z)
    for u = -3 to 0 and a in [:-3; -3; -1; 2; -3; 3; 3:]
    when a <> 0
    for p = -1 downto a
    for f = -3 to 2
    for b = 3 downto 2 and z = 3 to p:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(g, h, n)
   for h in [-3; 1] and g in [3; 2; -2; 0]
   when h > 0
   when abs h mod 2 = 0
   for n = 3 to 3];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(g, h, n)
    for h in [|-3; 1|] and g in [|3; 2; -2; 0|]
    when h > 0
    when abs h mod 2 = 0
    for n = 3 to 3|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(g, h, n)
    for h in [:-3; 1:] and g in [:3; 2; -2; 0:]
    when h > 0
    when abs h mod 2 = 0
    for n = 3 to 3:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(b, x)
   for x = -2 to 3 and b = -1 downto -1
   when abs x mod 2 = 1
   when abs b mod 2 = 1
   when b > 0];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(b, x)
    for x = -2 to 3 and b = -1 downto -1
    when abs x mod 2 = 1
    when abs b mod 2 = 1
    when b > 0|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(b, x)
    for x = -2 to 3 and b = -1 downto -1
    when abs x mod 2 = 1
    when abs b mod 2 = 1
    when b > 0:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[w for w in [0; -3; 2] when w < 0];;
[%%expect{|
- : int list = [-3]
|}];;

[|w for w in [|0; -3; 2|] when w < 0|];;
[%%expect{|
- : int array = [|-3|]
|}];;

[:w for w in [:0; -3; 2:] when w < 0:];;
[%%expect{|
- : int iarray = [:-3:]
|}];;

[(c, u, v, w, z)
   for z in [2; 1; 2; -3]
   for v = 1 to -2 and u in [2; 1] and c in [-3]
   for w = 3 to 0
   when abs u mod 2 = 0];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(c, u, v, w, z)
    for z in [|2; 1; 2; -3|]
    for v = 1 to -2 and u in [|2; 1|] and c in [|-3|]
    for w = 3 to 0
    when abs u mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(c, u, v, w, z)
    for z in [:2; 1; 2; -3:]
    for v = 1 to -2 and u in [:2; 1:] and c in [:-3:]
    for w = 3 to 0
    when abs u mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(d, k, p, r, x)
   for x = 2 downto -1 and k = -1 to -1 and _ in [-2; 3; -3]
   for r = 2 to 1 and d in [] and p in [-1; -1; 2; 2; -1; -3; -2]];;
[%%expect{|
- : ('a * int * int * int * int) list = []
|}];;

[|(d, k, p, r, x)
    for x = 2 downto -1 and k = -1 to -1 and _ in [|-2; 3; -3|]
    for r = 2 to 1 and d in [||] and p in [|-1; -1; 2; 2; -1; -3; -2|]|];;
[%%expect{|
- : ('_weak17 * int * int * int * int) array = [||]
|}];;

[:(d, k, p, r, x)
    for x = 2 downto -1 and k = -1 to -1 and _ in [:-2; 3; -3:]
    for r = 2 to 1 and d in [::] and p in [:-1; -1; 2; 2; -1; -3; -2:]:];;
[%%expect{|
- : ('a * int * int * int * int) iarray = [::]
|}];;

[(b, e, g, r, s, t)
   for b in [-1; 0; 0]
   for t = 0 to -1 and s = -3 downto 3 and g in [] and r = 2 downto -1
   for e in [1; 3]];;
[%%expect{|
- : (int * int * 'a * int * int * int) list = []
|}];;

[|(b, e, g, r, s, t)
    for b in [|-1; 0; 0|]
    for t = 0 to -1 and s = -3 downto 3 and g in [||] and r = 2 downto -1
    for e in [|1; 3|]|];;
[%%expect{|
- : (int * int * '_weak18 * int * int * int) array = [||]
|}];;

[:(b, e, g, r, s, t)
    for b in [:-1; 0; 0:]
    for t = 0 to -1 and s = -3 downto 3 and g in [::] and r = 2 downto -1
    for e in [:1; 3:]:];;
[%%expect{|
- : (int * int * 'a * int * int * int) iarray = [::]
|}];;

[(h, t)
   for t in [0; 1; -2; 2] and h in [3; -2; -1; -3; -2; 0]
   when h <> 0
   for t = 3 downto t];;
[%%expect{|
- : (int * int) list =
[(3, 3); (3, 2); (3, 1); (3, 0); (-2, 3); (-2, 2); (-2, 1); (-2, 0);
 (-1, 3); (-1, 2); (-1, 1); (-1, 0); (-3, 3); (-3, 2); (-3, 1); (-3, 0);
 (-2, 3); (-2, 2); (-2, 1); (-2, 0); (3, 3); (3, 2); (3, 1); (-2, 3);
 (-2, 2); (-2, 1); (-1, 3); (-1, 2); (-1, 1); (-3, 3); (-3, 2); (-3, 1);
 (-2, 3); (-2, 2); (-2, 1); (3, 3); (3, 2); (3, 1); (3, 0); (3, -1);
 (3, -2); (-2, 3); (-2, 2); (-2, 1); (-2, 0); (-2, -1); (-2, -2); (-1, 3);
 (-1, 2); (-1, 1); (-1, 0); (-1, -1); (-1, -2); (-3, 3); (-3, 2); (-3, 1);
 (-3, 0); (-3, -1); (-3, -2); (-2, 3); (-2, 2); (-2, 1); (-2, 0); (-2, -1);
 (-2, -2); (3, 3); (3, 2); (-2, 3); (-2, 2); (-1, 3); (-1, 2); (-3, 3);
 (-3, 2); (-2, 3); (-2, 2)]
|}];;

[|(h, t)
    for t in [|0; 1; -2; 2|] and h in [|3; -2; -1; -3; -2; 0|]
    when h <> 0
    for t = 3 downto t|];;
[%%expect{|
- : (int * int) array =
[|(3, 3); (3, 2); (3, 1); (3, 0); (-2, 3); (-2, 2); (-2, 1); (-2, 0);
  (-1, 3); (-1, 2); (-1, 1); (-1, 0); (-3, 3); (-3, 2); (-3, 1); (-3, 0);
  (-2, 3); (-2, 2); (-2, 1); (-2, 0); (3, 3); (3, 2); (3, 1); (-2, 3);
  (-2, 2); (-2, 1); (-1, 3); (-1, 2); (-1, 1); (-3, 3); (-3, 2); (-3, 1);
  (-2, 3); (-2, 2); (-2, 1); (3, 3); (3, 2); (3, 1); (3, 0); (3, -1);
  (3, -2); (-2, 3); (-2, 2); (-2, 1); (-2, 0); (-2, -1); (-2, -2); (-1, 3);
  (-1, 2); (-1, 1); (-1, 0); (-1, -1); (-1, -2); (-3, 3); (-3, 2); (-3, 1);
  (-3, 0); (-3, -1); (-3, -2); (-2, 3); (-2, 2); (-2, 1); (-2, 0); (-2, -1);
  (-2, -2); (3, 3); (3, 2); (-2, 3); (-2, 2); (-1, 3); (-1, 2); (-3, 3);
  (-3, 2); (-2, 3); (-2, 2)|]
|}];;

[:(h, t)
    for t in [:0; 1; -2; 2:] and h in [:3; -2; -1; -3; -2; 0:]
    when h <> 0
    for t = 3 downto t:];;
[%%expect{|
- : (int * int) iarray =
[:(3, 3); (3, 2); (3, 1); (3, 0); (-2, 3); (-2, 2); (-2, 1); (-2, 0);
  (-1, 3); (-1, 2); (-1, 1); (-1, 0); (-3, 3); (-3, 2); (-3, 1); (-3, 0);
  (-2, 3); (-2, 2); (-2, 1); (-2, 0); (3, 3); (3, 2); (3, 1); (-2, 3);
  (-2, 2); (-2, 1); (-1, 3); (-1, 2); (-1, 1); (-3, 3); (-3, 2); (-3, 1);
  (-2, 3); (-2, 2); (-2, 1); (3, 3); (3, 2); (3, 1); (3, 0); (3, -1);
  (3, -2); (-2, 3); (-2, 2); (-2, 1); (-2, 0); (-2, -1); (-2, -2); (-1, 3);
  (-1, 2); (-1, 1); (-1, 0); (-1, -1); (-1, -2); (-3, 3); (-3, 2); (-3, 1);
  (-3, 0); (-3, -1); (-3, -2); (-2, 3); (-2, 2); (-2, 1); (-2, 0); (-2, -1);
  (-2, -2); (3, 3); (3, 2); (-2, 3); (-2, 2); (-1, 3); (-1, 2); (-3, 3);
  (-3, 2); (-2, 3); (-2, 2):]
|}];;

[(a, c, f, j, o, s)
   for j = 2 downto -2 and o in [-2; 2; 2; 0; -3] and a in [0; -1; 3]
   for s in [] and f = j downto 1 and j = -2 downto -1 and c = 2 downto j
   when f < 0];;
[%%expect{|
- : (int * int * int * int * int * 'a) list = []
|}];;

[|(a, c, f, j, o, s)
    for j = 2 downto -2 and o in [|-2; 2; 2; 0; -3|] and a in [|0; -1; 3|]
    for s in [||] and f = j downto 1 and j = -2 downto -1 and c = 2 downto j
    when f < 0|];;
[%%expect{|
- : (int * int * int * int * int * '_weak19) array = [||]
|}];;

[:(a, c, f, j, o, s)
    for j = 2 downto -2 and o in [:-2; 2; 2; 0; -3:] and a in [:0; -1; 3:]
    for s in [::] and f = j downto 1 and j = -2 downto -1 and c = 2 downto j
    when f < 0:];;
[%%expect{|
- : (int * int * int * int * int * 'a) iarray = [::]
|}];;

[(h, m, o)
   for h in [0]
   when h > 0
   when abs h mod 2 = 1
   for m in [h; 1]
   for o = 1 to 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(h, m, o)
    for h in [|0|]
    when h > 0
    when abs h mod 2 = 1
    for m in [|h; 1|]
    for o = 1 to 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(h, m, o)
    for h in [:0:]
    when h > 0
    when abs h mod 2 = 1
    for m in [:h; 1:]
    for o = 1 to 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(o, s) for o = 2 to -3 for s in [1; -3; 3; o; 0]];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(o, s) for o = 2 to -3 for s in [|1; -3; 3; o; 0|]|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(o, s) for o = 2 to -3 for s in [:1; -3; 3; o; 0:]:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[a for a in [] when a < 0];;
[%%expect{|
- : int list = []
|}];;

[|a for a in [||] when a < 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:a for a in [::] when a < 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(d, g, i, n, o, p)
   for i in [-1; 3; -3; -1] and g in [3; -1; -2; -1; 1] and p = 0 to 3
   for d = -1 downto 2 and n = i downto 1 and o in [2; g] and i in [1; -2; 2]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(d, g, i, n, o, p)
    for i in [|-1; 3; -3; -1|]
    and g in [|3; -1; -2; -1; 1|]
    and p = 0 to 3
    for d = -1 downto 2
    and n = i downto 1
    and o in [|2; g|]
    and i in [|1; -2; 2|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(d, g, i, n, o, p)
    for i in [:-1; 3; -3; -1:]
    and g in [:3; -1; -2; -1; 1:]
    and p = 0 to 3
    for d = -1 downto 2
    and n = i downto 1
    and o in [:2; g:]
    and i in [:1; -2; 2:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(b, g, p, q, w)
   for _ = -1 downto -1 and p in [0; -3; -3]
   when p < 0
   for q in [-1; -1; 1]
   for w = 3 downto q and b in [p]
   for g = 1 downto 1];;
[%%expect{|
- : (int * int * int * int * int) list =
[(-3, 1, -3, -1, 3); (-3, 1, -3, -1, 2); (-3, 1, -3, -1, 1);
 (-3, 1, -3, -1, 0); (-3, 1, -3, -1, -1); (-3, 1, -3, -1, 3);
 (-3, 1, -3, -1, 2); (-3, 1, -3, -1, 1); (-3, 1, -3, -1, 0);
 (-3, 1, -3, -1, -1); (-3, 1, -3, 1, 3); (-3, 1, -3, 1, 2);
 (-3, 1, -3, 1, 1); (-3, 1, -3, -1, 3); (-3, 1, -3, -1, 2);
 (-3, 1, -3, -1, 1); (-3, 1, -3, -1, 0); (-3, 1, -3, -1, -1);
 (-3, 1, -3, -1, 3); (-3, 1, -3, -1, 2); (-3, 1, -3, -1, 1);
 (-3, 1, -3, -1, 0); (-3, 1, -3, -1, -1); (-3, 1, -3, 1, 3);
 (-3, 1, -3, 1, 2); (-3, 1, -3, 1, 1)]
|}];;

[|(b, g, p, q, w)
    for _ = -1 downto -1 and p in [|0; -3; -3|]
    when p < 0
    for q in [|-1; -1; 1|]
    for w = 3 downto q and b in [|p|]
    for g = 1 downto 1|];;
[%%expect{|
- : (int * int * int * int * int) array =
[|(-3, 1, -3, -1, 3); (-3, 1, -3, -1, 2); (-3, 1, -3, -1, 1);
  (-3, 1, -3, -1, 0); (-3, 1, -3, -1, -1); (-3, 1, -3, -1, 3);
  (-3, 1, -3, -1, 2); (-3, 1, -3, -1, 1); (-3, 1, -3, -1, 0);
  (-3, 1, -3, -1, -1); (-3, 1, -3, 1, 3); (-3, 1, -3, 1, 2);
  (-3, 1, -3, 1, 1); (-3, 1, -3, -1, 3); (-3, 1, -3, -1, 2);
  (-3, 1, -3, -1, 1); (-3, 1, -3, -1, 0); (-3, 1, -3, -1, -1);
  (-3, 1, -3, -1, 3); (-3, 1, -3, -1, 2); (-3, 1, -3, -1, 1);
  (-3, 1, -3, -1, 0); (-3, 1, -3, -1, -1); (-3, 1, -3, 1, 3);
  (-3, 1, -3, 1, 2); (-3, 1, -3, 1, 1)|]
|}];;

[:(b, g, p, q, w)
    for _ = -1 downto -1 and p in [:0; -3; -3:]
    when p < 0
    for q in [:-1; -1; 1:]
    for w = 3 downto q and b in [:p:]
    for g = 1 downto 1:];;
[%%expect{|
- : (int * int * int * int * int) iarray =
[:(-3, 1, -3, -1, 3); (-3, 1, -3, -1, 2); (-3, 1, -3, -1, 1);
  (-3, 1, -3, -1, 0); (-3, 1, -3, -1, -1); (-3, 1, -3, -1, 3);
  (-3, 1, -3, -1, 2); (-3, 1, -3, -1, 1); (-3, 1, -3, -1, 0);
  (-3, 1, -3, -1, -1); (-3, 1, -3, 1, 3); (-3, 1, -3, 1, 2);
  (-3, 1, -3, 1, 1); (-3, 1, -3, -1, 3); (-3, 1, -3, -1, 2);
  (-3, 1, -3, -1, 1); (-3, 1, -3, -1, 0); (-3, 1, -3, -1, -1);
  (-3, 1, -3, -1, 3); (-3, 1, -3, -1, 2); (-3, 1, -3, -1, 1);
  (-3, 1, -3, -1, 0); (-3, 1, -3, -1, -1); (-3, 1, -3, 1, 3);
  (-3, 1, -3, 1, 2); (-3, 1, -3, 1, 1):]
|}];;

[(i, p, v) for p = 2 to -2 for v = -3 downto 2 and i in [0; 2; 3; 0; -2; 0]];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, c, g, o, p, v)
    for o in [|-2; -2; -2; 2; 0; 0; 3|]
    for p = -3 downto -1 and _ in [|0; 1; o; 1; -2|] and g in [|2; -3; -3; 3|]
    for a in [|2; o; 1; 3|]
    for v = 3 downto 2 and c in [|2; 1; 1; 1|] and p in [|-1; 1; -2; -2|]|];;
[%%expect{|
Lines 1-5, characters 0-75:
1 | [|(a, c, g, o, p, v)
2 |     for o in [|-2; -2; -2; 2; 0; 0; 3|]
3 |     for p = -3 downto -1 and _ in [|0; 1; o; 1; -2|] and g in [|2; -3; -3; 3|]
4 |     for a in [|2; o; 1; 3|]
5 |     for v = 3 downto 2 and c in [|2; 1; 1; 1|] and p in [|-1; 1; -2; -2|]|]..
Warning 26 [unused-var]: unused variable p.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, c, g, o, p, v)
    for o in [:-2; -2; -2; 2; 0; 0; 3:]
    for p = -3 downto -1 and _ in [:0; 1; o; 1; -2:] and g in [:2; -3; -3; 3:]
    for a in [:2; o; 1; 3:]
    for v = 3 downto 2 and c in [:2; 1; 1; 1:] and p in [:-1; 1; -2; -2:]:];;
[%%expect{|
Lines 1-5, characters 0-75:
1 | [:(a, c, g, o, p, v)
2 |     for o in [:-2; -2; -2; 2; 0; 0; 3:]
3 |     for p = -3 downto -1 and _ in [:0; 1; o; 1; -2:] and g in [:2; -3; -3; 3:]
4 |     for a in [:2; o; 1; 3:]
5 |     for v = 3 downto 2 and c in [:2; 1; 1; 1:] and p in [:-1; 1; -2; -2:]:]..
Warning 26 [unused-var]: unused variable p.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(l, m, q)
   for l in [-3; 2; -2; 1; -2]
   when abs l mod 2 = 1
   for q in [] and m = l downto -3];;
[%%expect{|
- : (int * int * 'a) list = []
|}];;

[|(l, m, q)
    for l in [|-3; 2; -2; 1; -2|]
    when abs l mod 2 = 1
    for q in [||] and m = l downto -3|];;
[%%expect{|
- : (int * int * '_weak20) array = [||]
|}];;

[:(l, m, q)
    for l in [:-3; 2; -2; 1; -2:]
    when abs l mod 2 = 1
    for q in [::] and m = l downto -3:];;
[%%expect{|
- : (int * int * 'a) iarray = [::]
|}];;

[(b, e, g, h)
   for b in [-2; -1]
   and h in [1]
   and e in [3]
   and g in [1; 2; -3; 1; -2]
   and _ in [-1; 1; -2; 0; 2]];;
[%%expect{|
- : (int * int * int * int) list =
[(-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1);
 (-2, 3, 2, 1); (-2, 3, 2, 1); (-2, 3, 2, 1); (-2, 3, 2, 1); (-2, 3, 2, 1);
 (-2, 3, -3, 1); (-2, 3, -3, 1); (-2, 3, -3, 1); (-2, 3, -3, 1);
 (-2, 3, -3, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1);
 (-2, 3, 1, 1); (-2, 3, -2, 1); (-2, 3, -2, 1); (-2, 3, -2, 1);
 (-2, 3, -2, 1); (-2, 3, -2, 1); (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1);
 (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 2, 1); (-1, 3, 2, 1); (-1, 3, 2, 1);
 (-1, 3, 2, 1); (-1, 3, 2, 1); (-1, 3, -3, 1); (-1, 3, -3, 1);
 (-1, 3, -3, 1); (-1, 3, -3, 1); (-1, 3, -3, 1); (-1, 3, 1, 1);
 (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, -2, 1);
 (-1, 3, -2, 1); (-1, 3, -2, 1); (-1, 3, -2, 1); (-1, 3, -2, 1)]
|}];;

[|(b, e, g, h)
    for b in [|-2; -1|]
    and h in [|1|]
    and e in [|3|]
    and g in [|1; 2; -3; 1; -2|]
    and _ in [|-1; 1; -2; 0; 2|]|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1);
  (-2, 3, 2, 1); (-2, 3, 2, 1); (-2, 3, 2, 1); (-2, 3, 2, 1); (-2, 3, 2, 1);
  (-2, 3, -3, 1); (-2, 3, -3, 1); (-2, 3, -3, 1); (-2, 3, -3, 1);
  (-2, 3, -3, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1);
  (-2, 3, 1, 1); (-2, 3, -2, 1); (-2, 3, -2, 1); (-2, 3, -2, 1);
  (-2, 3, -2, 1); (-2, 3, -2, 1); (-1, 3, 1, 1); (-1, 3, 1, 1);
  (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 2, 1); (-1, 3, 2, 1);
  (-1, 3, 2, 1); (-1, 3, 2, 1); (-1, 3, 2, 1); (-1, 3, -3, 1);
  (-1, 3, -3, 1); (-1, 3, -3, 1); (-1, 3, -3, 1); (-1, 3, -3, 1);
  (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1);
  (-1, 3, -2, 1); (-1, 3, -2, 1); (-1, 3, -2, 1); (-1, 3, -2, 1);
  (-1, 3, -2, 1)|]
|}];;

[:(b, e, g, h)
    for b in [:-2; -1:]
    and h in [:1:]
    and e in [:3:]
    and g in [:1; 2; -3; 1; -2:]
    and _ in [:-1; 1; -2; 0; 2:]:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1);
  (-2, 3, 2, 1); (-2, 3, 2, 1); (-2, 3, 2, 1); (-2, 3, 2, 1); (-2, 3, 2, 1);
  (-2, 3, -3, 1); (-2, 3, -3, 1); (-2, 3, -3, 1); (-2, 3, -3, 1);
  (-2, 3, -3, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1); (-2, 3, 1, 1);
  (-2, 3, 1, 1); (-2, 3, -2, 1); (-2, 3, -2, 1); (-2, 3, -2, 1);
  (-2, 3, -2, 1); (-2, 3, -2, 1); (-1, 3, 1, 1); (-1, 3, 1, 1);
  (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 2, 1); (-1, 3, 2, 1);
  (-1, 3, 2, 1); (-1, 3, 2, 1); (-1, 3, 2, 1); (-1, 3, -3, 1);
  (-1, 3, -3, 1); (-1, 3, -3, 1); (-1, 3, -3, 1); (-1, 3, -3, 1);
  (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1); (-1, 3, 1, 1);
  (-1, 3, -2, 1); (-1, 3, -2, 1); (-1, 3, -2, 1); (-1, 3, -2, 1);
  (-1, 3, -2, 1):]
|}];;

[(a, q, r, u, z)
   for r in [2; 0; -2]
   for _ in [3; -1; 3] and a = -2 to -3 and u in [-1; 1; -3; 2; 1; 1; -3]
   for q = 2 to -3 and u = 3 to -1 and z in [0]];;
[%%expect{|
Line 3, characters 44-45:
3 |    for _ in [3; -1; 3] and a = -2 to -3 and u in [-1; 1; -3; 2; 1; 1; -3]
                                                ^
Warning 26 [unused-var]: unused variable u.

- : (int * int * int * int * int) list = []
|}];;

[|(a, q, r, u, z)
    for r in [|2; 0; -2|]
    for _ in [|3; -1; 3|] and a = -2 to -3 and u in [|-1; 1; -3; 2; 1; 1; -3|]
    for q = 2 to -3 and u = 3 to -1 and z in [|0|]|];;
[%%expect{|
Line 3, characters 47-48:
3 |     for _ in [|3; -1; 3|] and a = -2 to -3 and u in [|-1; 1; -3; 2; 1; 1; -3|]
                                                   ^
Warning 26 [unused-var]: unused variable u.

- : (int * int * int * int * int) array = [||]
|}];;

[:(a, q, r, u, z)
    for r in [:2; 0; -2:]
    for _ in [:3; -1; 3:] and a = -2 to -3 and u in [:-1; 1; -3; 2; 1; 1; -3:]
    for q = 2 to -3 and u = 3 to -1 and z in [:0:]:];;
[%%expect{|
Line 3, characters 47-48:
3 |     for _ in [:3; -1; 3:] and a = -2 to -3 and u in [:-1; 1; -3; 2; 1; 1; -3:]
                                                   ^
Warning 26 [unused-var]: unused variable u.

- : (int * int * int * int * int) iarray = [::]
|}];;

[(a, c, d, h, n, u, z)
   for u in [0; 3; -3; 1] and a in [1; -3] and h in [1; -2; 0; -3]
   for c = 1 to -2 and z = 0 to a
   for d in [0; a; -3; -1; -1]
   for n = 2 to 1];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(a, c, d, h, n, u, z)
    for u in [|0; 3; -3; 1|] and a in [|1; -3|] and h in [|1; -2; 0; -3|]
    for c = 1 to -2 and z = 0 to a
    for d in [|0; a; -3; -1; -1|]
    for n = 2 to 1|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, c, d, h, n, u, z)
    for u in [:0; 3; -3; 1:] and a in [:1; -3:] and h in [:1; -2; 0; -3:]
    for c = 1 to -2 and z = 0 to a
    for d in [:0; a; -3; -1; -1:]
    for n = 2 to 1:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(c, d, m, p, v)
   for v in [-3; -1; 0; 2; 2; 2; -3]
   for m = -2 to -3
   and p in [-1; 3; -2; -2]
   and d in [-1; 1; 1; v; 0]
   and c in [1]
   for _ in [-3; 3; -3; 0]
   and c in [1; -1; -1; d; 2; 1]];;
[%%expect{|
Line 6, characters 7-8:
6 |    and c in [1]
           ^
Warning 26 [unused-var]: unused variable c.

- : (int * int * int * int * int) list = []
|}];;

[|(c, d, m, p, v)
    for v in [|-3; -1; 0; 2; 2; 2; -3|]
    for m = -2 to -3
    and p in [|-1; 3; -2; -2|]
    and d in [|-1; 1; 1; v; 0|]
    and c in [|1|]
    for _ in [|-3; 3; -3; 0|]
    and c in [|1; -1; -1; d; 2; 1|]|];;
[%%expect{|
Line 6, characters 8-9:
6 |     and c in [|1|]
            ^
Warning 26 [unused-var]: unused variable c.

- : (int * int * int * int * int) array = [||]
|}];;

[:(c, d, m, p, v)
    for v in [:-3; -1; 0; 2; 2; 2; -3:]
    for m = -2 to -3
    and p in [:-1; 3; -2; -2:]
    and d in [:-1; 1; 1; v; 0:]
    and c in [:1:]
    for _ in [:-3; 3; -3; 0:]
    and c in [:1; -1; -1; d; 2; 1:]:];;
[%%expect{|
Line 6, characters 8-9:
6 |     and c in [:1:]
            ^
Warning 26 [unused-var]: unused variable c.

- : (int * int * int * int * int) iarray = [::]
|}];;

[d for d in [-1; 0; -2; 2; -3; 2] when d > 0];;
[%%expect{|
- : int list = [2; 2]
|}];;

[|d for d in [|-1; 0; -2; 2; -3; 2|] when d > 0|];;
[%%expect{|
- : int array = [|2; 2|]
|}];;

[:d for d in [:-1; 0; -2; 2; -3; 2:] when d > 0:];;
[%%expect{|
- : int iarray = [:2; 2:]
|}];;

[(l, p, t, x, z)
   for z = 1 to 2 and _ in [1]
   when abs z mod 2 = 1
   for t = 0 to 0 and l in []
   for x in [3; -3; -1; -2; -2; 0] and p in [2]
   when x <> 0];;
[%%expect{|
- : ('a * int * int * int * int) list = []
|}];;

[|(l, p, t, x, z)
    for z = 1 to 2 and _ in [|1|]
    when abs z mod 2 = 1
    for t = 0 to 0 and l in [||]
    for x in [|3; -3; -1; -2; -2; 0|] and p in [|2|]
    when x <> 0|];;
[%%expect{|
- : ('_weak21 * int * int * int * int) array = [||]
|}];;

[:(l, p, t, x, z)
    for z = 1 to 2 and _ in [:1:]
    when abs z mod 2 = 1
    for t = 0 to 0 and l in [::]
    for x in [:3; -3; -1; -2; -2; 0:] and p in [:2:]
    when x <> 0:];;
[%%expect{|
- : ('a * int * int * int * int) iarray = [::]
|}];;

[(f, h, l, m, u)
   for l in [-3; -2; 1; 1]
   for m = 2 downto -3
   for f = 2 to -3 and h in [-3; 1; 2; 0]
   when abs l mod 2 = 1
   for u in [-2; 1; -2]];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(f, h, l, m, u)
    for l in [|-3; -2; 1; 1|]
    for m = 2 downto -3
    for f = 2 to -3 and h in [|-3; 1; 2; 0|]
    when abs l mod 2 = 1
    for u in [|-2; 1; -2|]|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(f, h, l, m, u)
    for l in [:-3; -2; 1; 1:]
    for m = 2 downto -3
    for f = 2 to -3 and h in [:-3; 1; 2; 0:]
    when abs l mod 2 = 1
    for u in [:-2; 1; -2:]:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(e, o) for e = 0 to -2 when e < 0 for o = -2 downto 3];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(e, o) for e = 0 to -2 when e < 0 for o = -2 downto 3|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(e, o) for e = 0 to -2 when e < 0 for o = -2 downto 3:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[d
   for _ = 2 downto 2 and d = 3 downto -1
   for d = d to 0
   when d < 0
   for _ = -2 downto 0
   when d < 0];;
[%%expect{|
- : int list = []
|}];;

[|d
    for _ = 2 downto 2 and d = 3 downto -1
    for d = d to 0
    when d < 0
    for _ = -2 downto 0
    when d < 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:d
    for _ = 2 downto 2 and d = 3 downto -1
    for d = d to 0
    when d < 0
    for _ = -2 downto 0
    when d < 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(e, h, s, v, x, y)
   for x in [3; 1; -2; -1; -3; 2]
   for e = -3 downto 2
   for y = -2 downto 3 and s = 1 to 1
   when abs y mod 2 = 0
   for v in [-2; 1] and h in [-1; 3; e; 2]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(e, h, s, v, x, y)
    for x in [|3; 1; -2; -1; -3; 2|]
    for e = -3 downto 2
    for y = -2 downto 3 and s = 1 to 1
    when abs y mod 2 = 0
    for v in [|-2; 1|] and h in [|-1; 3; e; 2|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(e, h, s, v, x, y)
    for x in [:3; 1; -2; -1; -3; 2:]
    for e = -3 downto 2
    for y = -2 downto 3 and s = 1 to 1
    when abs y mod 2 = 0
    for v in [:-2; 1:] and h in [:-1; 3; e; 2:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(b, g, l, s, v, x)
   for s in [0; 0; 1] and v = 3 downto -2
   for l = -3 downto v and x in [3; -1; -3] and g in [s; -2]
   for b in [s; -3; 1]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(b, g, l, s, v, x)
    for s in [|0; 0; 1|] and v = 3 downto -2
    for l = -3 downto v and x in [|3; -1; -3|] and g in [|s; -2|]
    for b in [|s; -3; 1|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(b, g, l, s, v, x)
    for s in [:0; 0; 1:] and v = 3 downto -2
    for l = -3 downto v and x in [:3; -1; -3:] and g in [:s; -2:]
    for b in [:s; -3; 1:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(d, e, g, q, s, t)
   for q = -2 to 3
   for s in []
   for e in [-2; 2; 0; 0; 1; -3] and d in []
   for t = -1 downto -2 and g in [1; -3; 0; -1; -2]];;
[%%expect{|
- : ('a * int * int * int * 'b * int) list = []
|}];;

[|(d, e, g, q, s, t)
    for q = -2 to 3
    for s in [||]
    for e in [|-2; 2; 0; 0; 1; -3|] and d in [||]
    for t = -1 downto -2 and g in [|1; -3; 0; -1; -2|]|];;
[%%expect{|
- : ('_weak22 * int * int * int * '_weak23 * int) array = [||]
|}];;

[:(d, e, g, q, s, t)
    for q = -2 to 3
    for s in [::]
    for e in [:-2; 2; 0; 0; 1; -3:] and d in [::]
    for t = -1 downto -2 and g in [:1; -3; 0; -1; -2:]:];;
[%%expect{|
- : ('a * int * int * int * 'b * int) iarray = [::]
|}];;

[(c, e, f, n)
   for f in [0; 0] and e in [-2; 2; -1; 0; 0]
   for c in [] and n = e to -2
   for f in [3; 1; 3]
   when abs n mod 2 = 1];;
[%%expect{|
Line 2, characters 7-8:
2 |    for f in [0; 0] and e in [-2; 2; -1; 0; 0]
           ^
Warning 26 [unused-var]: unused variable f.

- : ('a * int * int * int) list = []
|}];;

[|(c, e, f, n)
    for f in [|0; 0|] and e in [|-2; 2; -1; 0; 0|]
    for c in [||] and n = e to -2
    for f in [|3; 1; 3|]
    when abs n mod 2 = 1|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for f in [|0; 0|] and e in [|-2; 2; -1; 0; 0|]
            ^
Warning 26 [unused-var]: unused variable f.

- : ('_weak24 * int * int * int) array = [||]
|}];;

[:(c, e, f, n)
    for f in [:0; 0:] and e in [:-2; 2; -1; 0; 0:]
    for c in [::] and n = e to -2
    for f in [:3; 1; 3:]
    when abs n mod 2 = 1:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for f in [:0; 0:] and e in [:-2; 2; -1; 0; 0:]
            ^
Warning 26 [unused-var]: unused variable f.

- : ('a * int * int * int) iarray = [::]
|}];;

[(d, g, m, n, o, r)
   for d in [3; 3; 0; -2; -3; 3] and n in [1; 3; 3; 2; -2] and m in [2; 1; 1]
   for r in [0; -2; 2; -2; 0]
   for g = -2 downto 1 and o in [3; 3; r; 3; 0]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(d, g, m, n, o, r)
    for d in [|3; 3; 0; -2; -3; 3|]
    and n in [|1; 3; 3; 2; -2|]
    and m in [|2; 1; 1|]
    for r in [|0; -2; 2; -2; 0|]
    for g = -2 downto 1
    and o in [|3; 3; r; 3; 0|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(d, g, m, n, o, r)
    for d in [:3; 3; 0; -2; -3; 3:]
    and n in [:1; 3; 3; 2; -2:]
    and m in [:2; 1; 1:]
    for r in [:0; -2; 2; -2; 0:]
    for g = -2 downto 1
    and o in [:3; 3; r; 3; 0:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[c for c = -3 to -2 when c > 0];;
[%%expect{|
- : int list = []
|}];;

[|c for c = -3 to -2 when c > 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:c for c = -3 to -2 when c > 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(a, b, e, k)
   for k = 2 downto -2 and b in [-1]
   when abs k mod 2 = 0
   for e = 0 to 0
   when k <> 0
   for a in [2; 3]];;
[%%expect{|
- : (int * int * int * int) list =
[(2, -1, 0, 2); (3, -1, 0, 2); (2, -1, 0, -2); (3, -1, 0, -2)]
|}];;

[|(a, b, e, k)
    for k = 2 downto -2 and b in [|-1|]
    when abs k mod 2 = 0
    for e = 0 to 0
    when k <> 0
    for a in [|2; 3|]|];;
[%%expect{|
- : (int * int * int * int) array =
[|(2, -1, 0, 2); (3, -1, 0, 2); (2, -1, 0, -2); (3, -1, 0, -2)|]
|}];;

[:(a, b, e, k)
    for k = 2 downto -2 and b in [:-1:]
    when abs k mod 2 = 0
    for e = 0 to 0
    when k <> 0
    for a in [:2; 3:]:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(2, -1, 0, 2); (3, -1, 0, 2); (2, -1, 0, -2); (3, -1, 0, -2):]
|}];;

[(e, i, x)
   for x in [0; 0; 3; 0; 1; -3] and i in [3; 1; 0; -2; -1; 0; 3]
   for e in [3]
   when e < 0
   when x < 0
   for i = 3 to -2];;
[%%expect{|
Line 2, characters 36-37:
2 |    for x in [0; 0; 3; 0; 1; -3] and i in [3; 1; 0; -2; -1; 0; 3]
                                        ^
Warning 26 [unused-var]: unused variable i.

- : (int * int * int) list = []
|}];;

[|(e, i, x)
    for x in [|0; 0; 3; 0; 1; -3|] and i in [|3; 1; 0; -2; -1; 0; 3|]
    for e in [|3|]
    when e < 0
    when x < 0
    for i = 3 to -2|];;
[%%expect{|
Line 2, characters 39-40:
2 |     for x in [|0; 0; 3; 0; 1; -3|] and i in [|3; 1; 0; -2; -1; 0; 3|]
                                           ^
Warning 26 [unused-var]: unused variable i.

- : (int * int * int) array = [||]
|}];;

[:(e, i, x)
    for x in [:0; 0; 3; 0; 1; -3:] and i in [:3; 1; 0; -2; -1; 0; 3:]
    for e in [:3:]
    when e < 0
    when x < 0
    for i = 3 to -2:];;
[%%expect{|
Line 2, characters 39-40:
2 |     for x in [:0; 0; 3; 0; 1; -3:] and i in [:3; 1; 0; -2; -1; 0; 3:]
                                           ^
Warning 26 [unused-var]: unused variable i.

- : (int * int * int) iarray = [::]
|}];;

[(a, k, p, z)
   for z = 0 downto 0 and _ = -3 to -3
   when abs z mod 2 = 1
   for k = z downto 1 and p = 1 to 2
   for z = k to z
   for a = 1 to 1];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(a, k, p, z)
    for z = 0 downto 0 and _ = -3 to -3
    when abs z mod 2 = 1
    for k = z downto 1 and p = 1 to 2
    for z = k to z
    for a = 1 to 1|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(a, k, p, z)
    for z = 0 downto 0 and _ = -3 to -3
    when abs z mod 2 = 1
    for k = z downto 1 and p = 1 to 2
    for z = k to z
    for a = 1 to 1:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(b, e, q, u)
   for e = -3 to 3
   for b = -3 downto -3 and q in [2; -1; 1; -1; -2] and u in [-3; 0; 2]
   when b <> 0
   when u < 0];;
[%%expect{|
- : (int * int * int * int) list =
[(-3, -3, 2, -3); (-3, -3, -1, -3); (-3, -3, 1, -3); (-3, -3, -1, -3);
 (-3, -3, -2, -3); (-3, -2, 2, -3); (-3, -2, -1, -3); (-3, -2, 1, -3);
 (-3, -2, -1, -3); (-3, -2, -2, -3); (-3, -1, 2, -3); (-3, -1, -1, -3);
 (-3, -1, 1, -3); (-3, -1, -1, -3); (-3, -1, -2, -3); (-3, 0, 2, -3);
 (-3, 0, -1, -3); (-3, 0, 1, -3); (-3, 0, -1, -3); (-3, 0, -2, -3);
 (-3, 1, 2, -3); (-3, 1, -1, -3); (-3, 1, 1, -3); (-3, 1, -1, -3);
 (-3, 1, -2, -3); (-3, 2, 2, -3); (-3, 2, -1, -3); (-3, 2, 1, -3);
 (-3, 2, -1, -3); (-3, 2, -2, -3); (-3, 3, 2, -3); (-3, 3, -1, -3);
 (-3, 3, 1, -3); (-3, 3, -1, -3); (-3, 3, -2, -3)]
|}];;

[|(b, e, q, u)
    for e = -3 to 3
    for b = -3 downto -3 and q in [|2; -1; 1; -1; -2|] and u in [|-3; 0; 2|]
    when b <> 0
    when u < 0|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-3, -3, 2, -3); (-3, -3, -1, -3); (-3, -3, 1, -3); (-3, -3, -1, -3);
  (-3, -3, -2, -3); (-3, -2, 2, -3); (-3, -2, -1, -3); (-3, -2, 1, -3);
  (-3, -2, -1, -3); (-3, -2, -2, -3); (-3, -1, 2, -3); (-3, -1, -1, -3);
  (-3, -1, 1, -3); (-3, -1, -1, -3); (-3, -1, -2, -3); (-3, 0, 2, -3);
  (-3, 0, -1, -3); (-3, 0, 1, -3); (-3, 0, -1, -3); (-3, 0, -2, -3);
  (-3, 1, 2, -3); (-3, 1, -1, -3); (-3, 1, 1, -3); (-3, 1, -1, -3);
  (-3, 1, -2, -3); (-3, 2, 2, -3); (-3, 2, -1, -3); (-3, 2, 1, -3);
  (-3, 2, -1, -3); (-3, 2, -2, -3); (-3, 3, 2, -3); (-3, 3, -1, -3);
  (-3, 3, 1, -3); (-3, 3, -1, -3); (-3, 3, -2, -3)|]
|}];;

[:(b, e, q, u)
    for e = -3 to 3
    for b = -3 downto -3 and q in [:2; -1; 1; -1; -2:] and u in [:-3; 0; 2:]
    when b <> 0
    when u < 0:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-3, -3, 2, -3); (-3, -3, -1, -3); (-3, -3, 1, -3); (-3, -3, -1, -3);
  (-3, -3, -2, -3); (-3, -2, 2, -3); (-3, -2, -1, -3); (-3, -2, 1, -3);
  (-3, -2, -1, -3); (-3, -2, -2, -3); (-3, -1, 2, -3); (-3, -1, -1, -3);
  (-3, -1, 1, -3); (-3, -1, -1, -3); (-3, -1, -2, -3); (-3, 0, 2, -3);
  (-3, 0, -1, -3); (-3, 0, 1, -3); (-3, 0, -1, -3); (-3, 0, -2, -3);
  (-3, 1, 2, -3); (-3, 1, -1, -3); (-3, 1, 1, -3); (-3, 1, -1, -3);
  (-3, 1, -2, -3); (-3, 2, 2, -3); (-3, 2, -1, -3); (-3, 2, 1, -3);
  (-3, 2, -1, -3); (-3, 2, -2, -3); (-3, 3, 2, -3); (-3, 3, -1, -3);
  (-3, 3, 1, -3); (-3, 3, -1, -3); (-3, 3, -2, -3):]
|}];;

[(a, d, e, j, n, p, s, v, y, z)
   for e in [2] and s in [-1] and v in [1; -2; 2; -1; 0; 0; 1]
   for p = -1 to -1 and a = e to 1 and y = 0 to 2
   for j in [-2; -1; -1; -3; p]
   for z = 3 downto 2 and d = y downto -3 and n = 1 to 1];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int * int) list = []
|}];;

[|(a, d, e, j, n, p, s, v, y, z)
    for e in [|2|] and s in [|-1|] and v in [|1; -2; 2; -1; 0; 0; 1|]
    for p = -1 to -1 and a = e to 1 and y = 0 to 2
    for j in [|-2; -1; -1; -3; p|]
    for z = 3 downto 2 and d = y downto -3 and n = 1 to 1|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, d, e, j, n, p, s, v, y, z)
    for e in [:2:] and s in [:-1:] and v in [:1; -2; 2; -1; 0; 0; 1:]
    for p = -1 to -1 and a = e to 1 and y = 0 to 2
    for j in [:-2; -1; -1; -3; p:]
    for z = 3 downto 2 and d = y downto -3 and n = 1 to 1:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[i for i = 3 downto 1 when i < 0];;
[%%expect{|
- : int list = []
|}];;

[|i for i = 3 downto 1 when i < 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:i for i = 3 downto 1 when i < 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(f, l, m, s)
   for s = -1 downto -1
   for f in [s; 1; -2; 2; 2] and l = 2 downto -1
   when abs s mod 2 = 1
   when l > 0
   for m = -1 to 0];;
[%%expect{|
- : (int * int * int * int) list =
[(-1, 2, -1, -1); (-1, 2, 0, -1); (-1, 1, -1, -1); (-1, 1, 0, -1);
 (1, 2, -1, -1); (1, 2, 0, -1); (1, 1, -1, -1); (1, 1, 0, -1);
 (-2, 2, -1, -1); (-2, 2, 0, -1); (-2, 1, -1, -1); (-2, 1, 0, -1);
 (2, 2, -1, -1); (2, 2, 0, -1); (2, 1, -1, -1); (2, 1, 0, -1);
 (2, 2, -1, -1); (2, 2, 0, -1); (2, 1, -1, -1); (2, 1, 0, -1)]
|}];;

[|(f, l, m, s)
    for s = -1 downto -1
    for f in [|s; 1; -2; 2; 2|] and l = 2 downto -1
    when abs s mod 2 = 1
    when l > 0
    for m = -1 to 0|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-1, 2, -1, -1); (-1, 2, 0, -1); (-1, 1, -1, -1); (-1, 1, 0, -1);
  (1, 2, -1, -1); (1, 2, 0, -1); (1, 1, -1, -1); (1, 1, 0, -1);
  (-2, 2, -1, -1); (-2, 2, 0, -1); (-2, 1, -1, -1); (-2, 1, 0, -1);
  (2, 2, -1, -1); (2, 2, 0, -1); (2, 1, -1, -1); (2, 1, 0, -1);
  (2, 2, -1, -1); (2, 2, 0, -1); (2, 1, -1, -1); (2, 1, 0, -1)|]
|}];;

[:(f, l, m, s)
    for s = -1 downto -1
    for f in [:s; 1; -2; 2; 2:] and l = 2 downto -1
    when abs s mod 2 = 1
    when l > 0
    for m = -1 to 0:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-1, 2, -1, -1); (-1, 2, 0, -1); (-1, 1, -1, -1); (-1, 1, 0, -1);
  (1, 2, -1, -1); (1, 2, 0, -1); (1, 1, -1, -1); (1, 1, 0, -1);
  (-2, 2, -1, -1); (-2, 2, 0, -1); (-2, 1, -1, -1); (-2, 1, 0, -1);
  (2, 2, -1, -1); (2, 2, 0, -1); (2, 1, -1, -1); (2, 1, 0, -1);
  (2, 2, -1, -1); (2, 2, 0, -1); (2, 1, -1, -1); (2, 1, 0, -1):]
|}];;

[(e, j, o, p, q, t, v, x, y)
   for j in [0; 0; 2; -3; 2] and q = -3 to -3
   for q in [2; -1] and e in [-1; 2; -2] and y in [1; q]
   for y in [] and x = 2 to 0 and o in [-1]
   for p in [-2; y; -3; -1; 1; -3] and v in [3; -3] and t = 2 downto -1];;
[%%expect{|
Line 3, characters 45-46:
3 |    for q in [2; -1] and e in [-1; 2; -2] and y in [1; q]
                                                 ^
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int * int * int * int) list = []
|}];;

[|(e, j, o, p, q, t, v, x, y)
    for j in [|0; 0; 2; -3; 2|] and q = -3 to -3
    for q in [|2; -1|] and e in [|-1; 2; -2|] and y in [|1; q|]
    for y in [||] and x = 2 to 0 and o in [|-1|]
    for p in [|-2; y; -3; -1; 1; -3|] and v in [|3; -3|] and t = 2 downto -1|];;
[%%expect{|
Line 3, characters 50-51:
3 |     for q in [|2; -1|] and e in [|-1; 2; -2|] and y in [|1; q|]
                                                      ^
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(e, j, o, p, q, t, v, x, y)
    for j in [:0; 0; 2; -3; 2:] and q = -3 to -3
    for q in [:2; -1:] and e in [:-1; 2; -2:] and y in [:1; q:]
    for y in [::] and x = 2 to 0 and o in [:-1:]
    for p in [:-2; y; -3; -1; 1; -3:] and v in [:3; -3:] and t = 2 downto -1:];;
[%%expect{|
Line 3, characters 50-51:
3 |     for q in [:2; -1:] and e in [:-1; 2; -2:] and y in [:1; q:]
                                                      ^
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(d, e, i, j, s, u, w)
   for w in [-1; 3; -2]
   for i in [-1; 3; -3; 3] and s in [3; -1; -3; -3; 2; 2; 0]
   for u = 3 downto 3 and d in [3; 3; 0; 3; 3; 0; -2]
   for e in [-3; 0; 2; 2; 1] and j = -1 to -2
   when s < 0];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(d, e, i, j, s, u, w)
    for w in [|-1; 3; -2|]
    for i in [|-1; 3; -3; 3|] and s in [|3; -1; -3; -3; 2; 2; 0|]
    for u = 3 downto 3 and d in [|3; 3; 0; 3; 3; 0; -2|]
    for e in [|-3; 0; 2; 2; 1|] and j = -1 to -2
    when s < 0|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(d, e, i, j, s, u, w)
    for w in [:-1; 3; -2:]
    for i in [:-1; 3; -3; 3:] and s in [:3; -1; -3; -3; 2; 2; 0:]
    for u = 3 downto 3 and d in [:3; 3; 0; 3; 3; 0; -2:]
    for e in [:-3; 0; 2; 2; 1:] and j = -1 to -2
    when s < 0:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(a, b) for b in [-1] and a in [0; 1; -3; 1; -3; 1; 1] when b <> 0];;
[%%expect{|
- : (int * int) list =
[(0, -1); (1, -1); (-3, -1); (1, -1); (-3, -1); (1, -1); (1, -1)]
|}];;

[|(a, b) for b in [|-1|] and a in [|0; 1; -3; 1; -3; 1; 1|] when b <> 0|];;
[%%expect{|
- : (int * int) array =
[|(0, -1); (1, -1); (-3, -1); (1, -1); (-3, -1); (1, -1); (1, -1)|]
|}];;

[:(a, b) for b in [:-1:] and a in [:0; 1; -3; 1; -3; 1; 1:] when b <> 0:];;
[%%expect{|
- : (int * int) iarray =
[:(0, -1); (1, -1); (-3, -1); (1, -1); (-3, -1); (1, -1); (1, -1):]
|}];;

[(b, e, o, x, z)
   for o in [0; -2]
   for e in [3; 2; 0] and z = 0 to -2 and x = -3 to 1 and b = -1 downto 1];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(b, e, o, x, z)
    for o in [|0; -2|]
    for e in [|3; 2; 0|] and z = 0 to -2 and x = -3 to 1 and b = -1 downto 1|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(b, e, o, x, z)
    for o in [:0; -2:]
    for e in [:3; 2; 0:] and z = 0 to -2 and x = -3 to 1 and b = -1 downto 1:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(f, s, z)
   for _ = 2 downto 2
   and z in [-3; 1; -1; 3; 1; 2; -2]
   and f = -3 to -1
   and _ in [-3; 2]
   and s = 0 to 0];;
[%%expect{|
- : (int * int * int) list =
[(-3, 0, -3); (-3, 0, -3); (-2, 0, -3); (-2, 0, -3); (-1, 0, -3);
 (-1, 0, -3); (-3, 0, 1); (-3, 0, 1); (-2, 0, 1); (-2, 0, 1); (-1, 0, 1);
 (-1, 0, 1); (-3, 0, -1); (-3, 0, -1); (-2, 0, -1); (-2, 0, -1); (-1, 0, -1);
 (-1, 0, -1); (-3, 0, 3); (-3, 0, 3); (-2, 0, 3); (-2, 0, 3); (-1, 0, 3);
 (-1, 0, 3); (-3, 0, 1); (-3, 0, 1); (-2, 0, 1); (-2, 0, 1); (-1, 0, 1);
 (-1, 0, 1); (-3, 0, 2); (-3, 0, 2); (-2, 0, 2); (-2, 0, 2); (-1, 0, 2);
 (-1, 0, 2); (-3, 0, -2); (-3, 0, -2); (-2, 0, -2); (-2, 0, -2); (-1, 0, -2);
 (-1, 0, -2)]
|}];;

[|(f, s, z)
    for _ = 2 downto 2
    and z in [|-3; 1; -1; 3; 1; 2; -2|]
    and f = -3 to -1
    and _ in [|-3; 2|]
    and s = 0 to 0|];;
[%%expect{|
- : (int * int * int) array =
[|(-3, 0, -3); (-3, 0, -3); (-2, 0, -3); (-2, 0, -3); (-1, 0, -3);
  (-1, 0, -3); (-3, 0, 1); (-3, 0, 1); (-2, 0, 1); (-2, 0, 1); (-1, 0, 1);
  (-1, 0, 1); (-3, 0, -1); (-3, 0, -1); (-2, 0, -1); (-2, 0, -1);
  (-1, 0, -1); (-1, 0, -1); (-3, 0, 3); (-3, 0, 3); (-2, 0, 3); (-2, 0, 3);
  (-1, 0, 3); (-1, 0, 3); (-3, 0, 1); (-3, 0, 1); (-2, 0, 1); (-2, 0, 1);
  (-1, 0, 1); (-1, 0, 1); (-3, 0, 2); (-3, 0, 2); (-2, 0, 2); (-2, 0, 2);
  (-1, 0, 2); (-1, 0, 2); (-3, 0, -2); (-3, 0, -2); (-2, 0, -2); (-2, 0, -2);
  (-1, 0, -2); (-1, 0, -2)|]
|}];;

[:(f, s, z)
    for _ = 2 downto 2
    and z in [:-3; 1; -1; 3; 1; 2; -2:]
    and f = -3 to -1
    and _ in [:-3; 2:]
    and s = 0 to 0:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-3, 0, -3); (-3, 0, -3); (-2, 0, -3); (-2, 0, -3); (-1, 0, -3);
  (-1, 0, -3); (-3, 0, 1); (-3, 0, 1); (-2, 0, 1); (-2, 0, 1); (-1, 0, 1);
  (-1, 0, 1); (-3, 0, -1); (-3, 0, -1); (-2, 0, -1); (-2, 0, -1);
  (-1, 0, -1); (-1, 0, -1); (-3, 0, 3); (-3, 0, 3); (-2, 0, 3); (-2, 0, 3);
  (-1, 0, 3); (-1, 0, 3); (-3, 0, 1); (-3, 0, 1); (-2, 0, 1); (-2, 0, 1);
  (-1, 0, 1); (-1, 0, 1); (-3, 0, 2); (-3, 0, 2); (-2, 0, 2); (-2, 0, 2);
  (-1, 0, 2); (-1, 0, 2); (-3, 0, -2); (-3, 0, -2); (-2, 0, -2); (-2, 0, -2);
  (-1, 0, -2); (-1, 0, -2):]
|}];;

[(e, q)
   for q in [1; -2; 2; 0; -2; 1; -3]
   when abs q mod 2 = 0
   for e = -3 downto 0
   when e < 0];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(e, q)
    for q in [|1; -2; 2; 0; -2; 1; -3|]
    when abs q mod 2 = 0
    for e = -3 downto 0
    when e < 0|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(e, q)
    for q in [:1; -2; 2; 0; -2; 1; -3:]
    when abs q mod 2 = 0
    for e = -3 downto 0
    when e < 0:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(p, t) for p in [-2; 3; 2; 1; 0; -3; 1] and t in [3; 3; -3; -2; 2; 1; -3]];;
[%%expect{|
- : (int * int) list =
[(-2, 3); (-2, 3); (-2, -3); (-2, -2); (-2, 2); (-2, 1); (-2, -3); (3, 3);
 (3, 3); (3, -3); (3, -2); (3, 2); (3, 1); (3, -3); (2, 3); (2, 3); (2, -3);
 (2, -2); (2, 2); (2, 1); (2, -3); (1, 3); (1, 3); (1, -3); (1, -2);
 (1, 2); (1, 1); (1, -3); (0, 3); (0, 3); (0, -3); (0, -2); (0, 2); (0, 1);
 (0, -3); (-3, 3); (-3, 3); (-3, -3); (-3, -2); (-3, 2); (-3, 1); (-3, -3);
 (1, 3); (1, 3); (1, -3); (1, -2); (1, 2); (1, 1); (1, -3)]
|}];;

[|(p, t)
    for p in [|-2; 3; 2; 1; 0; -3; 1|] and t in [|3; 3; -3; -2; 2; 1; -3|]|];;
[%%expect{|
- : (int * int) array =
[|(-2, 3); (-2, 3); (-2, -3); (-2, -2); (-2, 2); (-2, 1); (-2, -3); (3, 3);
  (3, 3); (3, -3); (3, -2); (3, 2); (3, 1); (3, -3); (2, 3); (2, 3);
  (2, -3); (2, -2); (2, 2); (2, 1); (2, -3); (1, 3); (1, 3); (1, -3);
  (1, -2); (1, 2); (1, 1); (1, -3); (0, 3); (0, 3); (0, -3); (0, -2);
  (0, 2); (0, 1); (0, -3); (-3, 3); (-3, 3); (-3, -3); (-3, -2); (-3, 2);
  (-3, 1); (-3, -3); (1, 3); (1, 3); (1, -3); (1, -2); (1, 2); (1, 1);
  (1, -3)|]
|}];;

[:(p, t)
    for p in [:-2; 3; 2; 1; 0; -3; 1:] and t in [:3; 3; -3; -2; 2; 1; -3:]:];;
[%%expect{|
- : (int * int) iarray =
[:(-2, 3); (-2, 3); (-2, -3); (-2, -2); (-2, 2); (-2, 1); (-2, -3); (3, 3);
  (3, 3); (3, -3); (3, -2); (3, 2); (3, 1); (3, -3); (2, 3); (2, 3);
  (2, -3); (2, -2); (2, 2); (2, 1); (2, -3); (1, 3); (1, 3); (1, -3);
  (1, -2); (1, 2); (1, 1); (1, -3); (0, 3); (0, 3); (0, -3); (0, -2);
  (0, 2); (0, 1); (0, -3); (-3, 3); (-3, 3); (-3, -3); (-3, -2); (-3, 2);
  (-3, 1); (-3, -3); (1, 3); (1, 3); (1, -3); (1, -2); (1, 2); (1, 1);
  (1, -3):]
|}];;

[(a, e, h, j, m, n)
   for m in [0; 1; -3; 2; 1] and e = 0 downto -1
   for h = 0 to -3 and a in [1; 0; 0; 3; 2]
   for n = -1 to -3 and e in [1; -3; -1; -3] and j = 2 downto -2];;
[%%expect{|
Lines 1-4, characters 0-65:
1 | [(a, e, h, j, m, n)
2 |    for m in [0; 1; -3; 2; 1] and e = 0 downto -1
3 |    for h = 0 to -3 and a in [1; 0; 0; 3; 2]
4 |    for n = -1 to -3 and e in [1; -3; -1; -3] and j = 2 downto -2]..
Warning 26 [unused-var]: unused variable e.

- : (int * int * int * int * int * int) list = []
|}];;

[|(a, e, h, j, m, n)
    for m in [|0; 1; -3; 2; 1|] and e = 0 downto -1
    for h = 0 to -3 and a in [|1; 0; 0; 3; 2|]
    for n = -1 to -3 and e in [|1; -3; -1; -3|] and j = 2 downto -2|];;
[%%expect{|
Lines 1-4, characters 0-69:
1 | [|(a, e, h, j, m, n)
2 |     for m in [|0; 1; -3; 2; 1|] and e = 0 downto -1
3 |     for h = 0 to -3 and a in [|1; 0; 0; 3; 2|]
4 |     for n = -1 to -3 and e in [|1; -3; -1; -3|] and j = 2 downto -2|]..
Warning 26 [unused-var]: unused variable e.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, e, h, j, m, n)
    for m in [:0; 1; -3; 2; 1:] and e = 0 downto -1
    for h = 0 to -3 and a in [:1; 0; 0; 3; 2:]
    for n = -1 to -3 and e in [:1; -3; -1; -3:] and j = 2 downto -2:];;
[%%expect{|
Lines 1-4, characters 0-69:
1 | [:(a, e, h, j, m, n)
2 |     for m in [:0; 1; -3; 2; 1:] and e = 0 downto -1
3 |     for h = 0 to -3 and a in [:1; 0; 0; 3; 2:]
4 |     for n = -1 to -3 and e in [:1; -3; -1; -3:] and j = 2 downto -2:]..
Warning 26 [unused-var]: unused variable e.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(f, m, q, r, x)
   for m = -3 to 0 and r = -3 to 2 and f = -3 to -3
   for x = 2 to 1 and q = 0 downto 3
   when abs x mod 2 = 1
   when abs x mod 2 = 0];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(f, m, q, r, x)
    for m = -3 to 0 and r = -3 to 2 and f = -3 to -3
    for x = 2 to 1 and q = 0 downto 3
    when abs x mod 2 = 1
    when abs x mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(f, m, q, r, x)
    for m = -3 to 0 and r = -3 to 2 and f = -3 to -3
    for x = 2 to 1 and q = 0 downto 3
    when abs x mod 2 = 1
    when abs x mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(x, z) for _ = 2 downto 0 and _ = -2 downto 3 and x = 3 to -3 for z = 1 to 3];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(b, v) for v in [|2; 3; 3; 0; -3; -2|] and b in [|2; -1; 2; 2; 0; 2; 0|]|];;
[%%expect{|
- : (int * int) array =
[|(2, 2); (-1, 2); (2, 2); (2, 2); (0, 2); (2, 2); (0, 2); (2, 3); (-1, 3);
  (2, 3); (2, 3); (0, 3); (2, 3); (0, 3); (2, 3); (-1, 3); (2, 3); (2, 3);
  (0, 3); (2, 3); (0, 3); (2, 0); (-1, 0); (2, 0); (2, 0); (0, 0); (2, 0);
  (0, 0); (2, -3); (-1, -3); (2, -3); (2, -3); (0, -3); (2, -3); (0, -3);
  (2, -2); (-1, -2); (2, -2); (2, -2); (0, -2); (2, -2); (0, -2)|]
|}];;

[:(b, v) for v in [:2; 3; 3; 0; -3; -2:] and b in [:2; -1; 2; 2; 0; 2; 0:]:];;
[%%expect{|
- : (int * int) iarray =
[:(2, 2); (-1, 2); (2, 2); (2, 2); (0, 2); (2, 2); (0, 2); (2, 3); (-1, 3);
  (2, 3); (2, 3); (0, 3); (2, 3); (0, 3); (2, 3); (-1, 3); (2, 3); (2, 3);
  (0, 3); (2, 3); (0, 3); (2, 0); (-1, 0); (2, 0); (2, 0); (0, 0); (2, 0);
  (0, 0); (2, -3); (-1, -3); (2, -3); (2, -3); (0, -3); (2, -3); (0, -3);
  (2, -2); (-1, -2); (2, -2); (2, -2); (0, -2); (2, -2); (0, -2):]
|}];;

[(a, b, e, p)
   for p = 1 downto -1
   for _ = -3 downto 1
   when p < 0
   for a in [2] and e in [-1; 2]
   for b = -3 downto 3];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(a, b, e, p)
    for p = 1 downto -1
    for _ = -3 downto 1
    when p < 0
    for a in [|2|] and e in [|-1; 2|]
    for b = -3 downto 3|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(a, b, e, p)
    for p = 1 downto -1
    for _ = -3 downto 1
    when p < 0
    for a in [:2:] and e in [:-1; 2:]
    for b = -3 downto 3:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(f, r, t, u, y)
   for y = 2 downto -2
   for t in [-1; 1; -2]
   for u = -1 downto -1
   for r = 2 to 0 and f = 3 to -2
   when abs r mod 2 = 1];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(f, r, t, u, y)
    for y = 2 downto -2
    for t in [|-1; 1; -2|]
    for u = -1 downto -1
    for r = 2 to 0 and f = 3 to -2
    when abs r mod 2 = 1|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(f, r, t, u, y)
    for y = 2 downto -2
    for t in [:-1; 1; -2:]
    for u = -1 downto -1
    for r = 2 to 0 and f = 3 to -2
    when abs r mod 2 = 1:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(e, o, s)
   for o in [1; -3; 3]
   for s in [-1; -3]
   for e = 0 to 1
   when abs e mod 2 = 0];;
[%%expect{|
- : (int * int * int) list =
[(0, 1, -1); (0, 1, -3); (0, -3, -1); (0, -3, -3); (0, 3, -1); (0, 3, -3)]
|}];;

[|(e, o, s)
    for o in [|1; -3; 3|]
    for s in [|-1; -3|]
    for e = 0 to 1
    when abs e mod 2 = 0|];;
[%%expect{|
- : (int * int * int) array =
[|(0, 1, -1); (0, 1, -3); (0, -3, -1); (0, -3, -3); (0, 3, -1); (0, 3, -3)|]
|}];;

[:(e, o, s)
    for o in [:1; -3; 3:]
    for s in [:-1; -3:]
    for e = 0 to 1
    when abs e mod 2 = 0:];;
[%%expect{|
- : (int * int * int) iarray =
[:(0, 1, -1); (0, 1, -3); (0, -3, -1); (0, -3, -3); (0, 3, -1); (0, 3, -3):]
|}];;

[(f, h, j, q, s, v, w)
   for h in [0; 3; -1; 3; 0; 3; 0]
   and v in [1]
   for j = 0 to -3
   and q in [-3; -1; 2; -3; 3; h; -2]
   and f in [v; 1; -2; 0]
   and w in [3; 1; 2; 2; -1; 1; 1]
   for s in [-3]];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(f, h, j, q, s, v, w)
    for h in [|0; 3; -1; 3; 0; 3; 0|]
    and v in [|1|]
    for j = 0 to -3
    and q in [|-3; -1; 2; -3; 3; h; -2|]
    and f in [|v; 1; -2; 0|]
    and w in [|3; 1; 2; 2; -1; 1; 1|]
    for s in [|-3|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(f, h, j, q, s, v, w)
    for h in [:0; 3; -1; 3; 0; 3; 0:]
    and v in [:1:]
    for j = 0 to -3
    and q in [:-3; -1; 2; -3; 3; h; -2:]
    and f in [:v; 1; -2; 0:]
    and w in [:3; 1; 2; 2; -1; 1; 1:]
    for s in [:-3:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(c, l, m, p, u, y)
   for c in [-3; -2; 0; -2; 1; 0; -1] and p in [-2; 3; -2; 2; 0; 0]
   for y = 1 to 0
   for _ in [2; -2; p; 2; 3] and m = p downto -1
   for l = 0 to -2 and u = 1 downto 1
   for _ = p to 0 and y = -2 downto 2];;
[%%expect{|
Lines 1-6, characters 0-38:
1 | [(c, l, m, p, u, y)
2 |    for c in [-3; -2; 0; -2; 1; 0; -1] and p in [-2; 3; -2; 2; 0; 0]
3 |    for y = 1 to 0
4 |    for _ in [2; -2; p; 2; 3] and m = p downto -1
5 |    for l = 0 to -2 and u = 1 downto 1
6 |    for _ = p to 0 and y = -2 downto 2]..
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int) list = []
|}];;

[|(c, l, m, p, u, y)
    for c in [|-3; -2; 0; -2; 1; 0; -1|] and p in [|-2; 3; -2; 2; 0; 0|]
    for y = 1 to 0
    for _ in [|2; -2; p; 2; 3|] and m = p downto -1
    for l = 0 to -2 and u = 1 downto 1
    for _ = p to 0 and y = -2 downto 2|];;
[%%expect{|
Lines 1-6, characters 0-40:
1 | [|(c, l, m, p, u, y)
2 |     for c in [|-3; -2; 0; -2; 1; 0; -1|] and p in [|-2; 3; -2; 2; 0; 0|]
3 |     for y = 1 to 0
4 |     for _ in [|2; -2; p; 2; 3|] and m = p downto -1
5 |     for l = 0 to -2 and u = 1 downto 1
6 |     for _ = p to 0 and y = -2 downto 2|]..
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(c, l, m, p, u, y)
    for c in [:-3; -2; 0; -2; 1; 0; -1:] and p in [:-2; 3; -2; 2; 0; 0:]
    for y = 1 to 0
    for _ in [:2; -2; p; 2; 3:] and m = p downto -1
    for l = 0 to -2 and u = 1 downto 1
    for _ = p to 0 and y = -2 downto 2:];;
[%%expect{|
Lines 1-6, characters 0-40:
1 | [:(c, l, m, p, u, y)
2 |     for c in [:-3; -2; 0; -2; 1; 0; -1:] and p in [:-2; 3; -2; 2; 0; 0:]
3 |     for y = 1 to 0
4 |     for _ in [:2; -2; p; 2; 3:] and m = p downto -1
5 |     for l = 0 to -2 and u = 1 downto 1
6 |     for _ = p to 0 and y = -2 downto 2:]..
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(b, e) for e = 2 to -1 and b = -2 to -2];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(b, e) for e = 2 to -1 and b = -2 to -2|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(b, e) for e = 2 to -1 and b = -2 to -2:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[z for z = 0 to 3 when z > 0];;
[%%expect{|
- : int list = [1; 2; 3]
|}];;

[|z for z = 0 to 3 when z > 0|];;
[%%expect{|
- : int array = [|1; 2; 3|]
|}];;

[:z for z = 0 to 3 when z > 0:];;
[%%expect{|
- : int iarray = [:1; 2; 3:]
|}];;

[(a, h) for h in [3; -2; -1] and _ in [] and a in [2; -3; 1; -2; 1]];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(a, h) for h in [|3; -2; -1|] and _ in [||] and a in [|2; -3; 1; -2; 1|]|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(a, h) for h in [:3; -2; -1:] and _ in [::] and a in [:2; -3; 1; -2; 1:]:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(b, k, p, r, x)
   for x = -2 downto -3 and b = -3 to -1
   for p in [] and k in [-3; x; 0; -1; -2]
   for r = -3 downto 0
   when abs b mod 2 = 1
   for r = 2 downto -2];;
[%%expect{|
Lines 1-6, characters 0-23:
1 | [(b, k, p, r, x)
2 |    for x = -2 downto -3 and b = -3 to -1
3 |    for p in [] and k in [-3; x; 0; -1; -2]
4 |    for r = -3 downto 0
5 |    when abs b mod 2 = 1
6 |    for r = 2 downto -2]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * 'a * int * int) list = []
|}];;

[|(b, k, p, r, x)
    for x = -2 downto -3 and b = -3 to -1
    for p in [||] and k in [|-3; x; 0; -1; -2|]
    for r = -3 downto 0
    when abs b mod 2 = 1
    for r = 2 downto -2|];;
[%%expect{|
Lines 1-6, characters 0-25:
1 | [|(b, k, p, r, x)
2 |     for x = -2 downto -3 and b = -3 to -1
3 |     for p in [||] and k in [|-3; x; 0; -1; -2|]
4 |     for r = -3 downto 0
5 |     when abs b mod 2 = 1
6 |     for r = 2 downto -2|]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * '_weak25 * int * int) array = [||]
|}];;

[:(b, k, p, r, x)
    for x = -2 downto -3 and b = -3 to -1
    for p in [::] and k in [:-3; x; 0; -1; -2:]
    for r = -3 downto 0
    when abs b mod 2 = 1
    for r = 2 downto -2:];;
[%%expect{|
Lines 1-6, characters 0-25:
1 | [:(b, k, p, r, x)
2 |     for x = -2 downto -3 and b = -3 to -1
3 |     for p in [::] and k in [:-3; x; 0; -1; -2:]
4 |     for r = -3 downto 0
5 |     when abs b mod 2 = 1
6 |     for r = 2 downto -2:]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * 'a * int * int) iarray = [::]
|}];;

[(f, h, l, n, r, t, u, v, w)
   for w = 0 to 3 and h in [1] and v = 1 downto -3
   for f in [0; -3; 2; 3; v; w; v] and n = -2 downto 0 and r = -3 to -3
   for u in [3; 2; 3; 3; -1; -3] and n in [-3; 3; 1; f] and w in [-1; f]
   for v in [0; -1; -3] and l = -2 to f and t = 0 downto f];;
[%%expect{|
Lines 1-5, characters 0-59:
1 | [(f, h, l, n, r, t, u, v, w)
2 |    for w = 0 to 3 and h in [1] and v = 1 downto -3
3 |    for f in [0; -3; 2; 3; v; w; v] and n = -2 downto 0 and r = -3 to -3
4 |    for u in [3; 2; 3; 3; -1; -3] and n in [-3; 3; 1; f] and w in [-1; f]
5 |    for v in [0; -1; -3] and l = -2 to f and t = 0 downto f]..
Warning 26 [unused-var]: unused variable n.

- : (int * int * int * int * int * int * int * int * int) list = []
|}];;

[|(f, h, l, n, r, t, u, v, w)
    for w = 0 to 3 and h in [|1|] and v = 1 downto -3
    for f in [|0; -3; 2; 3; v; w; v|] and n = -2 downto 0 and r = -3 to -3
    for u in [|3; 2; 3; 3; -1; -3|] and n in [|-3; 3; 1; f|] and w in [|-1; f|]
    for v in [|0; -1; -3|] and l = -2 to f and t = 0 downto f|];;
[%%expect{|
Lines 1-5, characters 0-63:
1 | [|(f, h, l, n, r, t, u, v, w)
2 |     for w = 0 to 3 and h in [|1|] and v = 1 downto -3
3 |     for f in [|0; -3; 2; 3; v; w; v|] and n = -2 downto 0 and r = -3 to -3
4 |     for u in [|3; 2; 3; 3; -1; -3|] and n in [|-3; 3; 1; f|] and w in [|-1; f|]
5 |     for v in [|0; -1; -3|] and l = -2 to f and t = 0 downto f|]..
Warning 26 [unused-var]: unused variable n.

- : (int * int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(f, h, l, n, r, t, u, v, w)
    for w = 0 to 3 and h in [:1:] and v = 1 downto -3
    for f in [:0; -3; 2; 3; v; w; v:] and n = -2 downto 0 and r = -3 to -3
    for u in [:3; 2; 3; 3; -1; -3:] and n in [:-3; 3; 1; f:] and w in [:-1; f:]
    for v in [:0; -1; -3:] and l = -2 to f and t = 0 downto f:];;
[%%expect{|
Lines 1-5, characters 0-63:
1 | [:(f, h, l, n, r, t, u, v, w)
2 |     for w = 0 to 3 and h in [:1:] and v = 1 downto -3
3 |     for f in [:0; -3; 2; 3; v; w; v:] and n = -2 downto 0 and r = -3 to -3
4 |     for u in [:3; 2; 3; 3; -1; -3:] and n in [:-3; 3; 1; f:] and w in [:-1; f:]
5 |     for v in [:0; -1; -3:] and l = -2 to f and t = 0 downto f:]..
Warning 26 [unused-var]: unused variable n.

- : (int * int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(d, h, i, j, p, v)
   for j in [1; 3; 3; 3; -1; -1; 1]
   for i in [2]
   for v = 1 to -1 and j = j to -1
   for h = -1 downto 2 and p in [1; 3; -3] and d in [-2; j; 0; i; 3; 0; -2]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(d, h, i, j, p, v)
    for j in [|1; 3; 3; 3; -1; -1; 1|]
    for i in [|2|]
    for v = 1 to -1
    and j = j to -1
    for h = -1 downto 2
    and p in [|1; 3; -3|]
    and d in [|-2; j; 0; i; 3; 0; -2|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(d, h, i, j, p, v)
    for j in [:1; 3; 3; 3; -1; -1; 1:]
    for i in [:2:]
    for v = 1 to -1
    and j = j to -1
    for h = -1 downto 2
    and p in [:1; 3; -3:]
    and d in [:-2; j; 0; i; 3; 0; -2:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(a, h, j, n, r, u, z)
   for h in [2]
   when h > 0
   for r = 3 downto h and z in [-3; 3; -1] and a = 1 to -1
   for j = 0 to 3 and u in [-3; 2; a] and n in [0; -2; 1; 2; 3; 0]];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(a, h, j, n, r, u, z)
    for h in [|2|]
    when h > 0
    for r = 3 downto h and z in [|-3; 3; -1|] and a = 1 to -1
    for j = 0 to 3 and u in [|-3; 2; a|] and n in [|0; -2; 1; 2; 3; 0|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, h, j, n, r, u, z)
    for h in [:2:]
    when h > 0
    for r = 3 downto h and z in [:-3; 3; -1:] and a = 1 to -1
    for j = 0 to 3 and u in [:-3; 2; a:] and n in [:0; -2; 1; 2; 3; 0:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(e, f, h, n, o, s, t, v, y)
   for v in [-1; 2; -1; -2; 0; -2] and s = -3 to -2
   for t in [] and n = -1 to -2 and o in [0; -2; 2] and h in [1; v; 2; -2; 2; 1]
   for e in [-3; -3; -2] and y = v to 2 and f in [1]];;
[%%expect{|
- : (int * int * int * int * int * int * 'a * int * int) list = []
|}];;

[|(p, t) for t in [|1; -2; 3|] and p = 1 downto 0|];;
[%%expect{|
- : (int * int) array = [|(1, 1); (0, 1); (1, -2); (0, -2); (1, 3); (0, 3)|]
|}];;

[:(p, t) for t in [:1; -2; 3:] and p = 1 downto 0:];;
[%%expect{|
- : (int * int) iarray = [:(1, 1); (0, 1); (1, -2); (0, -2); (1, 3); (0, 3):]
|}];;

[(g, m, o, p)
   for m = 0 downto -1 and p in [3; -2; -2; -1]
   when m <> 0
   for o = -2 to -1 and _ = 3 to -2
   for g = -1 downto -2
   for m = -3 to 3];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(g, m, o, p)
    for m = 0 downto -1 and p in [|3; -2; -2; -1|]
    when m <> 0
    for o = -2 to -1 and _ = 3 to -2
    for g = -1 downto -2
    for m = -3 to 3|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(g, m, o, p)
    for m = 0 downto -1 and p in [:3; -2; -2; -1:]
    when m <> 0
    for o = -2 to -1 and _ = 3 to -2
    for g = -1 downto -2
    for m = -3 to 3:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(a, l, n, t, v, w, x)
   for l in [3; -1; 2; -2; 0; -2; 0]
   for t = 0 downto -1 and a = -1 downto -1
   for n = 0 to -3 and v = -3 downto 2
   for x in [3; 1; 3] and w in []
   for _ = 0 downto -2];;
[%%expect{|
- : (int * int * int * int * int * 'a * int) list = []
|}];;

[|(a, l, n, t, v, w, x)
    for l in [|3; -1; 2; -2; 0; -2; 0|]
    for t = 0 downto -1 and a = -1 downto -1
    for n = 0 to -3 and v = -3 downto 2
    for x in [|3; 1; 3|] and w in [||]
    for _ = 0 downto -2|];;
[%%expect{|
- : (int * int * int * int * int * '_weak26 * int) array = [||]
|}];;

[:(a, l, n, t, v, w, x)
    for l in [:3; -1; 2; -2; 0; -2; 0:]
    for t = 0 downto -1 and a = -1 downto -1
    for n = 0 to -3 and v = -3 downto 2
    for x in [:3; 1; 3:] and w in [::]
    for _ = 0 downto -2:];;
[%%expect{|
- : (int * int * int * int * int * 'a * int) iarray = [::]
|}];;

[(a, f, j, k, z)
   for z in [-3; 1; -2; 1; 1]
   for j in [1; -2; 3; 2; -2; -1] and k in [2; 0; -2; 0; -3] and f = -1 downto 0
   when z <> 0
   for a = 3 downto -2];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(a, b, g, s, v)
    for a = -3 to -1
    for s in [|2; a; a; -2; 2; 3|]
    and b = 2 to a
    and g in [|-1; -3; -1; 0|]
    and v = a downto 2
    when a > 0|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(a, b, g, s, v)
    for a = -3 to -1
    for s in [:2; a; a; -2; 2; 3:]
    and b = 2 to a
    and g in [:-1; -3; -1; 0:]
    and v = a downto 2
    when a > 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(b, d, e, n)
   for b = -3 to 3 and d = -2 downto -3
   for e = -1 to 1 and n in [2]
   when abs e mod 2 = 1];;
[%%expect{|
- : (int * int * int * int) list =
[(-3, -2, -1, 2); (-3, -2, 1, 2); (-3, -3, -1, 2); (-3, -3, 1, 2);
 (-2, -2, -1, 2); (-2, -2, 1, 2); (-2, -3, -1, 2); (-2, -3, 1, 2);
 (-1, -2, -1, 2); (-1, -2, 1, 2); (-1, -3, -1, 2); (-1, -3, 1, 2);
 (0, -2, -1, 2); (0, -2, 1, 2); (0, -3, -1, 2); (0, -3, 1, 2);
 (1, -2, -1, 2); (1, -2, 1, 2); (1, -3, -1, 2); (1, -3, 1, 2);
 (2, -2, -1, 2); (2, -2, 1, 2); (2, -3, -1, 2); (2, -3, 1, 2);
 (3, -2, -1, 2); (3, -2, 1, 2); (3, -3, -1, 2); (3, -3, 1, 2)]
|}];;

[|(b, d, e, n)
    for b = -3 to 3 and d = -2 downto -3
    for e = -1 to 1 and n in [|2|]
    when abs e mod 2 = 1|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-3, -2, -1, 2); (-3, -2, 1, 2); (-3, -3, -1, 2); (-3, -3, 1, 2);
  (-2, -2, -1, 2); (-2, -2, 1, 2); (-2, -3, -1, 2); (-2, -3, 1, 2);
  (-1, -2, -1, 2); (-1, -2, 1, 2); (-1, -3, -1, 2); (-1, -3, 1, 2);
  (0, -2, -1, 2); (0, -2, 1, 2); (0, -3, -1, 2); (0, -3, 1, 2);
  (1, -2, -1, 2); (1, -2, 1, 2); (1, -3, -1, 2); (1, -3, 1, 2);
  (2, -2, -1, 2); (2, -2, 1, 2); (2, -3, -1, 2); (2, -3, 1, 2);
  (3, -2, -1, 2); (3, -2, 1, 2); (3, -3, -1, 2); (3, -3, 1, 2)|]
|}];;

[:(b, d, e, n)
    for b = -3 to 3 and d = -2 downto -3
    for e = -1 to 1 and n in [:2:]
    when abs e mod 2 = 1:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-3, -2, -1, 2); (-3, -2, 1, 2); (-3, -3, -1, 2); (-3, -3, 1, 2);
  (-2, -2, -1, 2); (-2, -2, 1, 2); (-2, -3, -1, 2); (-2, -3, 1, 2);
  (-1, -2, -1, 2); (-1, -2, 1, 2); (-1, -3, -1, 2); (-1, -3, 1, 2);
  (0, -2, -1, 2); (0, -2, 1, 2); (0, -3, -1, 2); (0, -3, 1, 2);
  (1, -2, -1, 2); (1, -2, 1, 2); (1, -3, -1, 2); (1, -3, 1, 2);
  (2, -2, -1, 2); (2, -2, 1, 2); (2, -3, -1, 2); (2, -3, 1, 2);
  (3, -2, -1, 2); (3, -2, 1, 2); (3, -3, -1, 2); (3, -3, 1, 2):]
|}];;

[(a, d, s, t, w)
   for _ in [-3] and t in [-2] and w in [1; -2; -1; 1] and d = 0 downto -2
   for s in [w; -2] and a = 3 to 1];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(h, m, u, x)
    for x = 2 to 3
    for u in [|3; 3; 2; 3; 1; 1|]
    when u > 0
    for m = 0 to -2 and h in [|0; 1|]
    when m < 0|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(h, m, u, x)
    for x = 2 to 3
    for u in [:3; 3; 2; 3; 1; 1:]
    when u > 0
    for m = 0 to -2 and h in [:0; 1:]
    when m < 0:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(i, m, o, x)
   for i = -3 to 2
   for x = -3 to -2 and m = -1 downto 0 and i in [3; -1; -2] and o = 1 to -1];;
[%%expect{|
Lines 1-3, characters 0-77:
1 | [(i, m, o, x)
2 |    for i = -3 to 2
3 |    for x = -3 to -2 and m = -1 downto 0 and i in [3; -1; -2] and o = 1 to -1]..
Warning 26 [unused-var]: unused variable i.

- : (int * int * int * int) list = []
|}];;

[|(d, o, u)
    for u = 2 downto -3 and d = -1 downto -1 and o in [|-1; -3; -1; -3|]|];;
[%%expect{|
- : (int * int * int) array =
[|(-1, -1, 2); (-1, -3, 2); (-1, -1, 2); (-1, -3, 2); (-1, -1, 1);
  (-1, -3, 1); (-1, -1, 1); (-1, -3, 1); (-1, -1, 0); (-1, -3, 0);
  (-1, -1, 0); (-1, -3, 0); (-1, -1, -1); (-1, -3, -1); (-1, -1, -1);
  (-1, -3, -1); (-1, -1, -2); (-1, -3, -2); (-1, -1, -2); (-1, -3, -2);
  (-1, -1, -3); (-1, -3, -3); (-1, -1, -3); (-1, -3, -3)|]
|}];;

[:(d, o, u)
    for u = 2 downto -3 and d = -1 downto -1 and o in [:-1; -3; -1; -3:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-1, -1, 2); (-1, -3, 2); (-1, -1, 2); (-1, -3, 2); (-1, -1, 1);
  (-1, -3, 1); (-1, -1, 1); (-1, -3, 1); (-1, -1, 0); (-1, -3, 0);
  (-1, -1, 0); (-1, -3, 0); (-1, -1, -1); (-1, -3, -1); (-1, -1, -1);
  (-1, -3, -1); (-1, -1, -2); (-1, -3, -2); (-1, -1, -2); (-1, -3, -2);
  (-1, -1, -3); (-1, -3, -3); (-1, -1, -3); (-1, -3, -3):]
|}];;

[(a, d, p, w, y)
   for w in [2; -1; -1; 2; 3; 3; -1]
   for d = -2 to 1 and a in [0; 2; -3; -2; 3; -1; 1] and y = 1 to w
   for a in [-3; 2; 2; -1; 1] and p = -1 to 0
   for w = -2 downto 3];;
[%%expect{|
Line 3, characters 23-24:
3 |    for d = -2 to 1 and a in [0; 2; -3; -2; 3; -1; 1] and y = 1 to w
                           ^
Warning 26 [unused-var]: unused variable a.

- : (int * int * int * int * int) list = []
|}];;

[|(a, d, p, w, y)
    for w in [|2; -1; -1; 2; 3; 3; -1|]
    for d = -2 to 1 and a in [|0; 2; -3; -2; 3; -1; 1|] and y = 1 to w
    for a in [|-3; 2; 2; -1; 1|] and p = -1 to 0
    for w = -2 downto 3|];;
[%%expect{|
Line 3, characters 24-25:
3 |     for d = -2 to 1 and a in [|0; 2; -3; -2; 3; -1; 1|] and y = 1 to w
                            ^
Warning 26 [unused-var]: unused variable a.

- : (int * int * int * int * int) array = [||]
|}];;

[:(a, d, p, w, y)
    for w in [:2; -1; -1; 2; 3; 3; -1:]
    for d = -2 to 1 and a in [:0; 2; -3; -2; 3; -1; 1:] and y = 1 to w
    for a in [:-3; 2; 2; -1; 1:] and p = -1 to 0
    for w = -2 downto 3:];;
[%%expect{|
Line 3, characters 24-25:
3 |     for d = -2 to 1 and a in [:0; 2; -3; -2; 3; -1; 1:] and y = 1 to w
                            ^
Warning 26 [unused-var]: unused variable a.

- : (int * int * int * int * int) iarray = [::]
|}];;

[(j, o, t, v)
   for o = 1 downto -1
   and t in [3; -1; 0; 2]
   and v in [-2; 3; 3]
   and j in [-3; -2]
   when abs j mod 2 = 1
   when v <> 0];;
[%%expect{|
- : (int * int * int * int) list =
[(-3, 1, 3, -2); (-3, 1, 3, 3); (-3, 1, 3, 3); (-3, 1, -1, -2);
 (-3, 1, -1, 3); (-3, 1, -1, 3); (-3, 1, 0, -2); (-3, 1, 0, 3);
 (-3, 1, 0, 3); (-3, 1, 2, -2); (-3, 1, 2, 3); (-3, 1, 2, 3); (-3, 0, 3, -2);
 (-3, 0, 3, 3); (-3, 0, 3, 3); (-3, 0, -1, -2); (-3, 0, -1, 3);
 (-3, 0, -1, 3); (-3, 0, 0, -2); (-3, 0, 0, 3); (-3, 0, 0, 3);
 (-3, 0, 2, -2); (-3, 0, 2, 3); (-3, 0, 2, 3); (-3, -1, 3, -2);
 (-3, -1, 3, 3); (-3, -1, 3, 3); (-3, -1, -1, -2); (-3, -1, -1, 3);
 (-3, -1, -1, 3); (-3, -1, 0, -2); (-3, -1, 0, 3); (-3, -1, 0, 3);
 (-3, -1, 2, -2); (-3, -1, 2, 3); (-3, -1, 2, 3)]
|}];;

[|(j, o, t, v)
    for o = 1 downto -1
    and t in [|3; -1; 0; 2|]
    and v in [|-2; 3; 3|]
    and j in [|-3; -2|]
    when abs j mod 2 = 1
    when v <> 0|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-3, 1, 3, -2); (-3, 1, 3, 3); (-3, 1, 3, 3); (-3, 1, -1, -2);
  (-3, 1, -1, 3); (-3, 1, -1, 3); (-3, 1, 0, -2); (-3, 1, 0, 3);
  (-3, 1, 0, 3); (-3, 1, 2, -2); (-3, 1, 2, 3); (-3, 1, 2, 3);
  (-3, 0, 3, -2); (-3, 0, 3, 3); (-3, 0, 3, 3); (-3, 0, -1, -2);
  (-3, 0, -1, 3); (-3, 0, -1, 3); (-3, 0, 0, -2); (-3, 0, 0, 3);
  (-3, 0, 0, 3); (-3, 0, 2, -2); (-3, 0, 2, 3); (-3, 0, 2, 3);
  (-3, -1, 3, -2); (-3, -1, 3, 3); (-3, -1, 3, 3); (-3, -1, -1, -2);
  (-3, -1, -1, 3); (-3, -1, -1, 3); (-3, -1, 0, -2); (-3, -1, 0, 3);
  (-3, -1, 0, 3); (-3, -1, 2, -2); (-3, -1, 2, 3); (-3, -1, 2, 3)|]
|}];;

[:(j, o, t, v)
    for o = 1 downto -1
    and t in [:3; -1; 0; 2:]
    and v in [:-2; 3; 3:]
    and j in [:-3; -2:]
    when abs j mod 2 = 1
    when v <> 0:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-3, 1, 3, -2); (-3, 1, 3, 3); (-3, 1, 3, 3); (-3, 1, -1, -2);
  (-3, 1, -1, 3); (-3, 1, -1, 3); (-3, 1, 0, -2); (-3, 1, 0, 3);
  (-3, 1, 0, 3); (-3, 1, 2, -2); (-3, 1, 2, 3); (-3, 1, 2, 3);
  (-3, 0, 3, -2); (-3, 0, 3, 3); (-3, 0, 3, 3); (-3, 0, -1, -2);
  (-3, 0, -1, 3); (-3, 0, -1, 3); (-3, 0, 0, -2); (-3, 0, 0, 3);
  (-3, 0, 0, 3); (-3, 0, 2, -2); (-3, 0, 2, 3); (-3, 0, 2, 3);
  (-3, -1, 3, -2); (-3, -1, 3, 3); (-3, -1, 3, 3); (-3, -1, -1, -2);
  (-3, -1, -1, 3); (-3, -1, -1, 3); (-3, -1, 0, -2); (-3, -1, 0, 3);
  (-3, -1, 0, 3); (-3, -1, 2, -2); (-3, -1, 2, 3); (-3, -1, 2, 3):]
|}];;

[(h, l, o, q, u)
   for l = -2 to 2
   for h = 1 to 3
   for _ = h to 2 and u in [1; -2]
   for q in []
   for o in [0; 2; 0; -2]];;
[%%expect{|
- : (int * int * int * 'a * int) list = []
|}];;

[|(h, l, o, q, u)
    for l = -2 to 2
    for h = 1 to 3
    for _ = h to 2 and u in [|1; -2|]
    for q in [||]
    for o in [|0; 2; 0; -2|]|];;
[%%expect{|
- : (int * int * int * '_weak27 * int) array = [||]
|}];;

[:(h, l, o, q, u)
    for l = -2 to 2
    for h = 1 to 3
    for _ = h to 2 and u in [:1; -2:]
    for q in [::]
    for o in [:0; 2; 0; -2:]:];;
[%%expect{|
- : (int * int * int * 'a * int) iarray = [::]
|}];;

[(e, m, o, q, u)
   for q in [-1; -3; 3; 1; 0; 2]
   for o in [] and e = -2 to 1
   for u in [3; -3; -1; q] and m = -3 to 3];;
[%%expect{|
- : (int * int * 'a * int * int) list = []
|}];;

[|(e, m, o, q, u)
    for q in [|-1; -3; 3; 1; 0; 2|]
    for o in [||] and e = -2 to 1
    for u in [|3; -3; -1; q|] and m = -3 to 3|];;
[%%expect{|
- : (int * int * '_weak28 * int * int) array = [||]
|}];;

[:(e, m, o, q, u)
    for q in [:-1; -3; 3; 1; 0; 2:]
    for o in [::] and e = -2 to 1
    for u in [:3; -3; -1; q:] and m = -3 to 3:];;
[%%expect{|
- : (int * int * 'a * int * int) iarray = [::]
|}];;

[(n, t) for n = -1 to 0 for t = 1 downto -1];;
[%%expect{|
- : (int * int) list = [(-1, 1); (-1, 0); (-1, -1); (0, 1); (0, 0); (0, -1)]
|}];;

[|(n, t) for n = -1 to 0 for t = 1 downto -1|];;
[%%expect{|
- : (int * int) array =
[|(-1, 1); (-1, 0); (-1, -1); (0, 1); (0, 0); (0, -1)|]
|}];;

[:(n, t) for n = -1 to 0 for t = 1 downto -1:];;
[%%expect{|
- : (int * int) iarray =
[:(-1, 1); (-1, 0); (-1, -1); (0, 1); (0, 0); (0, -1):]
|}];;

[(q, t) for t in [1; -1; 1] and q = 2 downto 3];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(q, t) for t in [|1; -1; 1|] and q = 2 downto 3|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(q, t) for t in [:1; -1; 1:] and q = 2 downto 3:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(d, n, y) for n = 0 to 1 and d in [] and y = 0 downto 1];;
[%%expect{|
- : ('a * int * int) list = []
|}];;

[|(d, n, y) for n = 0 to 1 and d in [||] and y = 0 downto 1|];;
[%%expect{|
- : ('_weak29 * int * int) array = [||]
|}];;

[:(d, n, y) for n = 0 to 1 and d in [::] and y = 0 downto 1:];;
[%%expect{|
- : ('a * int * int) iarray = [::]
|}];;

[(a, m) for a = 2 to 1 for m = -3 to a];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(a, m) for a = 2 to 1 for m = -3 to a|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(a, m) for a = 2 to 1 for m = -3 to a:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(c, l, p, w, y)
   for l = 3 to 3
   when l < 0
   for y in [l; -3; -3; l] and w in [-2]
   for _ = -2 downto -2 and c in [2; -3]
   for p = -1 to 2];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(c, l, p, w, y)
    for l = 3 to 3
    when l < 0
    for y in [|l; -3; -3; l|] and w in [|-2|]
    for _ = -2 downto -2 and c in [|2; -3|]
    for p = -1 to 2|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(c, l, p, w, y)
    for l = 3 to 3
    when l < 0
    for y in [:l; -3; -3; l:] and w in [:-2:]
    for _ = -2 downto -2 and c in [:2; -3:]
    for p = -1 to 2:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(a, l, t, u, w)
   for w in [0; 3; -1; -1; -3; 3; 2] and a in [2; 3; 3; 3; 2; 3; 3]
   for l in [-3; 3] and u in []
   for t = -3 to 1 and _ in [a; 1; w; 1]];;
[%%expect{|
- : (int * int * int * 'a * int) list = []
|}];;

[|(a, l, t, u, w)
    for w in [|0; 3; -1; -1; -3; 3; 2|] and a in [|2; 3; 3; 3; 2; 3; 3|]
    for l in [|-3; 3|] and u in [||]
    for t = -3 to 1 and _ in [|a; 1; w; 1|]|];;
[%%expect{|
- : (int * int * int * '_weak30 * int) array = [||]
|}];;

[:(a, l, t, u, w)
    for w in [:0; 3; -1; -1; -3; 3; 2:] and a in [:2; 3; 3; 3; 2; 3; 3:]
    for l in [:-3; 3:] and u in [::]
    for t = -3 to 1 and _ in [:a; 1; w; 1:]:];;
[%%expect{|
- : (int * int * int * 'a * int) iarray = [::]
|}];;

[(b, m, s)
   for m in [3; 1; -1]
   when m < 0
   for _ in [0] and s = 1 to 2
   for s = 2 downto -3 and m = 3 to -1 and b = -3 to 3];;
[%%expect{|
Lines 1-5, characters 0-55:
1 | [(b, m, s)
2 |    for m in [3; 1; -1]
3 |    when m < 0
4 |    for _ in [0] and s = 1 to 2
5 |    for s = 2 downto -3 and m = 3 to -1 and b = -3 to 3]..
Warning 26 [unused-var]: unused variable s.

- : (int * int * int) list = []
|}];;

[|(b, m, s)
    for m in [|3; 1; -1|]
    when m < 0
    for _ in [|0|] and s = 1 to 2
    for s = 2 downto -3 and m = 3 to -1 and b = -3 to 3|];;
[%%expect{|
Lines 1-5, characters 0-57:
1 | [|(b, m, s)
2 |     for m in [|3; 1; -1|]
3 |     when m < 0
4 |     for _ in [|0|] and s = 1 to 2
5 |     for s = 2 downto -3 and m = 3 to -1 and b = -3 to 3|]..
Warning 26 [unused-var]: unused variable s.

- : (int * int * int) array = [||]
|}];;

[:(b, m, s)
    for m in [:3; 1; -1:]
    when m < 0
    for _ in [:0:] and s = 1 to 2
    for s = 2 downto -3 and m = 3 to -1 and b = -3 to 3:];;
[%%expect{|
Lines 1-5, characters 0-57:
1 | [:(b, m, s)
2 |     for m in [:3; 1; -1:]
3 |     when m < 0
4 |     for _ in [:0:] and s = 1 to 2
5 |     for s = 2 downto -3 and m = 3 to -1 and b = -3 to 3:]..
Warning 26 [unused-var]: unused variable s.

- : (int * int * int) iarray = [::]
|}];;

[(c, g, j, t, x, y)
   for j in [-3; 0; -1; -3; 3; 2; -3] and t in [3]
   for c = 0 downto 3 and y = 3 to 3
   for x = -2 to 2 and y = -1 downto -2
   for j in [2; -2; -3; 1; x; 0] and g = -3 to -2
   for y in [c; 1]];;
[%%expect{|
Line 2, characters 7-8:
2 |    for j in [-3; 0; -1; -3; 3; 2; -3] and t in [3]
           ^
Warning 26 [unused-var]: unused variable j.

Lines 1-6, characters 0-19:
1 | [(c, g, j, t, x, y)
2 |    for j in [-3; 0; -1; -3; 3; 2; -3] and t in [3]
3 |    for c = 0 downto 3 and y = 3 to 3
4 |    for x = -2 to 2 and y = -1 downto -2
5 |    for j in [2; -2; -3; 1; x; 0] and g = -3 to -2
6 |    for y in [c; 1]]..
Warning 26 [unused-var]: unused variable y.

Lines 1-6, characters 0-19:
1 | [(c, g, j, t, x, y)
2 |    for j in [-3; 0; -1; -3; 3; 2; -3] and t in [3]
3 |    for c = 0 downto 3 and y = 3 to 3
4 |    for x = -2 to 2 and y = -1 downto -2
5 |    for j in [2; -2; -3; 1; x; 0] and g = -3 to -2
6 |    for y in [c; 1]]..
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int) list = []
|}];;

[|(c, g, j, t, x, y)
    for j in [|-3; 0; -1; -3; 3; 2; -3|] and t in [|3|]
    for c = 0 downto 3 and y = 3 to 3
    for x = -2 to 2 and y = -1 downto -2
    for j in [|2; -2; -3; 1; x; 0|] and g = -3 to -2
    for y in [|c; 1|]|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for j in [|-3; 0; -1; -3; 3; 2; -3|] and t in [|3|]
            ^
Warning 26 [unused-var]: unused variable j.

Lines 1-6, characters 0-23:
1 | [|(c, g, j, t, x, y)
2 |     for j in [|-3; 0; -1; -3; 3; 2; -3|] and t in [|3|]
3 |     for c = 0 downto 3 and y = 3 to 3
4 |     for x = -2 to 2 and y = -1 downto -2
5 |     for j in [|2; -2; -3; 1; x; 0|] and g = -3 to -2
6 |     for y in [|c; 1|]|]..
Warning 26 [unused-var]: unused variable y.

Lines 1-6, characters 0-23:
1 | [|(c, g, j, t, x, y)
2 |     for j in [|-3; 0; -1; -3; 3; 2; -3|] and t in [|3|]
3 |     for c = 0 downto 3 and y = 3 to 3
4 |     for x = -2 to 2 and y = -1 downto -2
5 |     for j in [|2; -2; -3; 1; x; 0|] and g = -3 to -2
6 |     for y in [|c; 1|]|]..
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(c, g, j, t, x, y)
    for j in [:-3; 0; -1; -3; 3; 2; -3:] and t in [:3:]
    for c = 0 downto 3 and y = 3 to 3
    for x = -2 to 2 and y = -1 downto -2
    for j in [:2; -2; -3; 1; x; 0:] and g = -3 to -2
    for y in [:c; 1:]:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for j in [:-3; 0; -1; -3; 3; 2; -3:] and t in [:3:]
            ^
Warning 26 [unused-var]: unused variable j.

Lines 1-6, characters 0-23:
1 | [:(c, g, j, t, x, y)
2 |     for j in [:-3; 0; -1; -3; 3; 2; -3:] and t in [:3:]
3 |     for c = 0 downto 3 and y = 3 to 3
4 |     for x = -2 to 2 and y = -1 downto -2
5 |     for j in [:2; -2; -3; 1; x; 0:] and g = -3 to -2
6 |     for y in [:c; 1:]:]..
Warning 26 [unused-var]: unused variable y.

Lines 1-6, characters 0-23:
1 | [:(c, g, j, t, x, y)
2 |     for j in [:-3; 0; -1; -3; 3; 2; -3:] and t in [:3:]
3 |     for c = 0 downto 3 and y = 3 to 3
4 |     for x = -2 to 2 and y = -1 downto -2
5 |     for j in [:2; -2; -3; 1; x; 0:] and g = -3 to -2
6 |     for y in [:c; 1:]:]..
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(a, d)
   for d in [-2; 2; 3] and a in [-1; 0; 2; 0; 1; 0; -2]
   when d > 0
   when abs d mod 2 = 0];;
[%%expect{|
- : (int * int) list =
[(-1, 2); (0, 2); (2, 2); (0, 2); (1, 2); (0, 2); (-2, 2)]
|}];;

[|(a, d)
    for d in [|-2; 2; 3|] and a in [|-1; 0; 2; 0; 1; 0; -2|]
    when d > 0
    when abs d mod 2 = 0|];;
[%%expect{|
- : (int * int) array =
[|(-1, 2); (0, 2); (2, 2); (0, 2); (1, 2); (0, 2); (-2, 2)|]
|}];;

[:(a, d)
    for d in [:-2; 2; 3:] and a in [:-1; 0; 2; 0; 1; 0; -2:]
    when d > 0
    when abs d mod 2 = 0:];;
[%%expect{|
- : (int * int) iarray =
[:(-1, 2); (0, 2); (2, 2); (0, 2); (1, 2); (0, 2); (-2, 2):]
|}];;

[(e, o, p, r)
   for e = 3 downto 2
   when e <> 0
   when abs e mod 2 = 0
   for p = 3 downto -3 and o = 1 downto e
   for r = 1 downto -1];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(e, o, p, r)
    for e = 3 downto 2
    when e <> 0
    when abs e mod 2 = 0
    for p = 3 downto -3 and o = 1 downto e
    for r = 1 downto -1|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(e, o, p, r)
    for e = 3 downto 2
    when e <> 0
    when abs e mod 2 = 0
    for p = 3 downto -3 and o = 1 downto e
    for r = 1 downto -1:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(c, i, o, s, u, y)
   for y in [1; 1; 2; -2; 0; -2]
   for c = 0 downto y and o in [y]
   for i in []
   for s in [1; 2; 3; 0; 0; -1; i] and u = 3 downto -3];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(c, i, o, s, u, y)
    for y in [|1; 1; 2; -2; 0; -2|]
    for c = 0 downto y and o in [|y|]
    for i in [||]
    for s in [|1; 2; 3; 0; 0; -1; i|] and u = 3 downto -3|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(c, i, o, s, u, y)
    for y in [:1; 1; 2; -2; 0; -2:]
    for c = 0 downto y and o in [:y:]
    for i in [::]
    for s in [:1; 2; 3; 0; 0; -1; i:] and u = 3 downto -3:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(b, c, p, q, r, x)
   for b in [3; 1]
   for r in [3; 0; -2; 2; 1; 3] and x in [] and p = -1 to -3 and c in []
   for r in [b; 3; 0; -2; 1; -1; 0] and q = -1 to 3];;
[%%expect{|
Line 3, characters 7-8:
3 |    for r in [3; 0; -2; 2; 1; 3] and x in [] and p = -1 to -3 and c in []
           ^
Warning 26 [unused-var]: unused variable r.

- : (int * 'a * int * int * int * 'b) list = []
|}];;

[|(b, c, p, q, r, x)
    for b in [|3; 1|]
    for r in [|3; 0; -2; 2; 1; 3|] and x in [||] and p = -1 to -3 and c in [||]
    for r in [|b; 3; 0; -2; 1; -1; 0|] and q = -1 to 3|];;
[%%expect{|
Line 3, characters 8-9:
3 |     for r in [|3; 0; -2; 2; 1; 3|] and x in [||] and p = -1 to -3 and c in [||]
            ^
Warning 26 [unused-var]: unused variable r.

- : (int * '_weak31 * int * int * int * '_weak32) array = [||]
|}];;

[:(b, c, p, q, r, x)
    for b in [:3; 1:]
    for r in [:3; 0; -2; 2; 1; 3:] and x in [::] and p = -1 to -3 and c in [::]
    for r in [:b; 3; 0; -2; 1; -1; 0:] and q = -1 to 3:];;
[%%expect{|
Line 3, characters 8-9:
3 |     for r in [:3; 0; -2; 2; 1; 3:] and x in [::] and p = -1 to -3 and c in [::]
            ^
Warning 26 [unused-var]: unused variable r.

- : (int * 'a * int * int * int * 'b) iarray = [::]
|}];;

[(e, o, q, w, y)
   for y in [1; 1; -2; 1; -1; -1]
   and o in [0]
   for e = -1 to y
   and o = 2 to y
   and q in [1; -1; 0]
   and _ in [0; 3]
   and w = 2 to o];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(e, o, q, w, y)
    for y in [|1; 1; -2; 1; -1; -1|]
    and o in [|0|]
    for e = -1 to y
    and o = 2 to y
    and q in [|1; -1; 0|]
    and _ in [|0; 3|]
    and w = 2 to o|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(e, o, q, w, y)
    for y in [:1; 1; -2; 1; -1; -1:]
    and o in [:0:]
    for e = -1 to y
    and o = 2 to y
    and q in [:1; -1; 0:]
    and _ in [:0; 3:]
    and w = 2 to o:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(n, o, q, t, w, z)
   for z in [-1; 2; 0] and q = -3 to -3
   for q in [3] and w = 1 downto z
   for o = -1 downto 2 and n = 0 to 0
   for t = -2 to -3 and o = -3 to 1];;
[%%expect{|
Lines 1-5, characters 0-36:
1 | [(n, o, q, t, w, z)
2 |    for z in [-1; 2; 0] and q = -3 to -3
3 |    for q in [3] and w = 1 downto z
4 |    for o = -1 downto 2 and n = 0 to 0
5 |    for t = -2 to -3 and o = -3 to 1]..
Warning 26 [unused-var]: unused variable q.

Lines 1-5, characters 0-36:
1 | [(n, o, q, t, w, z)
2 |    for z in [-1; 2; 0] and q = -3 to -3
3 |    for q in [3] and w = 1 downto z
4 |    for o = -1 downto 2 and n = 0 to 0
5 |    for t = -2 to -3 and o = -3 to 1]..
Warning 26 [unused-var]: unused variable o.

- : (int * int * int * int * int * int) list = []
|}];;

[|(n, o, q, t, w, z)
    for z in [|-1; 2; 0|] and q = -3 to -3
    for q in [|3|] and w = 1 downto z
    for o = -1 downto 2 and n = 0 to 0
    for t = -2 to -3 and o = -3 to 1|];;
[%%expect{|
Lines 1-5, characters 0-38:
1 | [|(n, o, q, t, w, z)
2 |     for z in [|-1; 2; 0|] and q = -3 to -3
3 |     for q in [|3|] and w = 1 downto z
4 |     for o = -1 downto 2 and n = 0 to 0
5 |     for t = -2 to -3 and o = -3 to 1|]..
Warning 26 [unused-var]: unused variable q.

Lines 1-5, characters 0-38:
1 | [|(n, o, q, t, w, z)
2 |     for z in [|-1; 2; 0|] and q = -3 to -3
3 |     for q in [|3|] and w = 1 downto z
4 |     for o = -1 downto 2 and n = 0 to 0
5 |     for t = -2 to -3 and o = -3 to 1|]..
Warning 26 [unused-var]: unused variable o.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(n, o, q, t, w, z)
    for z in [:-1; 2; 0:] and q = -3 to -3
    for q in [:3:] and w = 1 downto z
    for o = -1 downto 2 and n = 0 to 0
    for t = -2 to -3 and o = -3 to 1:];;
[%%expect{|
Lines 1-5, characters 0-38:
1 | [:(n, o, q, t, w, z)
2 |     for z in [:-1; 2; 0:] and q = -3 to -3
3 |     for q in [:3:] and w = 1 downto z
4 |     for o = -1 downto 2 and n = 0 to 0
5 |     for t = -2 to -3 and o = -3 to 1:]..
Warning 26 [unused-var]: unused variable q.

Lines 1-5, characters 0-38:
1 | [:(n, o, q, t, w, z)
2 |     for z in [:-1; 2; 0:] and q = -3 to -3
3 |     for q in [:3:] and w = 1 downto z
4 |     for o = -1 downto 2 and n = 0 to 0
5 |     for t = -2 to -3 and o = -3 to 1:]..
Warning 26 [unused-var]: unused variable o.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[n for n = -1 downto 3 when n < 0 when n < 0 when abs n mod 2 = 0];;
[%%expect{|
- : int list = []
|}];;

[|n for n = -1 downto 3 when n < 0 when n < 0 when abs n mod 2 = 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:n for n = -1 downto 3 when n < 0 when n < 0 when abs n mod 2 = 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(i, k) for k in [-3; 1] and i = -1 to -2 and _ = 1 downto -3];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(i, k) for k in [|-3; 1|] and i = -1 to -2 and _ = 1 downto -3|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(i, k) for k in [:-3; 1:] and i = -1 to -2 and _ = 1 downto -3:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(e, f, p, v, w)
   for f = -2 to 3 and v = 1 to 2
   for w in [-3; f; -2]
   for p = -2 to 3 and e = 0 to -2];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(e, f, p, v, w)
    for f = -2 to 3 and v = 1 to 2
    for w in [|-3; f; -2|]
    for p = -2 to 3 and e = 0 to -2|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(e, f, p, v, w)
    for f = -2 to 3 and v = 1 to 2
    for w in [:-3; f; -2:]
    for p = -2 to 3 and e = 0 to -2:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(a, d, g, s, t)
   for a in [0; -3; 2; 3; 3] and s in [0; 3; 3] and t in [0]
   when abs s mod 2 = 1
   for s in []
   for d in [3; -2; 2; 3; 3] and g = 3 to 3];;
[%%expect{|
- : (int * int * int * 'a * int) list = []
|}];;

[|(a, d, g, s, t)
    for a in [|0; -3; 2; 3; 3|] and s in [|0; 3; 3|] and t in [|0|]
    when abs s mod 2 = 1
    for s in [||]
    for d in [|3; -2; 2; 3; 3|] and g = 3 to 3|];;
[%%expect{|
- : (int * int * int * '_weak33 * int) array = [||]
|}];;

[:(a, d, g, s, t)
    for a in [:0; -3; 2; 3; 3:] and s in [:0; 3; 3:] and t in [:0:]
    when abs s mod 2 = 1
    for s in [::]
    for d in [:3; -2; 2; 3; 3:] and g = 3 to 3:];;
[%%expect{|
- : (int * int * int * 'a * int) iarray = [::]
|}];;

[(n, v) for n in [-2] when abs n mod 2 = 0 for v = 3 to 0];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(n, v) for n in [|-2|] when abs n mod 2 = 0 for v = 3 to 0|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(n, v) for n in [:-2:] when abs n mod 2 = 0 for v = 3 to 0:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(c, f, z) for f = 1 downto -2 and c = -3 to 0 and z in [] when f > 0];;
[%%expect{|
- : (int * int * 'a) list = []
|}];;

[|(c, f, z) for f = 1 downto -2 and c = -3 to 0 and z in [||] when f > 0|];;
[%%expect{|
- : (int * int * '_weak34) array = [||]
|}];;

[:(c, f, z) for f = 1 downto -2 and c = -3 to 0 and z in [::] when f > 0:];;
[%%expect{|
- : (int * int * 'a) iarray = [::]
|}];;

[(p, q, u) for q = -2 downto -3 and p in [2; -3; -2; 0; 2] and u in [1; -2]];;
[%%expect{|
- : (int * int * int) list =
[(2, -2, 1); (2, -2, -2); (-3, -2, 1); (-3, -2, -2); (-2, -2, 1);
 (-2, -2, -2); (0, -2, 1); (0, -2, -2); (2, -2, 1); (2, -2, -2); (2, -3, 1);
 (2, -3, -2); (-3, -3, 1); (-3, -3, -2); (-2, -3, 1); (-2, -3, -2);
 (0, -3, 1); (0, -3, -2); (2, -3, 1); (2, -3, -2)]
|}];;

[|(p, q, u)
    for q = -2 downto -3 and p in [|2; -3; -2; 0; 2|] and u in [|1; -2|]|];;
[%%expect{|
- : (int * int * int) array =
[|(2, -2, 1); (2, -2, -2); (-3, -2, 1); (-3, -2, -2); (-2, -2, 1);
  (-2, -2, -2); (0, -2, 1); (0, -2, -2); (2, -2, 1); (2, -2, -2); (2, -3, 1);
  (2, -3, -2); (-3, -3, 1); (-3, -3, -2); (-2, -3, 1); (-2, -3, -2);
  (0, -3, 1); (0, -3, -2); (2, -3, 1); (2, -3, -2)|]
|}];;

[:(p, q, u)
    for q = -2 downto -3 and p in [:2; -3; -2; 0; 2:] and u in [:1; -2:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(2, -2, 1); (2, -2, -2); (-3, -2, 1); (-3, -2, -2); (-2, -2, 1);
  (-2, -2, -2); (0, -2, 1); (0, -2, -2); (2, -2, 1); (2, -2, -2); (2, -3, 1);
  (2, -3, -2); (-3, -3, 1); (-3, -3, -2); (-2, -3, 1); (-2, -3, -2);
  (0, -3, 1); (0, -3, -2); (2, -3, 1); (2, -3, -2):]
|}];;

[(c, m, q, v, w)
   for m = 1 to 3
   for q = -2 downto 1
   for v = m to -2 and c = 2 downto -3
   for w = c to -3
   when abs c mod 2 = 0];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(c, m, q, v, w)
    for m = 1 to 3
    for q = -2 downto 1
    for v = m to -2 and c = 2 downto -3
    for w = c to -3
    when abs c mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(c, m, q, v, w)
    for m = 1 to 3
    for q = -2 downto 1
    for v = m to -2 and c = 2 downto -3
    for w = c to -3
    when abs c mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(f, k, l, r, v, z)
   for v = -1 to 2
   for f in [] and z = -2 to 0 and r = -3 downto -3 and l = 0 to 1
   for k in [1; -3; 2; 3; 0]];;
[%%expect{|
- : ('a * int * int * int * int * int) list = []
|}];;

[|(f, k, l, r, v, z)
    for v = -1 to 2
    for f in [||] and z = -2 to 0 and r = -3 downto -3 and l = 0 to 1
    for k in [|1; -3; 2; 3; 0|]|];;
[%%expect{|
- : ('_weak35 * int * int * int * int * int) array = [||]
|}];;

[:(f, k, l, r, v, z)
    for v = -1 to 2
    for f in [::] and z = -2 to 0 and r = -3 downto -3 and l = 0 to 1
    for k in [:1; -3; 2; 3; 0:]:];;
[%%expect{|
- : ('a * int * int * int * int * int) iarray = [::]
|}];;

[(b, x) for x = 3 downto -3 and b in [-1; 1]];;
[%%expect{|
- : (int * int) list =
[(-1, 3); (1, 3); (-1, 2); (1, 2); (-1, 1); (1, 1); (-1, 0); (1, 0);
 (-1, -1); (1, -1); (-1, -2); (1, -2); (-1, -3); (1, -3)]
|}];;

[|(b, x) for x = 3 downto -3 and b in [|-1; 1|]|];;
[%%expect{|
- : (int * int) array =
[|(-1, 3); (1, 3); (-1, 2); (1, 2); (-1, 1); (1, 1); (-1, 0); (1, 0);
  (-1, -1); (1, -1); (-1, -2); (1, -2); (-1, -3); (1, -3)|]
|}];;

[:(b, x) for x = 3 downto -3 and b in [:-1; 1:]:];;
[%%expect{|
- : (int * int) iarray =
[:(-1, 3); (1, 3); (-1, 2); (1, 2); (-1, 1); (1, 1); (-1, 0); (1, 0);
  (-1, -1); (1, -1); (-1, -2); (1, -2); (-1, -3); (1, -3):]
|}];;

[(d, e) for d = 1 downto 3 and e = 3 downto -2 and _ in []];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(d, e) for d = 1 downto 3 and e = 3 downto -2 and _ in [||]|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(d, e) for d = 1 downto 3 and e = 3 downto -2 and _ in [::]:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(i, o, s, t)
   for o in [2; 0; -1; 2; 2] and t in [3] and s in [2; -2; 0; 1; -3]
   when t > 0
   for i in [-3]];;
[%%expect{|
- : (int * int * int * int) list =
[(-3, 2, 2, 3); (-3, 2, -2, 3); (-3, 2, 0, 3); (-3, 2, 1, 3); (-3, 2, -3, 3);
 (-3, 0, 2, 3); (-3, 0, -2, 3); (-3, 0, 0, 3); (-3, 0, 1, 3); (-3, 0, -3, 3);
 (-3, -1, 2, 3); (-3, -1, -2, 3); (-3, -1, 0, 3); (-3, -1, 1, 3);
 (-3, -1, -3, 3); (-3, 2, 2, 3); (-3, 2, -2, 3); (-3, 2, 0, 3);
 (-3, 2, 1, 3); (-3, 2, -3, 3); (-3, 2, 2, 3); (-3, 2, -2, 3); (-3, 2, 0, 3);
 (-3, 2, 1, 3); (-3, 2, -3, 3)]
|}];;

[|(i, o, s, t)
    for o in [|2; 0; -1; 2; 2|] and t in [|3|] and s in [|2; -2; 0; 1; -3|]
    when t > 0
    for i in [|-3|]|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-3, 2, 2, 3); (-3, 2, -2, 3); (-3, 2, 0, 3); (-3, 2, 1, 3);
  (-3, 2, -3, 3); (-3, 0, 2, 3); (-3, 0, -2, 3); (-3, 0, 0, 3);
  (-3, 0, 1, 3); (-3, 0, -3, 3); (-3, -1, 2, 3); (-3, -1, -2, 3);
  (-3, -1, 0, 3); (-3, -1, 1, 3); (-3, -1, -3, 3); (-3, 2, 2, 3);
  (-3, 2, -2, 3); (-3, 2, 0, 3); (-3, 2, 1, 3); (-3, 2, -3, 3);
  (-3, 2, 2, 3); (-3, 2, -2, 3); (-3, 2, 0, 3); (-3, 2, 1, 3);
  (-3, 2, -3, 3)|]
|}];;

[:(i, o, s, t)
    for o in [:2; 0; -1; 2; 2:] and t in [:3:] and s in [:2; -2; 0; 1; -3:]
    when t > 0
    for i in [:-3:]:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-3, 2, 2, 3); (-3, 2, -2, 3); (-3, 2, 0, 3); (-3, 2, 1, 3);
  (-3, 2, -3, 3); (-3, 0, 2, 3); (-3, 0, -2, 3); (-3, 0, 0, 3);
  (-3, 0, 1, 3); (-3, 0, -3, 3); (-3, -1, 2, 3); (-3, -1, -2, 3);
  (-3, -1, 0, 3); (-3, -1, 1, 3); (-3, -1, -3, 3); (-3, 2, 2, 3);
  (-3, 2, -2, 3); (-3, 2, 0, 3); (-3, 2, 1, 3); (-3, 2, -3, 3);
  (-3, 2, 2, 3); (-3, 2, -2, 3); (-3, 2, 0, 3); (-3, 2, 1, 3);
  (-3, 2, -3, 3):]
|}];;

[i for i = -1 downto 3 when abs i mod 2 = 0];;
[%%expect{|
- : int list = []
|}];;

[|i for i = -1 downto 3 when abs i mod 2 = 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:i for i = -1 downto 3 when abs i mod 2 = 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(a, o) for a in [0; 0; 2; -3; -3; 3; 2] for o = -1 downto -1 when o < 0];;
[%%expect{|
- : (int * int) list =
[(0, -1); (0, -1); (2, -1); (-3, -1); (-3, -1); (3, -1); (2, -1)]
|}];;

[|(a, o) for a in [|0; 0; 2; -3; -3; 3; 2|] for o = -1 downto -1 when o < 0|];;
[%%expect{|
- : (int * int) array =
[|(0, -1); (0, -1); (2, -1); (-3, -1); (-3, -1); (3, -1); (2, -1)|]
|}];;

[:(a, o) for a in [:0; 0; 2; -3; -3; 3; 2:] for o = -1 downto -1 when o < 0:];;
[%%expect{|
- : (int * int) iarray =
[:(0, -1); (0, -1); (2, -1); (-3, -1); (-3, -1); (3, -1); (2, -1):]
|}];;

[(c, l, n, p, v)
   for l in [-3; -3; -2]
   for p in [-1; 0; 2; 2] and n in [2; -1; 3; 1; -2]
   for v = -2 downto 2
   for c in [3; l; 3; 3; 2; 2; 2]];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(c, l, n, p, v)
    for l in [|-3; -3; -2|]
    for p in [|-1; 0; 2; 2|] and n in [|2; -1; 3; 1; -2|]
    for v = -2 downto 2
    for c in [|3; l; 3; 3; 2; 2; 2|]|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(c, l, n, p, v)
    for l in [:-3; -3; -2:]
    for p in [:-1; 0; 2; 2:] and n in [:2; -1; 3; 1; -2:]
    for v = -2 downto 2
    for c in [:3; l; 3; 3; 2; 2; 2:]:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(b, c, f, i, k, m, q, s, t, w, x)
   for x in [0; 1; 3] and c = -1 to 0
   for i = 0 downto -2 and b = -3 downto 0 and w in [-3; 0; -1; 1; 0; -1; x]
   for q in [] and k = 3 downto -1 and f in []
   for s in [] and m = 2 to w and t in [2; 3; -2; 3; 3; 0; 0]];;
[%%expect{|
- : (int * int * 'a * int * int * int * 'b * 'c * int * int * int) list = []
|}];;

[|(b, c, f, i, k, m, q, s, t, w, x)
    for x in [|0; 1; 3|] and c = -1 to 0
    for i = 0 downto -2 and b = -3 downto 0 and w in [|-3; 0; -1; 1; 0; -1; x|]
    for q in [||] and k = 3 downto -1 and f in [||]
    for s in [||] and m = 2 to w and t in [|2; 3; -2; 3; 3; 0; 0|]|];;
[%%expect{|
- : (int * int * '_weak36 * int * int * int * '_weak37 * '_weak38 * int *
     int * int)
    array
= [||]
|}];;

[:(b, c, f, i, k, m, q, s, t, w, x)
    for x in [:0; 1; 3:] and c = -1 to 0
    for i = 0 downto -2 and b = -3 downto 0 and w in [:-3; 0; -1; 1; 0; -1; x:]
    for q in [::] and k = 3 downto -1 and f in [::]
    for s in [::] and m = 2 to w and t in [:2; 3; -2; 3; 3; 0; 0:]:];;
[%%expect{|
- : (int * int * 'a * int * int * int * 'b * 'c * int * int * int) iarray =
[::]
|}];;

[(h, k, n, o, t)
   for o = 0 to 3 and k in [0; -3; 2; 0; 1; 2; 2]
   when abs o mod 2 = 1
   for n = 2 downto 1 and o = 1 downto 3 and t in [-1; 1] and h = 2 downto -1];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(h, r, x)
    for x = 1 downto -1
    and h in [|-1; -2; -3; 3; 2; -3; -2|]
    and r in [|0; -3; 0|]|];;
[%%expect{|
- : (int * int * int) array =
[|(-1, 0, 1); (-1, -3, 1); (-1, 0, 1); (-2, 0, 1); (-2, -3, 1); (-2, 0, 1);
  (-3, 0, 1); (-3, -3, 1); (-3, 0, 1); (3, 0, 1); (3, -3, 1); (3, 0, 1);
  (2, 0, 1); (2, -3, 1); (2, 0, 1); (-3, 0, 1); (-3, -3, 1); (-3, 0, 1);
  (-2, 0, 1); (-2, -3, 1); (-2, 0, 1); (-1, 0, 0); (-1, -3, 0); (-1, 0, 0);
  (-2, 0, 0); (-2, -3, 0); (-2, 0, 0); (-3, 0, 0); (-3, -3, 0); (-3, 0, 0);
  (3, 0, 0); (3, -3, 0); (3, 0, 0); (2, 0, 0); (2, -3, 0); (2, 0, 0);
  (-3, 0, 0); (-3, -3, 0); (-3, 0, 0); (-2, 0, 0); (-2, -3, 0); (-2, 0, 0);
  (-1, 0, -1); (-1, -3, -1); (-1, 0, -1); (-2, 0, -1); (-2, -3, -1);
  (-2, 0, -1); (-3, 0, -1); (-3, -3, -1); (-3, 0, -1); (3, 0, -1);
  (3, -3, -1); (3, 0, -1); (2, 0, -1); (2, -3, -1); (2, 0, -1); (-3, 0, -1);
  (-3, -3, -1); (-3, 0, -1); (-2, 0, -1); (-2, -3, -1); (-2, 0, -1)|]
|}];;

[:(h, r, x)
    for x = 1 downto -1
    and h in [:-1; -2; -3; 3; 2; -3; -2:]
    and r in [:0; -3; 0:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-1, 0, 1); (-1, -3, 1); (-1, 0, 1); (-2, 0, 1); (-2, -3, 1); (-2, 0, 1);
  (-3, 0, 1); (-3, -3, 1); (-3, 0, 1); (3, 0, 1); (3, -3, 1); (3, 0, 1);
  (2, 0, 1); (2, -3, 1); (2, 0, 1); (-3, 0, 1); (-3, -3, 1); (-3, 0, 1);
  (-2, 0, 1); (-2, -3, 1); (-2, 0, 1); (-1, 0, 0); (-1, -3, 0); (-1, 0, 0);
  (-2, 0, 0); (-2, -3, 0); (-2, 0, 0); (-3, 0, 0); (-3, -3, 0); (-3, 0, 0);
  (3, 0, 0); (3, -3, 0); (3, 0, 0); (2, 0, 0); (2, -3, 0); (2, 0, 0);
  (-3, 0, 0); (-3, -3, 0); (-3, 0, 0); (-2, 0, 0); (-2, -3, 0); (-2, 0, 0);
  (-1, 0, -1); (-1, -3, -1); (-1, 0, -1); (-2, 0, -1); (-2, -3, -1);
  (-2, 0, -1); (-3, 0, -1); (-3, -3, -1); (-3, 0, -1); (3, 0, -1);
  (3, -3, -1); (3, 0, -1); (2, 0, -1); (2, -3, -1); (2, 0, -1); (-3, 0, -1);
  (-3, -3, -1); (-3, 0, -1); (-2, 0, -1); (-2, -3, -1); (-2, 0, -1):]
|}];;

[(p, y, z) for z in [0; 0; 1; 2] and y = 3 to 1 and p = 3 downto 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(p, y, z) for z in [|0; 0; 1; 2|] and y = 3 to 1 and p = 3 downto 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(p, y, z) for z in [:0; 0; 1; 2:] and y = 3 to 1 and p = 3 downto 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(q, s) for q = 1 downto -2 and s = -2 downto 2 when q <> 0];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(q, s) for q = 1 downto -2 and s = -2 downto 2 when q <> 0|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(q, s) for q = 1 downto -2 and s = -2 downto 2 when q <> 0:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(c, u) for c in [-3] and u = -2 downto 0];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(c, u) for c in [|-3|] and u = -2 downto 0|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(c, u) for c in [:-3:] and u = -2 downto 0:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(f, m, n)
   for n in [1; -3; -1; 3]
   when abs n mod 2 = 1
   when abs n mod 2 = 0
   for f = 1 downto -2
   for m = -3 downto 1];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(f, m, n)
    for n in [|1; -3; -1; 3|]
    when abs n mod 2 = 1
    when abs n mod 2 = 0
    for f = 1 downto -2
    for m = -3 downto 1|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(f, m, n)
    for n in [:1; -3; -1; 3:]
    when abs n mod 2 = 1
    when abs n mod 2 = 0
    for f = 1 downto -2
    for m = -3 downto 1:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(d, f, j, n, o, y, z)
   for n = 0 to 2 and o in [-2; -2]
   for d in [-2; -2; -3; 0; -2] and _ = 1 downto -2
   for j = 0 downto -2
   for j in [0; 0; 2; n] and f = 3 to 2
   for y in [-2; 1; -1; -2; -1; 0] and z in [0; -1; -3]];;
[%%expect{|
Lines 1-6, characters 0-56:
1 | [(d, f, j, n, o, y, z)
2 |    for n = 0 to 2 and o in [-2; -2]
3 |    for d in [-2; -2; -3; 0; -2] and _ = 1 downto -2
4 |    for j = 0 downto -2
5 |    for j in [0; 0; 2; n] and f = 3 to 2
6 |    for y in [-2; 1; -1; -2; -1; 0] and z in [0; -1; -3]]..
Warning 26 [unused-var]: unused variable j.

- : (int * int * int * int * int * int * int) list = []
|}];;

[|(d, f, j, n, o, y, z)
    for n = 0 to 2 and o in [|-2; -2|]
    for d in [|-2; -2; -3; 0; -2|] and _ = 1 downto -2
    for j = 0 downto -2
    for j in [|0; 0; 2; n|] and f = 3 to 2
    for y in [|-2; 1; -1; -2; -1; 0|] and z in [|0; -1; -3|]|];;
[%%expect{|
Lines 1-6, characters 0-62:
1 | [|(d, f, j, n, o, y, z)
2 |     for n = 0 to 2 and o in [|-2; -2|]
3 |     for d in [|-2; -2; -3; 0; -2|] and _ = 1 downto -2
4 |     for j = 0 downto -2
5 |     for j in [|0; 0; 2; n|] and f = 3 to 2
6 |     for y in [|-2; 1; -1; -2; -1; 0|] and z in [|0; -1; -3|]|]..
Warning 26 [unused-var]: unused variable j.

- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(d, f, j, n, o, y, z)
    for n = 0 to 2 and o in [:-2; -2:]
    for d in [:-2; -2; -3; 0; -2:] and _ = 1 downto -2
    for j = 0 downto -2
    for j in [:0; 0; 2; n:] and f = 3 to 2
    for y in [:-2; 1; -1; -2; -1; 0:] and z in [:0; -1; -3:]:];;
[%%expect{|
Lines 1-6, characters 0-62:
1 | [:(d, f, j, n, o, y, z)
2 |     for n = 0 to 2 and o in [:-2; -2:]
3 |     for d in [:-2; -2; -3; 0; -2:] and _ = 1 downto -2
4 |     for j = 0 downto -2
5 |     for j in [:0; 0; 2; n:] and f = 3 to 2
6 |     for y in [:-2; 1; -1; -2; -1; 0:] and z in [:0; -1; -3:]:]..
Warning 26 [unused-var]: unused variable j.

- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(m, q, t, v)
   for q in [1; -3; -3]
   when q <> 0
   for v in [1; -1; 1; 3; -1; q; -3] and m = q to -3 and t = 3 downto 2];;
[%%expect{|
- : (int * int * int * int) list =
[(-3, -3, 3, 1); (-3, -3, 2, 1); (-3, -3, 3, -1); (-3, -3, 2, -1);
 (-3, -3, 3, 1); (-3, -3, 2, 1); (-3, -3, 3, 3); (-3, -3, 2, 3);
 (-3, -3, 3, -1); (-3, -3, 2, -1); (-3, -3, 3, -3); (-3, -3, 2, -3);
 (-3, -3, 3, -3); (-3, -3, 2, -3); (-3, -3, 3, 1); (-3, -3, 2, 1);
 (-3, -3, 3, -1); (-3, -3, 2, -1); (-3, -3, 3, 1); (-3, -3, 2, 1);
 (-3, -3, 3, 3); (-3, -3, 2, 3); (-3, -3, 3, -1); (-3, -3, 2, -1);
 (-3, -3, 3, -3); (-3, -3, 2, -3); (-3, -3, 3, -3); (-3, -3, 2, -3)]
|}];;

[|(m, q, t, v)
    for q in [|1; -3; -3|]
    when q <> 0
    for v in [|1; -1; 1; 3; -1; q; -3|] and m = q to -3 and t = 3 downto 2|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-3, -3, 3, 1); (-3, -3, 2, 1); (-3, -3, 3, -1); (-3, -3, 2, -1);
  (-3, -3, 3, 1); (-3, -3, 2, 1); (-3, -3, 3, 3); (-3, -3, 2, 3);
  (-3, -3, 3, -1); (-3, -3, 2, -1); (-3, -3, 3, -3); (-3, -3, 2, -3);
  (-3, -3, 3, -3); (-3, -3, 2, -3); (-3, -3, 3, 1); (-3, -3, 2, 1);
  (-3, -3, 3, -1); (-3, -3, 2, -1); (-3, -3, 3, 1); (-3, -3, 2, 1);
  (-3, -3, 3, 3); (-3, -3, 2, 3); (-3, -3, 3, -1); (-3, -3, 2, -1);
  (-3, -3, 3, -3); (-3, -3, 2, -3); (-3, -3, 3, -3); (-3, -3, 2, -3)|]
|}];;

[:(m, q, t, v)
    for q in [:1; -3; -3:]
    when q <> 0
    for v in [:1; -1; 1; 3; -1; q; -3:] and m = q to -3 and t = 3 downto 2:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-3, -3, 3, 1); (-3, -3, 2, 1); (-3, -3, 3, -1); (-3, -3, 2, -1);
  (-3, -3, 3, 1); (-3, -3, 2, 1); (-3, -3, 3, 3); (-3, -3, 2, 3);
  (-3, -3, 3, -1); (-3, -3, 2, -1); (-3, -3, 3, -3); (-3, -3, 2, -3);
  (-3, -3, 3, -3); (-3, -3, 2, -3); (-3, -3, 3, 1); (-3, -3, 2, 1);
  (-3, -3, 3, -1); (-3, -3, 2, -1); (-3, -3, 3, 1); (-3, -3, 2, 1);
  (-3, -3, 3, 3); (-3, -3, 2, 3); (-3, -3, 3, -1); (-3, -3, 2, -1);
  (-3, -3, 3, -3); (-3, -3, 2, -3); (-3, -3, 3, -3); (-3, -3, 2, -3):]
|}];;

[(f, g, n, x)
   for n in [1; 1] and f in [-2]
   for g = n to 2
   when n <> 0
   for x in []
   when f > 0];;
[%%expect{|
- : (int * int * int * 'a) list = []
|}];;

[|(f, g, n, x)
    for n in [|1; 1|] and f in [|-2|]
    for g = n to 2
    when n <> 0
    for x in [||]
    when f > 0|];;
[%%expect{|
- : (int * int * int * '_weak39) array = [||]
|}];;

[:(f, g, n, x)
    for n in [:1; 1:] and f in [:-2:]
    for g = n to 2
    when n <> 0
    for x in [::]
    when f > 0:];;
[%%expect{|
- : (int * int * int * 'a) iarray = [::]
|}];;

[(d, u, v) for d in [3; 0; 0; -3; 1] and u in [-3; -1; 0] and v in [0; 1]];;
[%%expect{|
- : (int * int * int) list =
[(3, -3, 0); (3, -3, 1); (3, -1, 0); (3, -1, 1); (3, 0, 0); (3, 0, 1);
 (0, -3, 0); (0, -3, 1); (0, -1, 0); (0, -1, 1); (0, 0, 0); (0, 0, 1);
 (0, -3, 0); (0, -3, 1); (0, -1, 0); (0, -1, 1); (0, 0, 0); (0, 0, 1);
 (-3, -3, 0); (-3, -3, 1); (-3, -1, 0); (-3, -1, 1); (-3, 0, 0); (-3, 0, 1);
 (1, -3, 0); (1, -3, 1); (1, -1, 0); (1, -1, 1); (1, 0, 0); (1, 0, 1)]
|}];;

[|(d, u, v)
    for d in [|3; 0; 0; -3; 1|] and u in [|-3; -1; 0|] and v in [|0; 1|]|];;
[%%expect{|
- : (int * int * int) array =
[|(3, -3, 0); (3, -3, 1); (3, -1, 0); (3, -1, 1); (3, 0, 0); (3, 0, 1);
  (0, -3, 0); (0, -3, 1); (0, -1, 0); (0, -1, 1); (0, 0, 0); (0, 0, 1);
  (0, -3, 0); (0, -3, 1); (0, -1, 0); (0, -1, 1); (0, 0, 0); (0, 0, 1);
  (-3, -3, 0); (-3, -3, 1); (-3, -1, 0); (-3, -1, 1); (-3, 0, 0); (-3, 0, 1);
  (1, -3, 0); (1, -3, 1); (1, -1, 0); (1, -1, 1); (1, 0, 0); (1, 0, 1)|]
|}];;

[:(d, u, v)
    for d in [:3; 0; 0; -3; 1:] and u in [:-3; -1; 0:] and v in [:0; 1:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(3, -3, 0); (3, -3, 1); (3, -1, 0); (3, -1, 1); (3, 0, 0); (3, 0, 1);
  (0, -3, 0); (0, -3, 1); (0, -1, 0); (0, -1, 1); (0, 0, 0); (0, 0, 1);
  (0, -3, 0); (0, -3, 1); (0, -1, 0); (0, -1, 1); (0, 0, 0); (0, 0, 1);
  (-3, -3, 0); (-3, -3, 1); (-3, -1, 0); (-3, -1, 1); (-3, 0, 0); (-3, 0, 1);
  (1, -3, 0); (1, -3, 1); (1, -1, 0); (1, -1, 1); (1, 0, 0); (1, 0, 1):]
|}];;

[(k, t)
   for t in [-1] and k = -1 downto -3
   when abs t mod 2 = 0
   when abs t mod 2 = 1];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(k, t)
    for t in [|-1|] and k = -1 downto -3
    when abs t mod 2 = 0
    when abs t mod 2 = 1|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(k, t)
    for t in [:-1:] and k = -1 downto -3
    when abs t mod 2 = 0
    when abs t mod 2 = 1:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(a, c, i, m, n, o, q, w)
   for o in [1; -2; -2; -1; 0; -3; 1] and n in [1; -1] and a in [-3; 3]
   for q in [2; n; 0; 2; 2; -2] and w in [2; -2]
   for i = 1 to 0 and c = -1 downto 0 and m = n downto -2];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) list = []
|}];;

[|(a, c, i, m, n, o, q, w)
    for o in [|1; -2; -2; -1; 0; -3; 1|] and n in [|1; -1|] and a in [|-3; 3|]
    for q in [|2; n; 0; 2; 2; -2|] and w in [|2; -2|]
    for i = 1 to 0 and c = -1 downto 0 and m = n downto -2|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, c, i, m, n, o, q, w)
    for o in [:1; -2; -2; -1; 0; -3; 1:] and n in [:1; -1:] and a in [:-3; 3:]
    for q in [:2; n; 0; 2; 2; -2:] and w in [:2; -2:]
    for i = 1 to 0 and c = -1 downto 0 and m = n downto -2:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(e, j, s)
   for j = -1 to 3
   for e in [-1; -3; 3; 1; j]
   for _ = 0 downto 2
   for e in [-1; -3; 0; -2; 0; 3] and j = 0 to e
   for s = 1 downto 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(e, j, s)
    for j = -1 to 3
    for e in [|-1; -3; 3; 1; j|]
    for _ = 0 downto 2
    for e in [|-1; -3; 0; -2; 0; 3|] and j = 0 to e
    for s = 1 downto 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(e, j, s)
    for j = -1 to 3
    for e in [:-1; -3; 3; 1; j:]
    for _ = 0 downto 2
    for e in [:-1; -3; 0; -2; 0; 3:] and j = 0 to e
    for s = 1 downto 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(c, e, u, z)
   for e in [2; 2]
   for c = 3 to -2
   for u = -1 to 2
   for c in [2; 2; 1; -2; -1; -1; -3]
   for z = 1 downto 1];;
[%%expect{|
Lines 1-6, characters 0-22:
1 | [(c, e, u, z)
2 |    for e in [2; 2]
3 |    for c = 3 to -2
4 |    for u = -1 to 2
5 |    for c in [2; 2; 1; -2; -1; -1; -3]
6 |    for z = 1 downto 1]..
Warning 26 [unused-var]: unused variable c.

- : (int * int * int * int) list = []
|}];;

[|(c, e, u, z)
    for e in [|2; 2|]
    for c = 3 to -2
    for u = -1 to 2
    for c in [|2; 2; 1; -2; -1; -1; -3|]
    for z = 1 downto 1|];;
[%%expect{|
Lines 1-6, characters 0-24:
1 | [|(c, e, u, z)
2 |     for e in [|2; 2|]
3 |     for c = 3 to -2
4 |     for u = -1 to 2
5 |     for c in [|2; 2; 1; -2; -1; -1; -3|]
6 |     for z = 1 downto 1|]..
Warning 26 [unused-var]: unused variable c.

- : (int * int * int * int) array = [||]
|}];;

[:(c, e, u, z)
    for e in [:2; 2:]
    for c = 3 to -2
    for u = -1 to 2
    for c in [:2; 2; 1; -2; -1; -1; -3:]
    for z = 1 downto 1:];;
[%%expect{|
Lines 1-6, characters 0-24:
1 | [:(c, e, u, z)
2 |     for e in [:2; 2:]
3 |     for c = 3 to -2
4 |     for u = -1 to 2
5 |     for c in [:2; 2; 1; -2; -1; -1; -3:]
6 |     for z = 1 downto 1:]..
Warning 26 [unused-var]: unused variable c.

- : (int * int * int * int) iarray = [::]
|}];;

[(b, e, f, o, r, u, v, w)
   for e in [0; -1; 2; 3; 2; 2]
   and w in [-3; 2; -1; -1; 2; -3; -3]
   and v in [0; -3; 0; -3; 2; 2; 0]
   and r in [-1; -1; 0; 0]
   for b = -1 downto e
   for o = -3 downto 0
   and r = -2 downto v
   and u = 2 downto 1
   and f in [1; -2; 1; -1]];;
[%%expect{|
Line 5, characters 7-8:
5 |    and r in [-1; -1; 0; 0]
           ^
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int * int * int * int * int) list = []
|}];;

[|(b, e, f, o, r, u, v, w)
    for e in [|0; -1; 2; 3; 2; 2|]
    and w in [|-3; 2; -1; -1; 2; -3; -3|]
    and v in [|0; -3; 0; -3; 2; 2; 0|]
    and r in [|-1; -1; 0; 0|]
    for b = -1 downto e
    for o = -3 downto 0
    and r = -2 downto v
    and u = 2 downto 1
    and f in [|1; -2; 1; -1|]|];;
[%%expect{|
Line 5, characters 8-9:
5 |     and r in [|-1; -1; 0; 0|]
            ^
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(b, e, f, o, r, u, v, w)
    for e in [:0; -1; 2; 3; 2; 2:]
    and w in [:-3; 2; -1; -1; 2; -3; -3:]
    and v in [:0; -3; 0; -3; 2; 2; 0:]
    and r in [:-1; -1; 0; 0:]
    for b = -1 downto e
    for o = -3 downto 0
    and r = -2 downto v
    and u = 2 downto 1
    and f in [:1; -2; 1; -1:]:];;
[%%expect{|
Line 5, characters 8-9:
5 |     and r in [:-1; -1; 0; 0:]
            ^
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(f, w, x)
   for _ in [1; 3] and x in [2]
   for w = -3 to -1 and x = 3 to 1
   for x = -3 to x
   when w < 0
   for f = 3 to -2 and _ = 2 downto 3];;
[%%expect{|
Line 2, characters 23-24:
2 |    for _ in [1; 3] and x in [2]
                           ^
Warning 26 [unused-var]: unused variable x.

- : (int * int * int) list = []
|}];;

[|(f, w, x)
    for _ in [|1; 3|] and x in [|2|]
    for w = -3 to -1 and x = 3 to 1
    for x = -3 to x
    when w < 0
    for f = 3 to -2 and _ = 2 downto 3|];;
[%%expect{|
Line 2, characters 26-27:
2 |     for _ in [|1; 3|] and x in [|2|]
                              ^
Warning 26 [unused-var]: unused variable x.

- : (int * int * int) array = [||]
|}];;

[:(f, w, x)
    for _ in [:1; 3:] and x in [:2:]
    for w = -3 to -1 and x = 3 to 1
    for x = -3 to x
    when w < 0
    for f = 3 to -2 and _ = 2 downto 3:];;
[%%expect{|
Line 2, characters 26-27:
2 |     for _ in [:1; 3:] and x in [:2:]
                              ^
Warning 26 [unused-var]: unused variable x.

- : (int * int * int) iarray = [::]
|}];;

[(r, x, y)
   for r = -1 to 0
   when r > 0
   for y = 1 to 3
   for x in [0; 3; 2; y; 1; 3]
   when abs y mod 2 = 1];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(r, x, y)
    for r = -1 to 0
    when r > 0
    for y = 1 to 3
    for x in [|0; 3; 2; y; 1; 3|]
    when abs y mod 2 = 1|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(r, x, y)
    for r = -1 to 0
    when r > 0
    for y = 1 to 3
    for x in [:0; 3; 2; y; 1; 3:]
    when abs y mod 2 = 1:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(c, g, j, m, t, v, y, z)
   for v = 2 downto -1 and t in [-3; 1; -2; 0; -3; 3] and c = -3 downto -3
   for m in [2; -3; -3] and g = 1 downto 3 and j = 0 downto 2
   for j in [-2; 1; -3] and z in [t; 2; -3; -2]
   for y = 3 downto 0];;
[%%expect{|
Lines 1-5, characters 0-22:
1 | [(c, g, j, m, t, v, y, z)
2 |    for v = 2 downto -1 and t in [-3; 1; -2; 0; -3; 3] and c = -3 downto -3
3 |    for m in [2; -3; -3] and g = 1 downto 3 and j = 0 downto 2
4 |    for j in [-2; 1; -3] and z in [t; 2; -3; -2]
5 |    for y = 3 downto 0]..
Warning 26 [unused-var]: unused variable j.

- : (int * int * int * int * int * int * int * int) list = []
|}];;

[|(c, g, j, m, t, v, y, z)
    for v = 2 downto -1 and t in [|-3; 1; -2; 0; -3; 3|] and c = -3 downto -3
    for m in [|2; -3; -3|] and g = 1 downto 3 and j = 0 downto 2
    for j in [|-2; 1; -3|] and z in [|t; 2; -3; -2|]
    for y = 3 downto 0|];;
[%%expect{|
Lines 1-5, characters 0-24:
1 | [|(c, g, j, m, t, v, y, z)
2 |     for v = 2 downto -1 and t in [|-3; 1; -2; 0; -3; 3|] and c = -3 downto -3
3 |     for m in [|2; -3; -3|] and g = 1 downto 3 and j = 0 downto 2
4 |     for j in [|-2; 1; -3|] and z in [|t; 2; -3; -2|]
5 |     for y = 3 downto 0|]..
Warning 26 [unused-var]: unused variable j.

- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(c, g, j, m, t, v, y, z)
    for v = 2 downto -1 and t in [:-3; 1; -2; 0; -3; 3:] and c = -3 downto -3
    for m in [:2; -3; -3:] and g = 1 downto 3 and j = 0 downto 2
    for j in [:-2; 1; -3:] and z in [:t; 2; -3; -2:]
    for y = 3 downto 0:];;
[%%expect{|
Lines 1-5, characters 0-24:
1 | [:(c, g, j, m, t, v, y, z)
2 |     for v = 2 downto -1 and t in [:-3; 1; -2; 0; -3; 3:] and c = -3 downto -3
3 |     for m in [:2; -3; -3:] and g = 1 downto 3 and j = 0 downto 2
4 |     for j in [:-2; 1; -3:] and z in [:t; 2; -3; -2:]
5 |     for y = 3 downto 0:]..
Warning 26 [unused-var]: unused variable j.

- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(e, p, r, v, x, y)
   for r in [3; 0; -3]
   for e = 3 downto -3
   for v = 2 downto -2 and x in []
   for p in [-2; 0; 3; 0; 1; 2; -3]
   for y in [-1; 2; -2; 2; -3]];;
[%%expect{|
- : (int * int * int * int * 'a * int) list = []
|}];;

[|(e, p, r, v, x, y)
    for r in [|3; 0; -3|]
    for e = 3 downto -3
    for v = 2 downto -2 and x in [||]
    for p in [|-2; 0; 3; 0; 1; 2; -3|]
    for y in [|-1; 2; -2; 2; -3|]|];;
[%%expect{|
- : (int * int * int * int * '_weak40 * int) array = [||]
|}];;

[:(e, p, r, v, x, y)
    for r in [:3; 0; -3:]
    for e = 3 downto -3
    for v = 2 downto -2 and x in [::]
    for p in [:-2; 0; 3; 0; 1; 2; -3:]
    for y in [:-1; 2; -2; 2; -3:]:];;
[%%expect{|
- : (int * int * int * int * 'a * int) iarray = [::]
|}];;

[(b, c, k, l, u)
   for c in [-3; -2; 1; -2]
   for u in [-1; -1; 1; 3; -3] and k = -3 to -3 and b = -2 to -1 and l in []
   when c <> 0];;
[%%expect{|
- : (int * int * int * 'a * int) list = []
|}];;

[|(n, v) for v in [|-2; 1; 3|] and n in [||] when n < 0|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(n, v) for v in [:-2; 1; 3:] and n in [::] when n < 0:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(b, z) for b in [-1] when abs b mod 2 = 1 for z = 1 to 0 and b = 2 to 1];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(b, z) for b in [|-1|] when abs b mod 2 = 1 for z = 1 to 0 and b = 2 to 1|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(b, z) for b in [:-1:] when abs b mod 2 = 1 for z = 1 to 0 and b = 2 to 1:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(n, o) for o = -1 to 1 and n in [0; -3; 2; 2]];;
[%%expect{|
- : (int * int) list =
[(0, -1); (-3, -1); (2, -1); (2, -1); (0, 0); (-3, 0); (2, 0); (2, 0);
 (0, 1); (-3, 1); (2, 1); (2, 1)]
|}];;

[|(n, o) for o = -1 to 1 and n in [|0; -3; 2; 2|]|];;
[%%expect{|
- : (int * int) array =
[|(0, -1); (-3, -1); (2, -1); (2, -1); (0, 0); (-3, 0); (2, 0); (2, 0);
  (0, 1); (-3, 1); (2, 1); (2, 1)|]
|}];;

[:(n, o) for o = -1 to 1 and n in [:0; -3; 2; 2:]:];;
[%%expect{|
- : (int * int) iarray =
[:(0, -1); (-3, -1); (2, -1); (2, -1); (0, 0); (-3, 0); (2, 0); (2, 0);
  (0, 1); (-3, 1); (2, 1); (2, 1):]
|}];;

[(b, f, i, l, r, z)
   for r in [1] and f in [-2] and i in [0; -3] and b in [0]
   for z = 1 to f and l in [-2]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(b, f, i, l, r, z)
    for r in [|1|] and f in [|-2|] and i in [|0; -3|] and b in [|0|]
    for z = 1 to f and l in [|-2|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(b, f, i, l, r, z)
    for r in [:1:] and f in [:-2:] and i in [:0; -3:] and b in [:0:]
    for z = 1 to f and l in [:-2:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(h, t, y)
   for y in [-3; -3]
   when y < 0
   when abs y mod 2 = 1
   for t = 0 to -1 and h in [-2; -1; 0]];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(h, t, y)
    for y in [|-3; -3|]
    when y < 0
    when abs y mod 2 = 1
    for t = 0 to -1 and h in [|-2; -1; 0|]|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(h, t, y)
    for y in [:-3; -3:]
    when y < 0
    when abs y mod 2 = 1
    for t = 0 to -1 and h in [:-2; -1; 0:]:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(a, l) for a = -1 downto 3 and l in [-1; 1; 3]];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(a, l) for a = -1 downto 3 and l in [|-1; 1; 3|]|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(a, l) for a = -1 downto 3 and l in [:-1; 1; 3:]:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(e, n, r) for r = 0 downto -2 and e in [1; 1; -2] and n in [0; 2; 0; -2; 1]];;
[%%expect{|
- : (int * int * int) list =
[(1, 0, 0); (1, 2, 0); (1, 0, 0); (1, -2, 0); (1, 1, 0); (1, 0, 0);
 (1, 2, 0); (1, 0, 0); (1, -2, 0); (1, 1, 0); (-2, 0, 0); (-2, 2, 0);
 (-2, 0, 0); (-2, -2, 0); (-2, 1, 0); (1, 0, -1); (1, 2, -1); (1, 0, -1);
 (1, -2, -1); (1, 1, -1); (1, 0, -1); (1, 2, -1); (1, 0, -1); (1, -2, -1);
 (1, 1, -1); (-2, 0, -1); (-2, 2, -1); (-2, 0, -1); (-2, -2, -1);
 (-2, 1, -1); (1, 0, -2); (1, 2, -2); (1, 0, -2); (1, -2, -2); (1, 1, -2);
 (1, 0, -2); (1, 2, -2); (1, 0, -2); (1, -2, -2); (1, 1, -2); (-2, 0, -2);
 (-2, 2, -2); (-2, 0, -2); (-2, -2, -2); (-2, 1, -2)]
|}];;

[|(e, n, r)
    for r = 0 downto -2 and e in [|1; 1; -2|] and n in [|0; 2; 0; -2; 1|]|];;
[%%expect{|
- : (int * int * int) array =
[|(1, 0, 0); (1, 2, 0); (1, 0, 0); (1, -2, 0); (1, 1, 0); (1, 0, 0);
  (1, 2, 0); (1, 0, 0); (1, -2, 0); (1, 1, 0); (-2, 0, 0); (-2, 2, 0);
  (-2, 0, 0); (-2, -2, 0); (-2, 1, 0); (1, 0, -1); (1, 2, -1); (1, 0, -1);
  (1, -2, -1); (1, 1, -1); (1, 0, -1); (1, 2, -1); (1, 0, -1); (1, -2, -1);
  (1, 1, -1); (-2, 0, -1); (-2, 2, -1); (-2, 0, -1); (-2, -2, -1);
  (-2, 1, -1); (1, 0, -2); (1, 2, -2); (1, 0, -2); (1, -2, -2); (1, 1, -2);
  (1, 0, -2); (1, 2, -2); (1, 0, -2); (1, -2, -2); (1, 1, -2); (-2, 0, -2);
  (-2, 2, -2); (-2, 0, -2); (-2, -2, -2); (-2, 1, -2)|]
|}];;

[:(e, n, r)
    for r = 0 downto -2 and e in [:1; 1; -2:] and n in [:0; 2; 0; -2; 1:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(1, 0, 0); (1, 2, 0); (1, 0, 0); (1, -2, 0); (1, 1, 0); (1, 0, 0);
  (1, 2, 0); (1, 0, 0); (1, -2, 0); (1, 1, 0); (-2, 0, 0); (-2, 2, 0);
  (-2, 0, 0); (-2, -2, 0); (-2, 1, 0); (1, 0, -1); (1, 2, -1); (1, 0, -1);
  (1, -2, -1); (1, 1, -1); (1, 0, -1); (1, 2, -1); (1, 0, -1); (1, -2, -1);
  (1, 1, -1); (-2, 0, -1); (-2, 2, -1); (-2, 0, -1); (-2, -2, -1);
  (-2, 1, -1); (1, 0, -2); (1, 2, -2); (1, 0, -2); (1, -2, -2); (1, 1, -2);
  (1, 0, -2); (1, 2, -2); (1, 0, -2); (1, -2, -2); (1, 1, -2); (-2, 0, -2);
  (-2, 2, -2); (-2, 0, -2); (-2, -2, -2); (-2, 1, -2):]
|}];;

[(h, s, w) for w = 2 to -3 and h = -1 to 3 and s = -2 downto 3];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(h, s, w) for w = 2 to -3 and h = -1 to 3 and s = -2 downto 3|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(h, s, w) for w = 2 to -3 and h = -1 to 3 and s = -2 downto 3:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(a, h, o, r, t, y)
   for o in [3] and y in [-2; 3]
   for a in [3; -1; -1] and r = 2 downto 0
   for t in [3; 2; -2; a] and h in [3; -1]
   when r < 0
   for o in [-3; 1; 3; 2; 0; -1; -1]];;
[%%expect{|
Line 2, characters 7-8:
2 |    for o in [3] and y in [-2; 3]
           ^
Warning 26 [unused-var]: unused variable o.

- : (int * int * int * int * int * int) list = []
|}];;

[|(a, h, o, r, t, y)
    for o in [|3|] and y in [|-2; 3|]
    for a in [|3; -1; -1|] and r = 2 downto 0
    for t in [|3; 2; -2; a|] and h in [|3; -1|]
    when r < 0
    for o in [|-3; 1; 3; 2; 0; -1; -1|]|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for o in [|3|] and y in [|-2; 3|]
            ^
Warning 26 [unused-var]: unused variable o.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, h, o, r, t, y)
    for o in [:3:] and y in [:-2; 3:]
    for a in [:3; -1; -1:] and r = 2 downto 0
    for t in [:3; 2; -2; a:] and h in [:3; -1:]
    when r < 0
    for o in [:-3; 1; 3; 2; 0; -1; -1:]:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for o in [:3:] and y in [:-2; 3:]
            ^
Warning 26 [unused-var]: unused variable o.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(d, h, i, t, v, w, z)
   for z in [2; 3; 3; 2; 0; -1; -3] and h in [0; -1] and t in [2; -1]
   for i = 2 downto -3 and w = -2 to -2 and v = -1 to -2 and d = 3 downto t];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(d, h, i, t, v, w, z)
    for z in [|2; 3; 3; 2; 0; -1; -3|] and h in [|0; -1|] and t in [|2; -1|]
    for i = 2 downto -3 and w = -2 to -2 and v = -1 to -2 and d = 3 downto t|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(d, h, i, t, v, w, z)
    for z in [:2; 3; 3; 2; 0; -1; -3:] and h in [:0; -1:] and t in [:2; -1:]
    for i = 2 downto -3 and w = -2 to -2 and v = -1 to -2 and d = 3 downto t:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(a, c, m, q, v, z)
   for q in [-1; -1; -2; 3; -3; -1] and a in [1]
   for z = 0 to -2
   for m in [-3; 2; 1; -3; 2; -3; 3]
   when abs z mod 2 = 0
   for v = -2 downto 0 and c = 1 to -2];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(a, c, m, q, v, z)
    for q in [|-1; -1; -2; 3; -3; -1|] and a in [|1|]
    for z = 0 to -2
    for m in [|-3; 2; 1; -3; 2; -3; 3|]
    when abs z mod 2 = 0
    for v = -2 downto 0 and c = 1 to -2|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, c, m, q, v, z)
    for q in [:-1; -1; -2; 3; -3; -1:] and a in [:1:]
    for z = 0 to -2
    for m in [:-3; 2; 1; -3; 2; -3; 3:]
    when abs z mod 2 = 0
    for v = -2 downto 0 and c = 1 to -2:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(b, d, i, l, m, o, s, v, y)
   for o = -2 downto -3 and l in [1]
   for v in [3; 3; -1; -3; 1; -1; 0] and b = 1 to -1
   for y in [] and m in [b; -3; -3; o]
   for s = -3 downto 1 and o in [2; -2; v]
   for d = 0 to 0 and i = -2 downto -3];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * 'a) list = []
|}];;

[|(b, d, i, l, m, o, s, v, y)
    for o = -2 downto -3 and l in [|1|]
    for v in [|3; 3; -1; -3; 1; -1; 0|] and b = 1 to -1
    for y in [||] and m in [|b; -3; -3; o|]
    for s = -3 downto 1 and o in [|2; -2; v|]
    for d = 0 to 0 and i = -2 downto -3|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * '_weak41) array = [||]
|}];;

[:(b, d, i, l, m, o, s, v, y)
    for o = -2 downto -3 and l in [:1:]
    for v in [:3; 3; -1; -3; 1; -1; 0:] and b = 1 to -1
    for y in [::] and m in [:b; -3; -3; o:]
    for s = -3 downto 1 and o in [:2; -2; v:]
    for d = 0 to 0 and i = -2 downto -3:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * 'a) iarray = [::]
|}];;

[(a, j, l, q, u, v)
   for j in [-2; -1; -3] and v in [2; 3; -3; 2]
   for j in [j; v; 1; 2; 1; 1; 0] and a in [0]
   for q = -3 downto 0 and l in [2; -1; -3; -3; -1] and u = -3 downto 3];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(a, j, l, q, u, v)
    for j in [|-2; -1; -3|] and v in [|2; 3; -3; 2|]
    for j in [|j; v; 1; 2; 1; 1; 0|] and a in [|0|]
    for q = -3 downto 0 and l in [|2; -1; -3; -3; -1|] and u = -3 downto 3|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, j, l, q, u, v)
    for j in [:-2; -1; -3:] and v in [:2; 3; -3; 2:]
    for j in [:j; v; 1; 2; 1; 1; 0:] and a in [:0:]
    for q = -3 downto 0 and l in [:2; -1; -3; -3; -1:] and u = -3 downto 3:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(a, p, r, t, y)
   for r in [-3; 2; 1; 0; -3; 3; 3]
   for y in [1; 2; 0; -3]
   for y in [2; 1; -2; r; -2] and t in []
   for _ = -3 to -1
   for p in [0; -3] and a in [-3; r; 1; 1]];;
[%%expect{|
Line 3, characters 7-8:
3 |    for y in [1; 2; 0; -3]
           ^
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * 'a * int) list = []
|}];;

[|(a, p, r, t, y)
    for r in [|-3; 2; 1; 0; -3; 3; 3|]
    for y in [|1; 2; 0; -3|]
    for y in [|2; 1; -2; r; -2|] and t in [||]
    for _ = -3 to -1
    for p in [|0; -3|] and a in [|-3; r; 1; 1|]|];;
[%%expect{|
Line 3, characters 8-9:
3 |     for y in [|1; 2; 0; -3|]
            ^
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * '_weak42 * int) array = [||]
|}];;

[:(a, p, r, t, y)
    for r in [:-3; 2; 1; 0; -3; 3; 3:]
    for y in [:1; 2; 0; -3:]
    for y in [:2; 1; -2; r; -2:] and t in [::]
    for _ = -3 to -1
    for p in [:0; -3:] and a in [:-3; r; 1; 1:]:];;
[%%expect{|
Line 3, characters 8-9:
3 |     for y in [:1; 2; 0; -3:]
            ^
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * 'a * int) iarray = [::]
|}];;

[(p, q) for q = 2 downto 3 for p = -2 to q];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(p, q) for q = 2 downto 3 for p = -2 to q|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(p, q) for q = 2 downto 3 for p = -2 to q:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(d, e, j, l)
   for j in [-3] and l in [3; 0; 3]
   when j > 0
   for d = j downto 2
   for e = 0 downto -1];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(d, e, j, l)
    for j in [|-3|] and l in [|3; 0; 3|]
    when j > 0
    for d = j downto 2
    for e = 0 downto -1|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(d, e, j, l)
    for j in [:-3:] and l in [:3; 0; 3:]
    when j > 0
    for d = j downto 2
    for e = 0 downto -1:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(a, g, r)
   for a = -2 downto -2
   when a < 0
   for r in []
   when abs a mod 2 = 1
   for g = r downto 0 and r in [-3; 2; 0]];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, g, r)
    for a = -2 downto -2
    when a < 0
    for r in [||]
    when abs a mod 2 = 1
    for g = r downto 0 and r in [|-3; 2; 0|]|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(a, g, r)
    for a = -2 downto -2
    when a < 0
    for r in [::]
    when abs a mod 2 = 1
    for g = r downto 0 and r in [:-3; 2; 0:]:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(n, q, s) for s = 3 to 0 and q = 2 downto 3 and n = -1 downto 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(n, q, s) for s = 3 to 0 and q = 2 downto 3 and n = -1 downto 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(n, q, s) for s = 3 to 0 and q = 2 downto 3 and n = -1 downto 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(h, p, w)
   for h in [3; 1; 3; 0; -1; 3; -1]
   for w in [1] and p = 2 downto h and h = 1 downto h];;
[%%expect{|
- : (int * int * int) list =
[(1, 2, 1); (1, 1, 1); (1, 2, 1); (0, 2, 1); (1, 1, 1); (0, 1, 1); (1, 0, 1);
 (0, 0, 1); (1, 2, 1); (0, 2, 1); (-1, 2, 1); (1, 1, 1); (0, 1, 1);
 (-1, 1, 1); (1, 0, 1); (0, 0, 1); (-1, 0, 1); (1, -1, 1); (0, -1, 1);
 (-1, -1, 1); (1, 2, 1); (0, 2, 1); (-1, 2, 1); (1, 1, 1); (0, 1, 1);
 (-1, 1, 1); (1, 0, 1); (0, 0, 1); (-1, 0, 1); (1, -1, 1); (0, -1, 1);
 (-1, -1, 1)]
|}];;

[|(h, p, w)
    for h in [|3; 1; 3; 0; -1; 3; -1|]
    for w in [|1|] and p = 2 downto h and h = 1 downto h|];;
[%%expect{|
- : (int * int * int) array =
[|(1, 2, 1); (1, 1, 1); (1, 2, 1); (0, 2, 1); (1, 1, 1); (0, 1, 1);
  (1, 0, 1); (0, 0, 1); (1, 2, 1); (0, 2, 1); (-1, 2, 1); (1, 1, 1);
  (0, 1, 1); (-1, 1, 1); (1, 0, 1); (0, 0, 1); (-1, 0, 1); (1, -1, 1);
  (0, -1, 1); (-1, -1, 1); (1, 2, 1); (0, 2, 1); (-1, 2, 1); (1, 1, 1);
  (0, 1, 1); (-1, 1, 1); (1, 0, 1); (0, 0, 1); (-1, 0, 1); (1, -1, 1);
  (0, -1, 1); (-1, -1, 1)|]
|}];;

[:(h, p, w)
    for h in [:3; 1; 3; 0; -1; 3; -1:]
    for w in [:1:] and p = 2 downto h and h = 1 downto h:];;
[%%expect{|
- : (int * int * int) iarray =
[:(1, 2, 1); (1, 1, 1); (1, 2, 1); (0, 2, 1); (1, 1, 1); (0, 1, 1);
  (1, 0, 1); (0, 0, 1); (1, 2, 1); (0, 2, 1); (-1, 2, 1); (1, 1, 1);
  (0, 1, 1); (-1, 1, 1); (1, 0, 1); (0, 0, 1); (-1, 0, 1); (1, -1, 1);
  (0, -1, 1); (-1, -1, 1); (1, 2, 1); (0, 2, 1); (-1, 2, 1); (1, 1, 1);
  (0, 1, 1); (-1, 1, 1); (1, 0, 1); (0, 0, 1); (-1, 0, 1); (1, -1, 1);
  (0, -1, 1); (-1, -1, 1):]
|}];;

[(k, n, o)
   for k = 3 to 3
   when abs k mod 2 = 1
   for n = -3 downto 0 and o in [3; 0]];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(k, n, o)
    for k = 3 to 3
    when abs k mod 2 = 1
    for n = -3 downto 0 and o in [|3; 0|]|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(k, n, o)
    for k = 3 to 3
    when abs k mod 2 = 1
    for n = -3 downto 0 and o in [:3; 0:]:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[a for a = 2 downto 2 when abs a mod 2 = 0];;
[%%expect{|
- : int list = [2]
|}];;

[|a for a = 2 downto 2 when abs a mod 2 = 0|];;
[%%expect{|
- : int array = [|2|]
|}];;

[:a for a = 2 downto 2 when abs a mod 2 = 0:];;
[%%expect{|
- : int iarray = [:2:]
|}];;

[(f, i, j, n, r, z)
   for i = -2 to 2
   for n = 2 to 2 and z in []
   when abs z mod 2 = 0
   for j = 0 downto 2 and f in [-2; z; 2; -2; 2; -3; -2]
   for r = -3 to -2 and j in []];;
[%%expect{|
Lines 1-6, characters 0-32:
1 | [(f, i, j, n, r, z)
2 |    for i = -2 to 2
3 |    for n = 2 to 2 and z in []
4 |    when abs z mod 2 = 0
5 |    for j = 0 downto 2 and f in [-2; z; 2; -2; 2; -3; -2]
6 |    for r = -3 to -2 and j in []]..
Warning 26 [unused-var]: unused variable j.

- : (int * int * 'a * int * int * int) list = []
|}];;

[|(f, i, j, n, r, z)
    for i = -2 to 2
    for n = 2 to 2 and z in [||]
    when abs z mod 2 = 0
    for j = 0 downto 2 and f in [|-2; z; 2; -2; 2; -3; -2|]
    for r = -3 to -2 and j in [||]|];;
[%%expect{|
Lines 1-6, characters 0-36:
1 | [|(f, i, j, n, r, z)
2 |     for i = -2 to 2
3 |     for n = 2 to 2 and z in [||]
4 |     when abs z mod 2 = 0
5 |     for j = 0 downto 2 and f in [|-2; z; 2; -2; 2; -3; -2|]
6 |     for r = -3 to -2 and j in [||]|]..
Warning 26 [unused-var]: unused variable j.

- : (int * int * '_weak43 * int * int * int) array = [||]
|}];;

[:(f, i, j, n, r, z)
    for i = -2 to 2
    for n = 2 to 2 and z in [::]
    when abs z mod 2 = 0
    for j = 0 downto 2 and f in [:-2; z; 2; -2; 2; -3; -2:]
    for r = -3 to -2 and j in [::]:];;
[%%expect{|
Lines 1-6, characters 0-36:
1 | [:(f, i, j, n, r, z)
2 |     for i = -2 to 2
3 |     for n = 2 to 2 and z in [::]
4 |     when abs z mod 2 = 0
5 |     for j = 0 downto 2 and f in [:-2; z; 2; -2; 2; -3; -2:]
6 |     for r = -3 to -2 and j in [::]:]..
Warning 26 [unused-var]: unused variable j.

- : (int * int * 'a * int * int * int) iarray = [::]
|}];;

[(g, l, w, y)
   for y = -2 downto -3
   for g in [] and l = -1 to 2 and w = 0 to -3
   when abs g mod 2 = 1
   when abs l mod 2 = 0];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(g, l, w, y)
    for y = -2 downto -3
    for g in [||] and l = -1 to 2 and w = 0 to -3
    when abs g mod 2 = 1
    when abs l mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(g, l, w, y)
    for y = -2 downto -3
    for g in [::] and l = -1 to 2 and w = 0 to -3
    when abs g mod 2 = 1
    when abs l mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(a, c, l, r)
   for c = -2 to 1 and l = 2 downto -2 and a = 3 downto 3 and r in [3; 1]];;
[%%expect{|
- : (int * int * int * int) list =
[(3, -2, 2, 3); (3, -2, 2, 1); (3, -2, 1, 3); (3, -2, 1, 1); (3, -2, 0, 3);
 (3, -2, 0, 1); (3, -2, -1, 3); (3, -2, -1, 1); (3, -2, -2, 3);
 (3, -2, -2, 1); (3, -1, 2, 3); (3, -1, 2, 1); (3, -1, 1, 3); (3, -1, 1, 1);
 (3, -1, 0, 3); (3, -1, 0, 1); (3, -1, -1, 3); (3, -1, -1, 1);
 (3, -1, -2, 3); (3, -1, -2, 1); (3, 0, 2, 3); (3, 0, 2, 1); (3, 0, 1, 3);
 (3, 0, 1, 1); (3, 0, 0, 3); (3, 0, 0, 1); (3, 0, -1, 3); (3, 0, -1, 1);
 (3, 0, -2, 3); (3, 0, -2, 1); (3, 1, 2, 3); (3, 1, 2, 1); (3, 1, 1, 3);
 (3, 1, 1, 1); (3, 1, 0, 3); (3, 1, 0, 1); (3, 1, -1, 3); (3, 1, -1, 1);
 (3, 1, -2, 3); (3, 1, -2, 1)]
|}];;

[|(a, c, l, r)
    for c = -2 to 1 and l = 2 downto -2 and a = 3 downto 3 and r in [|3; 1|]|];;
[%%expect{|
- : (int * int * int * int) array =
[|(3, -2, 2, 3); (3, -2, 2, 1); (3, -2, 1, 3); (3, -2, 1, 1); (3, -2, 0, 3);
  (3, -2, 0, 1); (3, -2, -1, 3); (3, -2, -1, 1); (3, -2, -2, 3);
  (3, -2, -2, 1); (3, -1, 2, 3); (3, -1, 2, 1); (3, -1, 1, 3); (3, -1, 1, 1);
  (3, -1, 0, 3); (3, -1, 0, 1); (3, -1, -1, 3); (3, -1, -1, 1);
  (3, -1, -2, 3); (3, -1, -2, 1); (3, 0, 2, 3); (3, 0, 2, 1); (3, 0, 1, 3);
  (3, 0, 1, 1); (3, 0, 0, 3); (3, 0, 0, 1); (3, 0, -1, 3); (3, 0, -1, 1);
  (3, 0, -2, 3); (3, 0, -2, 1); (3, 1, 2, 3); (3, 1, 2, 1); (3, 1, 1, 3);
  (3, 1, 1, 1); (3, 1, 0, 3); (3, 1, 0, 1); (3, 1, -1, 3); (3, 1, -1, 1);
  (3, 1, -2, 3); (3, 1, -2, 1)|]
|}];;

[:(a, c, l, r)
    for c = -2 to 1 and l = 2 downto -2 and a = 3 downto 3 and r in [:3; 1:]:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(3, -2, 2, 3); (3, -2, 2, 1); (3, -2, 1, 3); (3, -2, 1, 1); (3, -2, 0, 3);
  (3, -2, 0, 1); (3, -2, -1, 3); (3, -2, -1, 1); (3, -2, -2, 3);
  (3, -2, -2, 1); (3, -1, 2, 3); (3, -1, 2, 1); (3, -1, 1, 3); (3, -1, 1, 1);
  (3, -1, 0, 3); (3, -1, 0, 1); (3, -1, -1, 3); (3, -1, -1, 1);
  (3, -1, -2, 3); (3, -1, -2, 1); (3, 0, 2, 3); (3, 0, 2, 1); (3, 0, 1, 3);
  (3, 0, 1, 1); (3, 0, 0, 3); (3, 0, 0, 1); (3, 0, -1, 3); (3, 0, -1, 1);
  (3, 0, -2, 3); (3, 0, -2, 1); (3, 1, 2, 3); (3, 1, 2, 1); (3, 1, 1, 3);
  (3, 1, 1, 1); (3, 1, 0, 3); (3, 1, 0, 1); (3, 1, -1, 3); (3, 1, -1, 1);
  (3, 1, -2, 3); (3, 1, -2, 1):]
|}];;

[(a, f, h, j, l, u)
   for l in [-1; 0; -2; 3; 0; 0; 1]
   for a = 2 to 0 and u in [0; 3; -3; -1] and f in [2; 2; 0; -3; -3; 2]
   for l in [1; 0; 2; -3; a; 3; -1] and j in [3; 1; -1; 0; -2; -3]
   for h = -3 to a];;
[%%expect{|
Line 2, characters 7-8:
2 |    for l in [-1; 0; -2; 3; 0; 0; 1]
           ^
Warning 26 [unused-var]: unused variable l.

- : (int * int * int * int * int * int) list = []
|}];;

[|(a, f, h, j, l, u)
    for l in [|-1; 0; -2; 3; 0; 0; 1|]
    for a = 2 to 0 and u in [|0; 3; -3; -1|] and f in [|2; 2; 0; -3; -3; 2|]
    for l in [|1; 0; 2; -3; a; 3; -1|] and j in [|3; 1; -1; 0; -2; -3|]
    for h = -3 to a|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for l in [|-1; 0; -2; 3; 0; 0; 1|]
            ^
Warning 26 [unused-var]: unused variable l.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, f, h, j, l, u)
    for l in [:-1; 0; -2; 3; 0; 0; 1:]
    for a = 2 to 0 and u in [:0; 3; -3; -1:] and f in [:2; 2; 0; -3; -3; 2:]
    for l in [:1; 0; 2; -3; a; 3; -1:] and j in [:3; 1; -1; 0; -2; -3:]
    for h = -3 to a:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for l in [:-1; 0; -2; 3; 0; 0; 1:]
            ^
Warning 26 [unused-var]: unused variable l.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(g, p, u) for p = 1 downto -3 and g = -1 downto 3 and u = 0 to -3];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(g, p, u) for p = 1 downto -3 and g = -1 downto 3 and u = 0 to -3|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(g, p, u) for p = 1 downto -3 and g = -1 downto 3 and u = 0 to -3:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(m, u)
   for _ in [-2; -2; -1; 3; 2]
   for m = 2 to 3
   for u in [2]
   when u > 0
   when abs m mod 2 = 1];;
[%%expect{|
- : (int * int) list = [(3, 2); (3, 2); (3, 2); (3, 2); (3, 2)]
|}];;

[|(m, u)
    for _ in [|-2; -2; -1; 3; 2|]
    for m = 2 to 3
    for u in [|2|]
    when u > 0
    when abs m mod 2 = 1|];;
[%%expect{|
- : (int * int) array = [|(3, 2); (3, 2); (3, 2); (3, 2); (3, 2)|]
|}];;

[:(m, u)
    for _ in [:-2; -2; -1; 3; 2:]
    for m = 2 to 3
    for u in [:2:]
    when u > 0
    when abs m mod 2 = 1:];;
[%%expect{|
- : (int * int) iarray = [:(3, 2); (3, 2); (3, 2); (3, 2); (3, 2):]
|}];;

[(c, s)
   for c in [3; 0; 1]
   for s = 0 to 3
   for s in [3; 1; 0; 2; 0] and c = 0 downto -2
   when abs s mod 2 = 1];;
[%%expect{|
Line 2, characters 7-8:
2 |    for c in [3; 0; 1]
           ^
Warning 26 [unused-var]: unused variable c.

Lines 1-5, characters 0-24:
1 | [(c, s)
2 |    for c in [3; 0; 1]
3 |    for s = 0 to 3
4 |    for s in [3; 1; 0; 2; 0] and c = 0 downto -2
5 |    when abs s mod 2 = 1]..
Warning 26 [unused-var]: unused variable s.

- : (int * int) list =
[(0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3);
 (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1);
 (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1);
 (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3);
 (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1);
 (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1);
 (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3);
 (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1);
 (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1)]
|}];;

[|(c, s)
    for c in [|3; 0; 1|]
    for s = 0 to 3
    for s in [|3; 1; 0; 2; 0|] and c = 0 downto -2
    when abs s mod 2 = 1|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for c in [|3; 0; 1|]
            ^
Warning 26 [unused-var]: unused variable c.

Lines 1-5, characters 0-26:
1 | [|(c, s)
2 |     for c in [|3; 0; 1|]
3 |     for s = 0 to 3
4 |     for s in [|3; 1; 0; 2; 0|] and c = 0 downto -2
5 |     when abs s mod 2 = 1|]..
Warning 26 [unused-var]: unused variable s.

- : (int * int) array =
[|(0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3);
  (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1);
  (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1);
  (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3);
  (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1);
  (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1);
  (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3);
  (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1);
  (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1)|]
|}];;

[:(c, s)
    for c in [:3; 0; 1:]
    for s = 0 to 3
    for s in [:3; 1; 0; 2; 0:] and c = 0 downto -2
    when abs s mod 2 = 1:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for c in [:3; 0; 1:]
            ^
Warning 26 [unused-var]: unused variable c.

Lines 1-5, characters 0-26:
1 | [:(c, s)
2 |     for c in [:3; 0; 1:]
3 |     for s = 0 to 3
4 |     for s in [:3; 1; 0; 2; 0:] and c = 0 downto -2
5 |     when abs s mod 2 = 1:]..
Warning 26 [unused-var]: unused variable s.

- : (int * int) iarray =
[:(0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3);
  (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1);
  (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1);
  (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3);
  (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1);
  (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1);
  (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3);
  (-2, 3); (0, 1); (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1);
  (-1, 1); (-2, 1); (0, 3); (-1, 3); (-2, 3); (0, 1); (-1, 1); (-2, 1):]
|}];;

[(c, d, j, q)
   for q in [0; 2; -3; 3; 0; 2] and c in [0; 0; 0; 0]
   when q > 0
   for d = -2 downto 2 and j = 0 to 2];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(c, d, j, q)
    for q in [|0; 2; -3; 3; 0; 2|] and c in [|0; 0; 0; 0|]
    when q > 0
    for d = -2 downto 2 and j = 0 to 2|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(c, d, j, q)
    for q in [:0; 2; -3; 3; 0; 2:] and c in [:0; 0; 0; 0:]
    when q > 0
    for d = -2 downto 2 and j = 0 to 2:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(j, k, l, r, v)
   for j in [-3; 3; 2; -2] and r = -2 to -2 and k = -3 to -3
   for l in [] and _ in [-2; -1; j; k]
   for v in [k; -1; 1; 1]
   for v in [v; -1; 0] and r in [-3; 2; 3; 3; 1; -1]];;
[%%expect{|
Lines 1-5, characters 0-53:
1 | [(j, k, l, r, v)
2 |    for j in [-3; 3; 2; -2] and r = -2 to -2 and k = -3 to -3
3 |    for l in [] and _ in [-2; -1; j; k]
4 |    for v in [k; -1; 1; 1]
5 |    for v in [v; -1; 0] and r in [-3; 2; 3; 3; 1; -1]]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * 'a * int * int) list = []
|}];;

[|(j, k, l, r, v)
    for j in [|-3; 3; 2; -2|] and r = -2 to -2 and k = -3 to -3
    for l in [||] and _ in [|-2; -1; j; k|]
    for v in [|k; -1; 1; 1|]
    for v in [|v; -1; 0|] and r in [|-3; 2; 3; 3; 1; -1|]|];;
[%%expect{|
Lines 1-5, characters 0-59:
1 | [|(j, k, l, r, v)
2 |     for j in [|-3; 3; 2; -2|] and r = -2 to -2 and k = -3 to -3
3 |     for l in [||] and _ in [|-2; -1; j; k|]
4 |     for v in [|k; -1; 1; 1|]
5 |     for v in [|v; -1; 0|] and r in [|-3; 2; 3; 3; 1; -1|]|]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * '_weak44 * int * int) array = [||]
|}];;

[:(j, k, l, r, v)
    for j in [:-3; 3; 2; -2:] and r = -2 to -2 and k = -3 to -3
    for l in [::] and _ in [:-2; -1; j; k:]
    for v in [:k; -1; 1; 1:]
    for v in [:v; -1; 0:] and r in [:-3; 2; 3; 3; 1; -1:]:];;
[%%expect{|
Lines 1-5, characters 0-59:
1 | [:(j, k, l, r, v)
2 |     for j in [:-3; 3; 2; -2:] and r = -2 to -2 and k = -3 to -3
3 |     for l in [::] and _ in [:-2; -1; j; k:]
4 |     for v in [:k; -1; 1; 1:]
5 |     for v in [:v; -1; 0:] and r in [:-3; 2; 3; 3; 1; -1:]:]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * 'a * int * int) iarray = [::]
|}];;

[(c, g, m, v, x)
   for m = 3 downto 2
   for c = 1 to -1 and g in [2; m; 0; 1]
   for x in [-2; -3; -1]
   for v = 1 to 2];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(c, g, m, v, x)
    for m = 3 downto 2
    for c = 1 to -1 and g in [|2; m; 0; 1|]
    for x in [|-2; -3; -1|]
    for v = 1 to 2|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(c, g, m, v, x)
    for m = 3 downto 2
    for c = 1 to -1 and g in [:2; m; 0; 1:]
    for x in [:-2; -3; -1:]
    for v = 1 to 2:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(a, m, t) for m in [2; -1] and a = -1 downto 2 and t in [1; -2; 1; 0]];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, m, t) for m in [|2; -1|] and a = -1 downto 2 and t in [|1; -2; 1; 0|]|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(a, m, t) for m in [:2; -1:] and a = -1 downto 2 and t in [:1; -2; 1; 0:]:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(j, k, s, t, v, z)
   for s = 0 to 2
   for z = s to s
   for j = 1 downto 0 and t in [0]
   for k = 0 downto 1 and v = -2 downto 0
   when j <> 0];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(j, k, s, t, v, z)
    for s = 0 to 2
    for z = s to s
    for j = 1 downto 0 and t in [|0|]
    for k = 0 downto 1 and v = -2 downto 0
    when j <> 0|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(j, k, s, t, v, z)
    for s = 0 to 2
    for z = s to s
    for j = 1 downto 0 and t in [:0:]
    for k = 0 downto 1 and v = -2 downto 0
    when j <> 0:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(n, y) for n = -3 to -2 and y = 0 downto -3 when abs y mod 2 = 1];;
[%%expect{|
- : (int * int) list = [(-3, -1); (-3, -3); (-2, -1); (-2, -3)]
|}];;

[|(n, y) for n = -3 to -2 and y = 0 downto -3 when abs y mod 2 = 1|];;
[%%expect{|
- : (int * int) array = [|(-3, -1); (-3, -3); (-2, -1); (-2, -3)|]
|}];;

[:(n, y) for n = -3 to -2 and y = 0 downto -3 when abs y mod 2 = 1:];;
[%%expect{|
- : (int * int) iarray = [:(-3, -1); (-3, -3); (-2, -1); (-2, -3):]
|}];;

[(d, e, i)
   for e in [2; -1; 2; 0; 3] and i = 0 downto 0 and d in [-3; 3; -2; -2]
   when abs d mod 2 = 1
   when d > 0];;
[%%expect{|
- : (int * int * int) list =
[(3, 2, 0); (3, -1, 0); (3, 2, 0); (3, 0, 0); (3, 3, 0)]
|}];;

[|(d, e, i)
    for e in [|2; -1; 2; 0; 3|] and i = 0 downto 0 and d in [|-3; 3; -2; -2|]
    when abs d mod 2 = 1
    when d > 0|];;
[%%expect{|
- : (int * int * int) array =
[|(3, 2, 0); (3, -1, 0); (3, 2, 0); (3, 0, 0); (3, 3, 0)|]
|}];;

[:(d, e, i)
    for e in [:2; -1; 2; 0; 3:] and i = 0 downto 0 and d in [:-3; 3; -2; -2:]
    when abs d mod 2 = 1
    when d > 0:];;
[%%expect{|
- : (int * int * int) iarray =
[:(3, 2, 0); (3, -1, 0); (3, 2, 0); (3, 0, 0); (3, 3, 0):]
|}];;

[(c, h, k, u, x)
   for x = -3 to 0
   when abs x mod 2 = 0
   for h = -3 to 3
   for u = -2 downto 3 and k = 3 to 2
   for _ = x downto 1 and c in [2; 3; 2; 1]];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(c, h, k, u, x)
    for x = -3 to 0
    when abs x mod 2 = 0
    for h = -3 to 3
    for u = -2 downto 3 and k = 3 to 2
    for _ = x downto 1 and c in [|2; 3; 2; 1|]|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(c, h, k, u, x)
    for x = -3 to 0
    when abs x mod 2 = 0
    for h = -3 to 3
    for u = -2 downto 3 and k = 3 to 2
    for _ = x downto 1 and c in [:2; 3; 2; 1:]:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[l for l = -1 downto 1 when l > 0];;
[%%expect{|
- : int list = []
|}];;

[|l for l = -1 downto 1 when l > 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:l for l = -1 downto 1 when l > 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(e, j, o, q, u)
   for e in [0; -3; -3; 0] and j = 1 to 3 and q in [-2; 1; -3; -1; 1]
   for o = 1 to e
   for u = -2 downto o];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(e, j, o, q, u)
    for e in [|0; -3; -3; 0|] and j = 1 to 3 and q in [|-2; 1; -3; -1; 1|]
    for o = 1 to e
    for u = -2 downto o|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(e, j, o, q, u)
    for e in [:0; -3; -3; 0:] and j = 1 to 3 and q in [:-2; 1; -3; -1; 1:]
    for o = 1 to e
    for u = -2 downto o:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(d, e, l, u, w, x)
   for d = -2 to 1 and l in [2; -3; 0; -3; 0; 0; 1]
   for l in [-1; 3] and e = -2 downto 0
   for u in [] and x in [3; 0; -1; 0; 2; -3]
   for d in [2; -3; 0; -3; 0; 3; -2] and x in [0; -1; -2; 3; 1; 3]
   for w = 0 to 1];;
[%%expect{|
Lines 1-6, characters 0-18:
1 | [(d, e, l, u, w, x)
2 |    for d = -2 to 1 and l in [2; -3; 0; -3; 0; 0; 1]
3 |    for l in [-1; 3] and e = -2 downto 0
4 |    for u in [] and x in [3; 0; -1; 0; 2; -3]
5 |    for d in [2; -3; 0; -3; 0; 3; -2] and x in [0; -1; -2; 3; 1; 3]
6 |    for w = 0 to 1]..
Warning 26 [unused-var]: unused variable d.

Line 2, characters 23-24:
2 |    for d = -2 to 1 and l in [2; -3; 0; -3; 0; 0; 1]
                           ^
Warning 26 [unused-var]: unused variable l.

Line 4, characters 19-20:
4 |    for u in [] and x in [3; 0; -1; 0; 2; -3]
                       ^
Warning 26 [unused-var]: unused variable x.

- : (int * int * int * 'a * int * int) list = []
|}];;

[|(d, e, l, u, w, x)
    for d = -2 to 1 and l in [|2; -3; 0; -3; 0; 0; 1|]
    for l in [|-1; 3|] and e = -2 downto 0
    for u in [||] and x in [|3; 0; -1; 0; 2; -3|]
    for d in [|2; -3; 0; -3; 0; 3; -2|] and x in [|0; -1; -2; 3; 1; 3|]
    for w = 0 to 1|];;
[%%expect{|
Lines 1-6, characters 0-20:
1 | [|(d, e, l, u, w, x)
2 |     for d = -2 to 1 and l in [|2; -3; 0; -3; 0; 0; 1|]
3 |     for l in [|-1; 3|] and e = -2 downto 0
4 |     for u in [||] and x in [|3; 0; -1; 0; 2; -3|]
5 |     for d in [|2; -3; 0; -3; 0; 3; -2|] and x in [|0; -1; -2; 3; 1; 3|]
6 |     for w = 0 to 1|]..
Warning 26 [unused-var]: unused variable d.

Line 2, characters 24-25:
2 |     for d = -2 to 1 and l in [|2; -3; 0; -3; 0; 0; 1|]
                            ^
Warning 26 [unused-var]: unused variable l.

Line 4, characters 22-23:
4 |     for u in [||] and x in [|3; 0; -1; 0; 2; -3|]
                          ^
Warning 26 [unused-var]: unused variable x.

- : (int * int * int * '_weak45 * int * int) array = [||]
|}];;

[:(d, e, l, u, w, x)
    for d = -2 to 1 and l in [:2; -3; 0; -3; 0; 0; 1:]
    for l in [:-1; 3:] and e = -2 downto 0
    for u in [::] and x in [:3; 0; -1; 0; 2; -3:]
    for d in [:2; -3; 0; -3; 0; 3; -2:] and x in [:0; -1; -2; 3; 1; 3:]
    for w = 0 to 1:];;
[%%expect{|
Lines 1-6, characters 0-20:
1 | [:(d, e, l, u, w, x)
2 |     for d = -2 to 1 and l in [:2; -3; 0; -3; 0; 0; 1:]
3 |     for l in [:-1; 3:] and e = -2 downto 0
4 |     for u in [::] and x in [:3; 0; -1; 0; 2; -3:]
5 |     for d in [:2; -3; 0; -3; 0; 3; -2:] and x in [:0; -1; -2; 3; 1; 3:]
6 |     for w = 0 to 1:]..
Warning 26 [unused-var]: unused variable d.

Line 2, characters 24-25:
2 |     for d = -2 to 1 and l in [:2; -3; 0; -3; 0; 0; 1:]
                            ^
Warning 26 [unused-var]: unused variable l.

Line 4, characters 22-23:
4 |     for u in [::] and x in [:3; 0; -1; 0; 2; -3:]
                          ^
Warning 26 [unused-var]: unused variable x.

- : (int * int * int * 'a * int * int) iarray = [::]
|}];;

[(a, n, r)
   for a = 1 to 3 and n in [1; 3] and r in [-3; -1]
   when r > 0
   when abs n mod 2 = 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, n, r)
    for a = 1 to 3 and n in [|1; 3|] and r in [|-3; -1|]
    when r > 0
    when abs n mod 2 = 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(a, n, r)
    for a = 1 to 3 and n in [:1; 3:] and r in [:-3; -1:]
    when r > 0
    when abs n mod 2 = 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(a, e, i) for a = -1 to -3 and e = -3 downto -2 and i = -1 to 1];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, e, i) for a = -1 to -3 and e = -3 downto -2 and i = -1 to 1|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(a, e, i) for a = -1 to -3 and e = -3 downto -2 and i = -1 to 1:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(c, d, x)
   for c in [3; -3]
   for d in [0; 0; 2; -1; -1]
   when abs d mod 2 = 1
   for x = 2 downto d
   when c > 0];;
[%%expect{|
- : (int * int * int) list =
[(3, -1, 2); (3, -1, 1); (3, -1, 0); (3, -1, -1); (3, -1, 2); (3, -1, 1);
 (3, -1, 0); (3, -1, -1)]
|}];;

[|(c, d, x)
    for c in [|3; -3|]
    for d in [|0; 0; 2; -1; -1|]
    when abs d mod 2 = 1
    for x = 2 downto d
    when c > 0|];;
[%%expect{|
- : (int * int * int) array =
[|(3, -1, 2); (3, -1, 1); (3, -1, 0); (3, -1, -1); (3, -1, 2); (3, -1, 1);
  (3, -1, 0); (3, -1, -1)|]
|}];;

[:(c, d, x)
    for c in [:3; -3:]
    for d in [:0; 0; 2; -1; -1:]
    when abs d mod 2 = 1
    for x = 2 downto d
    when c > 0:];;
[%%expect{|
- : (int * int * int) iarray =
[:(3, -1, 2); (3, -1, 1); (3, -1, 0); (3, -1, -1); (3, -1, 2); (3, -1, 1);
  (3, -1, 0); (3, -1, -1):]
|}];;

[(h, u, z)
   for _ = -2 to 0 and u in [3; 3; -3]
   for h = u downto 1 and z in [0; -1; -2; 3]
   for z in []
   when u > 0];;
[%%expect{|
Line 3, characters 26-27:
3 |    for h = u downto 1 and z in [0; -1; -2; 3]
                              ^
Warning 26 [unused-var]: unused variable z.

- : (int * int * 'a) list = []
|}];;

[|(h, u, z)
    for _ = -2 to 0 and u in [|3; 3; -3|]
    for h = u downto 1 and z in [|0; -1; -2; 3|]
    for z in [||]
    when u > 0|];;
[%%expect{|
Line 3, characters 27-28:
3 |     for h = u downto 1 and z in [|0; -1; -2; 3|]
                               ^
Warning 26 [unused-var]: unused variable z.

- : (int * int * '_weak46) array = [||]
|}];;

[:(h, u, z)
    for _ = -2 to 0 and u in [:3; 3; -3:]
    for h = u downto 1 and z in [:0; -1; -2; 3:]
    for z in [::]
    when u > 0:];;
[%%expect{|
Line 3, characters 27-28:
3 |     for h = u downto 1 and z in [:0; -1; -2; 3:]
                               ^
Warning 26 [unused-var]: unused variable z.

- : (int * int * 'a) iarray = [::]
|}];;

[(b, e, k, r, u, z)
   for z in [1; 0]
   when z <> 0
   for u = z downto -1 and b = 0 downto -1
   for k in []
   for r = -3 downto 1 and e = -3 downto 2];;
[%%expect{|
- : (int * int * 'a * int * int * int) list = []
|}];;

[|(b, e, k, r, u, z)
    for z in [|1; 0|]
    when z <> 0
    for u = z downto -1 and b = 0 downto -1
    for k in [||]
    for r = -3 downto 1 and e = -3 downto 2|];;
[%%expect{|
- : (int * int * '_weak47 * int * int * int) array = [||]
|}];;

[:(b, e, k, r, u, z)
    for z in [:1; 0:]
    when z <> 0
    for u = z downto -1 and b = 0 downto -1
    for k in [::]
    for r = -3 downto 1 and e = -3 downto 2:];;
[%%expect{|
- : (int * int * 'a * int * int * int) iarray = [::]
|}];;

[(h, i, q, t)
   for i in [-3; 0; -3; -2]
   when i <> 0
   for t = -2 downto 2
   for q = 3 downto 1 and h = -1 to -2
   when t > 0];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(h, i, q, t)
    for i in [|-3; 0; -3; -2|]
    when i <> 0
    for t = -2 downto 2
    for q = 3 downto 1 and h = -1 to -2
    when t > 0|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(h, i, q, t)
    for i in [:-3; 0; -3; -2:]
    when i <> 0
    for t = -2 downto 2
    for q = 3 downto 1 and h = -1 to -2
    when t > 0:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(j, o, y, z)
   for z = -2 to 3 and o in [-1] and j = 1 to 3
   for y = 0 downto 0
   when abs z mod 2 = 0];;
[%%expect{|
- : (int * int * int * int) list =
[(1, -1, 0, -2); (2, -1, 0, -2); (3, -1, 0, -2); (1, -1, 0, 0);
 (2, -1, 0, 0); (3, -1, 0, 0); (1, -1, 0, 2); (2, -1, 0, 2); (3, -1, 0, 2)]
|}];;

[|(j, o, y, z)
    for z = -2 to 3 and o in [|-1|] and j = 1 to 3
    for y = 0 downto 0
    when abs z mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int) array =
[|(1, -1, 0, -2); (2, -1, 0, -2); (3, -1, 0, -2); (1, -1, 0, 0);
  (2, -1, 0, 0); (3, -1, 0, 0); (1, -1, 0, 2); (2, -1, 0, 2); (3, -1, 0, 2)|]
|}];;

[:(j, o, y, z)
    for z = -2 to 3 and o in [:-1:] and j = 1 to 3
    for y = 0 downto 0
    when abs z mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(1, -1, 0, -2); (2, -1, 0, -2); (3, -1, 0, -2); (1, -1, 0, 0);
  (2, -1, 0, 0); (3, -1, 0, 0); (1, -1, 0, 2); (2, -1, 0, 2); (3, -1, 0, 2):]
|}];;

[(f, j, q, t)
   for f = -2 to -1 and t in [-2; -3; 3; -2; -3; 2]
   for q = 2 to -3 and _ = 2 to 2
   for j = -3 downto t];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(f, j, q, t)
    for f = -2 to -1 and t in [|-2; -3; 3; -2; -3; 2|]
    for q = 2 to -3 and _ = 2 to 2
    for j = -3 downto t|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(f, j, q, t)
    for f = -2 to -1 and t in [:-2; -3; 3; -2; -3; 2:]
    for q = 2 to -3 and _ = 2 to 2
    for j = -3 downto t:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(i, k, u, w)
   for u in [2; -3; 2; -1; 3; -3; 3]
   when u < 0
   for u in [0; -3] and i = 0 downto 3 and w in [0; 2; 2] and k in [1]];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(i, r) for i = 1 downto 2 and r = 2 downto 0|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(i, r) for i = 1 downto 2 and r = 2 downto 0:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(g, k, p, u, v, x, y)
   for u in [-1; 0; -2; 1; -3; 3]
   and v = 3 downto 2
   and x in [1; 3; 0; -2; 0; 3; 3]
   for y = 3 to 1
   and k in [v; u; -3; u; x; -1]
   when y > 0
   for g = -1 to -3
   and p = v downto 0];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(g, k, p, u, v, x, y)
    for u in [|-1; 0; -2; 1; -3; 3|]
    and v = 3 downto 2
    and x in [|1; 3; 0; -2; 0; 3; 3|]
    for y = 3 to 1
    and k in [|v; u; -3; u; x; -1|]
    when y > 0
    for g = -1 to -3
    and p = v downto 0|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(g, k, p, u, v, x, y)
    for u in [:-1; 0; -2; 1; -3; 3:]
    and v = 3 downto 2
    and x in [:1; 3; 0; -2; 0; 3; 3:]
    for y = 3 to 1
    and k in [:v; u; -3; u; x; -1:]
    when y > 0
    for g = -1 to -3
    and p = v downto 0:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(k, r, y) for y = -2 to 0 for k = -3 downto y and r = -2 downto y];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(k, r, y) for y = -2 to 0 for k = -3 downto y and r = -2 downto y|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(k, r, y) for y = -2 to 0 for k = -3 downto y and r = -2 downto y:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(b, g, m, y)
   for g = -2 downto -3 and y = 3 downto 0
   for b = y to 1 and m in [0; 0; 3; 2; 2; -3]
   when b <> 0
   for m in [y; b]
   when y < 0];;
[%%expect{|
Line 3, characters 22-23:
3 |    for b = y to 1 and m in [0; 0; 3; 2; 2; -3]
                          ^
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int) list = []
|}];;

[|(b, g, m, y)
    for g = -2 downto -3 and y = 3 downto 0
    for b = y to 1 and m in [|0; 0; 3; 2; 2; -3|]
    when b <> 0
    for m in [|y; b|]
    when y < 0|];;
[%%expect{|
Line 3, characters 23-24:
3 |     for b = y to 1 and m in [|0; 0; 3; 2; 2; -3|]
                           ^
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int) array = [||]
|}];;

[:(b, g, m, y)
    for g = -2 downto -3 and y = 3 downto 0
    for b = y to 1 and m in [:0; 0; 3; 2; 2; -3:]
    when b <> 0
    for m in [:y; b:]
    when y < 0:];;
[%%expect{|
Line 3, characters 23-24:
3 |     for b = y to 1 and m in [:0; 0; 3; 2; 2; -3:]
                           ^
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int) iarray = [::]
|}];;

[(c, s, t, y)
   for s in [-2]
   when s <> 0
   for c = -1 downto -2
   when s > 0
   for t = 0 to -1 and y in [-2; -3]];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(c, s, t, y)
    for s in [|-2|]
    when s <> 0
    for c = -1 downto -2
    when s > 0
    for t = 0 to -1 and y in [|-2; -3|]|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(c, s, t, y)
    for s in [:-2:]
    when s <> 0
    for c = -1 downto -2
    when s > 0
    for t = 0 to -1 and y in [:-2; -3:]:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(l, u) for l = 1 downto -3 and u = -3 to 0 when abs l mod 2 = 1];;
[%%expect{|
- : (int * int) list =
[(1, -3); (1, -2); (1, -1); (1, 0); (-1, -3); (-1, -2); (-1, -1); (-1, 0);
 (-3, -3); (-3, -2); (-3, -1); (-3, 0)]
|}];;

[|(l, u) for l = 1 downto -3 and u = -3 to 0 when abs l mod 2 = 1|];;
[%%expect{|
- : (int * int) array =
[|(1, -3); (1, -2); (1, -1); (1, 0); (-1, -3); (-1, -2); (-1, -1); (-1, 0);
  (-3, -3); (-3, -2); (-3, -1); (-3, 0)|]
|}];;

[:(l, u) for l = 1 downto -3 and u = -3 to 0 when abs l mod 2 = 1:];;
[%%expect{|
- : (int * int) iarray =
[:(1, -3); (1, -2); (1, -1); (1, 0); (-1, -3); (-1, -2); (-1, -1); (-1, 0);
  (-3, -3); (-3, -2); (-3, -1); (-3, 0):]
|}];;

[(c, p, z) for c = 0 downto 0 and p in [-1; 3] and z = 3 to 1];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(c, p, z) for c = 0 downto 0 and p in [|-1; 3|] and z = 3 to 1|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(c, p, z) for c = 0 downto 0 and p in [:-1; 3:] and z = 3 to 1:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(a, b, f, i, j, m, s, z)
   for a = 1 downto -2
   for f = a to a and i = 0 to -3 and m = 3 downto 3
   for j in [-3; -2; -2; 0; -2; 2; -1]
   for s = 3 downto 0 and b in [1; -2; 3; 3; -3] and z = -3 downto -2];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) list = []
|}];;

[|(a, b, f, i, j, m, s, z)
    for a = 1 downto -2
    for f = a to a and i = 0 to -3 and m = 3 downto 3
    for j in [|-3; -2; -2; 0; -2; 2; -1|]
    for s = 3 downto 0 and b in [|1; -2; 3; 3; -3|] and z = -3 downto -2|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, b, f, i, j, m, s, z)
    for a = 1 downto -2
    for f = a to a and i = 0 to -3 and m = 3 downto 3
    for j in [:-3; -2; -2; 0; -2; 2; -1:]
    for s = 3 downto 0 and b in [:1; -2; 3; 3; -3:] and z = -3 downto -2:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(k, u, w) for w in [] and k = -1 to 0 and u = 1 downto 1];;
[%%expect{|
- : (int * int * 'a) list = []
|}];;

[|(k, u, w) for w in [||] and k = -1 to 0 and u = 1 downto 1|];;
[%%expect{|
- : (int * int * '_weak48) array = [||]
|}];;

[:(k, u, w) for w in [::] and k = -1 to 0 and u = 1 downto 1:];;
[%%expect{|
- : (int * int * 'a) iarray = [::]
|}];;

[(a, k, r, u)
   for u in [-1]
   for r = -3 to -3 and k in [-1; 3; -3; 0] and a = 2 to 0
   when abs u mod 2 = 0];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(a, k, r, u)
    for u in [|-1|]
    for r = -3 to -3 and k in [|-1; 3; -3; 0|] and a = 2 to 0
    when abs u mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(a, k, r, u)
    for u in [:-1:]
    for r = -3 to -3 and k in [:-1; 3; -3; 0:] and a = 2 to 0
    when abs u mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[b for b = -3 to 0 when b <> 0];;
[%%expect{|
- : int list = [-3; -2; -1]
|}];;

[|b for b = -3 to 0 when b <> 0|];;
[%%expect{|
- : int array = [|-3; -2; -1|]
|}];;

[:b for b = -3 to 0 when b <> 0:];;
[%%expect{|
- : int iarray = [:-3; -2; -1:]
|}];;

[(h, u, v)
   for u in [2; 2; 2; -3; 0; 2; 1]
   for h in [2; 2] and v = u to 3
   when u <> 0
   when v <> 0];;
[%%expect{|
- : (int * int * int) list =
[(2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 2, 2);
 (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, -3, -3);
 (2, -3, -2); (2, -3, -1); (2, -3, 1); (2, -3, 2); (2, -3, 3); (2, -3, -3);
 (2, -3, -2); (2, -3, -1); (2, -3, 1); (2, -3, 2); (2, -3, 3); (2, 2, 2);
 (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 1, 1); (2, 1, 2); (2, 1, 3); (2, 1, 1);
 (2, 1, 2); (2, 1, 3)]
|}];;

[|(h, u, v)
    for u in [|2; 2; 2; -3; 0; 2; 1|]
    for h in [|2; 2|] and v = u to 3
    when u <> 0
    when v <> 0|];;
[%%expect{|
- : (int * int * int) array =
[|(2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3);
  (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3);
  (2, -3, -3); (2, -3, -2); (2, -3, -1); (2, -3, 1); (2, -3, 2); (2, -3, 3);
  (2, -3, -3); (2, -3, -2); (2, -3, -1); (2, -3, 1); (2, -3, 2); (2, -3, 3);
  (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 1, 1); (2, 1, 2);
  (2, 1, 3); (2, 1, 1); (2, 1, 2); (2, 1, 3)|]
|}];;

[:(h, u, v)
    for u in [:2; 2; 2; -3; 0; 2; 1:]
    for h in [:2; 2:] and v = u to 3
    when u <> 0
    when v <> 0:];;
[%%expect{|
- : (int * int * int) iarray =
[:(2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3);
  (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3);
  (2, -3, -3); (2, -3, -2); (2, -3, -1); (2, -3, 1); (2, -3, 2); (2, -3, 3);
  (2, -3, -3); (2, -3, -2); (2, -3, -1); (2, -3, 1); (2, -3, 2); (2, -3, 3);
  (2, 2, 2); (2, 2, 3); (2, 2, 2); (2, 2, 3); (2, 1, 1); (2, 1, 2);
  (2, 1, 3); (2, 1, 1); (2, 1, 2); (2, 1, 3):]
|}];;

[(q, r, s, v)
   for q = 1 downto 1
   for v in [-2; 2; q; 1; -2; 0; 2]
   for r in []
   for _ in []
   for r = -2 to -1 and s = 1 downto q];;
[%%expect{|
Line 4, characters 7-8:
4 |    for r in []
           ^
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int) list = []
|}];;

[|(q, r, s, v)
    for q = 1 downto 1
    for v in [|-2; 2; q; 1; -2; 0; 2|]
    for r in [||]
    for _ in [||]
    for r = -2 to -1 and s = 1 downto q|];;
[%%expect{|
Line 4, characters 8-9:
4 |     for r in [||]
            ^
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int) array = [||]
|}];;

[:(q, r, s, v)
    for q = 1 downto 1
    for v in [:-2; 2; q; 1; -2; 0; 2:]
    for r in [::]
    for _ in [::]
    for r = -2 to -1 and s = 1 downto q:];;
[%%expect{|
Line 4, characters 8-9:
4 |     for r in [::]
            ^
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int) iarray = [::]
|}];;

[(j, l, q, r, s, v, z)
   for r = 3 downto -1
   for s = 1 downto 2 and v = 0 downto -1
   for z in []
   for j in [-1; -1; 2; 0; -1]
   for l = 1 to -1 and q in [-2; 1]];;
[%%expect{|
- : (int * int * int * int * int * int * 'a) list = []
|}];;

[|(j, l, q, r, s, v, z)
    for r = 3 downto -1
    for s = 1 downto 2 and v = 0 downto -1
    for z in [||]
    for j in [|-1; -1; 2; 0; -1|]
    for l = 1 to -1 and q in [|-2; 1|]|];;
[%%expect{|
- : (int * int * int * int * int * int * '_weak49) array = [||]
|}];;

[:(j, l, q, r, s, v, z)
    for r = 3 downto -1
    for s = 1 downto 2 and v = 0 downto -1
    for z in [::]
    for j in [:-1; -1; 2; 0; -1:]
    for l = 1 to -1 and q in [:-2; 1:]:];;
[%%expect{|
- : (int * int * int * int * int * int * 'a) iarray = [::]
|}];;

[(a, j, m, v)
   for j in [3; 2; -2; -2; -3; -3; -1]
   for v in [-3; 3]
   for a = -2 to -3 and m = -3 to 2];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(a, j, m, v)
    for j in [|3; 2; -2; -2; -3; -3; -1|]
    for v in [|-3; 3|]
    for a = -2 to -3 and m = -3 to 2|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(a, j, m, v)
    for j in [:3; 2; -2; -2; -3; -3; -1:]
    for v in [:-3; 3:]
    for a = -2 to -3 and m = -3 to 2:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(c, q, r, x)
   for x = 2 downto -2
   when abs x mod 2 = 1
   for q = -2 downto 1 and x in [-1; -3; 1]
   when x > 0
   for r in [q; 1; -2; 0; 2; -1; -3] and c = 3 downto 2];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(c, q, r, x)
    for x = 2 downto -2
    when abs x mod 2 = 1
    for q = -2 downto 1 and x in [|-1; -3; 1|]
    when x > 0
    for r in [|q; 1; -2; 0; 2; -1; -3|] and c = 3 downto 2|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(c, q, r, x)
    for x = 2 downto -2
    when abs x mod 2 = 1
    for q = -2 downto 1 and x in [:-1; -3; 1:]
    when x > 0
    for r in [:q; 1; -2; 0; 2; -1; -3:] and c = 3 downto 2:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(c, s) for _ = 3 to -1 and c = 1 to -1 and s = -3 to -1 for c = 0 downto 0];;
[%%expect{|
Line 1, characters 0-76:
1 | [(c, s) for _ = 3 to -1 and c = 1 to -1 and s = -3 to -1 for c = 0 downto 0];;
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Warning 26 [unused-var]: unused variable c.

- : (int * int) list = []
|}];;

[|(c, s) for _ = 3 to -1 and c = 1 to -1 and s = -3 to -1 for c = 0 downto 0|];;
[%%expect{|
Line 1, characters 0-78:
1 | [|(c, s) for _ = 3 to -1 and c = 1 to -1 and s = -3 to -1 for c = 0 downto 0|];;
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Warning 26 [unused-var]: unused variable c.

- : (int * int) array = [||]
|}];;

[:(c, s) for _ = 3 to -1 and c = 1 to -1 and s = -3 to -1 for c = 0 downto 0:];;
[%%expect{|
Line 1, characters 0-78:
1 | [:(c, s) for _ = 3 to -1 and c = 1 to -1 and s = -3 to -1 for c = 0 downto 0:];;
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Warning 26 [unused-var]: unused variable c.

- : (int * int) iarray = [::]
|}];;

[(i, n, t) for i = -2 to -3 for n in [-1; 0; i] and t in [0; -2; 1; -2; 2]];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, q, v, w, y)
    for q in [|3|] and v in [|3; 0; 0; -3|]
    for w = -2 downto -2 and a = v downto -3 and y = -1 to -3
    for v in [||]|];;
[%%expect{|
- : (int * int * '_weak50 * int * int) array = [||]
|}];;

[:(a, q, v, w, y)
    for q in [:3:] and v in [:3; 0; 0; -3:]
    for w = -2 downto -2 and a = v downto -3 and y = -1 to -3
    for v in [::]:];;
[%%expect{|
- : (int * int * 'a * int * int) iarray = [::]
|}];;

[(f, v) for v in [3; -3] and f in [-3] when v > 0];;
[%%expect{|
- : (int * int) list = [(-3, 3)]
|}];;

[|(f, v) for v in [|3; -3|] and f in [|-3|] when v > 0|];;
[%%expect{|
- : (int * int) array = [|(-3, 3)|]
|}];;

[:(f, v) for v in [:3; -3:] and f in [:-3:] when v > 0:];;
[%%expect{|
- : (int * int) iarray = [:(-3, 3):]
|}];;

[(l, m, s, v)
   for v = 3 to 3
   for m = -1 downto v
   for l = 2 to v
   for s in [-3; -2; v; 3]
   for m in [2; 2; 2]];;
[%%expect{|
Lines 1-6, characters 0-22:
1 | [(l, m, s, v)
2 |    for v = 3 to 3
3 |    for m = -1 downto v
4 |    for l = 2 to v
5 |    for s in [-3; -2; v; 3]
6 |    for m in [2; 2; 2]]..
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int) list = []
|}];;

[|(l, m, s, v)
    for v = 3 to 3
    for m = -1 downto v
    for l = 2 to v
    for s in [|-3; -2; v; 3|]
    for m in [|2; 2; 2|]|];;
[%%expect{|
Lines 1-6, characters 0-26:
1 | [|(l, m, s, v)
2 |     for v = 3 to 3
3 |     for m = -1 downto v
4 |     for l = 2 to v
5 |     for s in [|-3; -2; v; 3|]
6 |     for m in [|2; 2; 2|]|]..
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int) array = [||]
|}];;

[:(l, m, s, v)
    for v = 3 to 3
    for m = -1 downto v
    for l = 2 to v
    for s in [:-3; -2; v; 3:]
    for m in [:2; 2; 2:]:];;
[%%expect{|
Lines 1-6, characters 0-26:
1 | [:(l, m, s, v)
2 |     for v = 3 to 3
3 |     for m = -1 downto v
4 |     for l = 2 to v
5 |     for s in [:-3; -2; v; 3:]
6 |     for m in [:2; 2; 2:]:]..
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int) iarray = [::]
|}];;

[(c, k, y, z)
   for k in [-1; -1; -3; -2; -3; 2; -1]
   when abs k mod 2 = 0
   for k = 1 downto -2 and y in [2; 3; k; 3; 3; 3]
   for z = 0 downto 1 and c in [0; 0; -1; 2; 0] and y = -2 downto 1];;
[%%expect{|
Line 4, characters 27-28:
4 |    for k = 1 downto -2 and y in [2; 3; k; 3; 3; 3]
                               ^
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int) list = []
|}];;

[|(c, k, y, z)
    for k in [|-1; -1; -3; -2; -3; 2; -1|]
    when abs k mod 2 = 0
    for k = 1 downto -2 and y in [|2; 3; k; 3; 3; 3|]
    for z = 0 downto 1 and c in [|0; 0; -1; 2; 0|] and y = -2 downto 1|];;
[%%expect{|
Line 4, characters 28-29:
4 |     for k = 1 downto -2 and y in [|2; 3; k; 3; 3; 3|]
                                ^
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int) array = [||]
|}];;

[:(c, k, y, z)
    for k in [:-1; -1; -3; -2; -3; 2; -1:]
    when abs k mod 2 = 0
    for k = 1 downto -2 and y in [:2; 3; k; 3; 3; 3:]
    for z = 0 downto 1 and c in [:0; 0; -1; 2; 0:] and y = -2 downto 1:];;
[%%expect{|
Line 4, characters 28-29:
4 |     for k = 1 downto -2 and y in [:2; 3; k; 3; 3; 3:]
                                ^
Warning 26 [unused-var]: unused variable y.

- : (int * int * int * int) iarray = [::]
|}];;

[(a, v) for a = 0 to -3 for v = -3 downto -1];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(a, v) for a = 0 to -3 for v = -3 downto -1|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(a, v) for a = 0 to -3 for v = -3 downto -1:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(o, q, v, y)
   for o = 1 to 1
   when abs o mod 2 = 1
   when abs o mod 2 = 0
   for y in [-3; 1; -3; -1] and q = 0 downto 0
   for q = 0 to 3 and v = -2 to y];;
[%%expect{|
Lines 1-6, characters 0-34:
1 | [(o, q, v, y)
2 |    for o = 1 to 1
3 |    when abs o mod 2 = 1
4 |    when abs o mod 2 = 0
5 |    for y in [-3; 1; -3; -1] and q = 0 downto 0
6 |    for q = 0 to 3 and v = -2 to y]..
Warning 26 [unused-var]: unused variable q.

- : (int * int * int * int) list = []
|}];;

[|(o, q, v, y)
    for o = 1 to 1
    when abs o mod 2 = 1
    when abs o mod 2 = 0
    for y in [|-3; 1; -3; -1|] and q = 0 downto 0
    for q = 0 to 3 and v = -2 to y|];;
[%%expect{|
Lines 1-6, characters 0-36:
1 | [|(o, q, v, y)
2 |     for o = 1 to 1
3 |     when abs o mod 2 = 1
4 |     when abs o mod 2 = 0
5 |     for y in [|-3; 1; -3; -1|] and q = 0 downto 0
6 |     for q = 0 to 3 and v = -2 to y|]..
Warning 26 [unused-var]: unused variable q.

- : (int * int * int * int) array = [||]
|}];;

[:(o, q, v, y)
    for o = 1 to 1
    when abs o mod 2 = 1
    when abs o mod 2 = 0
    for y in [:-3; 1; -3; -1:] and q = 0 downto 0
    for q = 0 to 3 and v = -2 to y:];;
[%%expect{|
Lines 1-6, characters 0-36:
1 | [:(o, q, v, y)
2 |     for o = 1 to 1
3 |     when abs o mod 2 = 1
4 |     when abs o mod 2 = 0
5 |     for y in [:-3; 1; -3; -1:] and q = 0 downto 0
6 |     for q = 0 to 3 and v = -2 to y:]..
Warning 26 [unused-var]: unused variable q.

- : (int * int * int * int) iarray = [::]
|}];;

[(b, e, n, s, t, u, w)
   for e in [1; 2; -2; 1; -1]
   for u = -2 downto 3 and b = -3 downto -3
   for w = 0 to 2
   for n in [-1; 3; u; 2; 2] and s in [-3; -1; 3; 0; w; 3; 2]
   for t in [3; 0; 0; 2; 1; -1; 0]];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(b, e, n, s, t, u, w)
    for e in [|1; 2; -2; 1; -1|]
    for u = -2 downto 3 and b = -3 downto -3
    for w = 0 to 2
    for n in [|-1; 3; u; 2; 2|] and s in [|-3; -1; 3; 0; w; 3; 2|]
    for t in [|3; 0; 0; 2; 1; -1; 0|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(b, e, n, s, t, u, w)
    for e in [:1; 2; -2; 1; -1:]
    for u = -2 downto 3 and b = -3 downto -3
    for w = 0 to 2
    for n in [:-1; 3; u; 2; 2:] and s in [:-3; -1; 3; 0; w; 3; 2:]
    for t in [:3; 0; 0; 2; 1; -1; 0:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(b, f, m, n, p, q, s)
   for p in [1; 3; 3]
   for b = -3 downto 3
   for f in [1; -3; -3; -1] and q = 1 downto b
   for n = 0 downto 1 and s in [2; -1; 3; 0; -3; -3] and m = 0 downto 0];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(b, f, m, n, p, q, s)
    for p in [|1; 3; 3|]
    for b = -3 downto 3
    for f in [|1; -3; -3; -1|] and q = 1 downto b
    for n = 0 downto 1 and s in [|2; -1; 3; 0; -3; -3|] and m = 0 downto 0|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(b, f, m, n, p, q, s)
    for p in [:1; 3; 3:]
    for b = -3 downto 3
    for f in [:1; -3; -3; -1:] and q = 1 downto b
    for n = 0 downto 1 and s in [:2; -1; 3; 0; -3; -3:] and m = 0 downto 0:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(a, t, x) for a in [-1; 3; 0] and t = 2 to -1 and x = 3 to -2];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, t, x) for a in [|-1; 3; 0|] and t = 2 to -1 and x = 3 to -2|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(a, t, x) for a in [:-1; 3; 0:] and t = 2 to -1 and x = 3 to -2:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(b, c, f, l, y)
   for b in [2; 0; -2; -2; 2; 1]
   when b < 0
   for y = -3 to b and f = 3 to 0
   when abs b mod 2 = 0
   for l in [-1; -1; 1] and c = 3 to -2];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(b, c, f, l, y)
    for b in [|2; 0; -2; -2; 2; 1|]
    when b < 0
    for y = -3 to b and f = 3 to 0
    when abs b mod 2 = 0
    for l in [|-1; -1; 1|] and c = 3 to -2|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(b, c, f, l, y)
    for b in [:2; 0; -2; -2; 2; 1:]
    when b < 0
    for y = -3 to b and f = 3 to 0
    when abs b mod 2 = 0
    for l in [:-1; -1; 1:] and c = 3 to -2:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(b, i, j, u)
   for b in [-1; -2; 3] and u in [3] and j = 2 downto 0 and i in [1]
   when u > 0];;
[%%expect{|
- : (int * int * int * int) list =
[(-1, 1, 2, 3); (-1, 1, 1, 3); (-1, 1, 0, 3); (-2, 1, 2, 3); (-2, 1, 1, 3);
 (-2, 1, 0, 3); (3, 1, 2, 3); (3, 1, 1, 3); (3, 1, 0, 3)]
|}];;

[|(b, i, j, u)
    for b in [|-1; -2; 3|] and u in [|3|] and j = 2 downto 0 and i in [|1|]
    when u > 0|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-1, 1, 2, 3); (-1, 1, 1, 3); (-1, 1, 0, 3); (-2, 1, 2, 3); (-2, 1, 1, 3);
  (-2, 1, 0, 3); (3, 1, 2, 3); (3, 1, 1, 3); (3, 1, 0, 3)|]
|}];;

[:(b, i, j, u)
    for b in [:-1; -2; 3:] and u in [:3:] and j = 2 downto 0 and i in [:1:]
    when u > 0:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-1, 1, 2, 3); (-1, 1, 1, 3); (-1, 1, 0, 3); (-2, 1, 2, 3); (-2, 1, 1, 3);
  (-2, 1, 0, 3); (3, 1, 2, 3); (3, 1, 1, 3); (3, 1, 0, 3):]
|}];;

[(a, h, t) for t = -3 to -2 and a = 0 downto 3 and h = -2 to -3];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, h, t) for t = -3 to -2 and a = 0 downto 3 and h = -2 to -3|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(a, h, t) for t = -3 to -2 and a = 0 downto 3 and h = -2 to -3:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(o, t, w)
   for w in [0; -1; 2]
   when abs w mod 2 = 0
   for o = 3 to -2
   for o in [-3; -2; -3; -3; 1; 3] and t = 3 to 3];;
[%%expect{|
Lines 1-5, characters 0-50:
1 | [(o, t, w)
2 |    for w in [0; -1; 2]
3 |    when abs w mod 2 = 0
4 |    for o = 3 to -2
5 |    for o in [-3; -2; -3; -3; 1; 3] and t = 3 to 3]..
Warning 26 [unused-var]: unused variable o.

- : (int * int * int) list = []
|}];;

[|(o, t, w)
    for w in [|0; -1; 2|]
    when abs w mod 2 = 0
    for o = 3 to -2
    for o in [|-3; -2; -3; -3; 1; 3|] and t = 3 to 3|];;
[%%expect{|
Lines 1-5, characters 0-54:
1 | [|(o, t, w)
2 |     for w in [|0; -1; 2|]
3 |     when abs w mod 2 = 0
4 |     for o = 3 to -2
5 |     for o in [|-3; -2; -3; -3; 1; 3|] and t = 3 to 3|]..
Warning 26 [unused-var]: unused variable o.

- : (int * int * int) array = [||]
|}];;

[:(o, t, w)
    for w in [:0; -1; 2:]
    when abs w mod 2 = 0
    for o = 3 to -2
    for o in [:-3; -2; -3; -3; 1; 3:] and t = 3 to 3:];;
[%%expect{|
Lines 1-5, characters 0-54:
1 | [:(o, t, w)
2 |     for w in [:0; -1; 2:]
3 |     when abs w mod 2 = 0
4 |     for o = 3 to -2
5 |     for o in [:-3; -2; -3; -3; 1; 3:] and t = 3 to 3:]..
Warning 26 [unused-var]: unused variable o.

- : (int * int * int) iarray = [::]
|}];;

[(f, j, n, p, q)
   for p in [-1; -2; -1; -1; 3; -1; 3]
   when abs p mod 2 = 0
   for j in [3] and n = 3 to 3
   for q in [1]
   for f = 2 downto 0];;
[%%expect{|
- : (int * int * int * int * int) list =
[(2, 3, 3, -2, 1); (1, 3, 3, -2, 1); (0, 3, 3, -2, 1)]
|}];;

[|(f, j, n, p, q)
    for p in [|-1; -2; -1; -1; 3; -1; 3|]
    when abs p mod 2 = 0
    for j in [|3|] and n = 3 to 3
    for q in [|1|]
    for f = 2 downto 0|];;
[%%expect{|
- : (int * int * int * int * int) array =
[|(2, 3, 3, -2, 1); (1, 3, 3, -2, 1); (0, 3, 3, -2, 1)|]
|}];;

[:(f, j, n, p, q)
    for p in [:-1; -2; -1; -1; 3; -1; 3:]
    when abs p mod 2 = 0
    for j in [:3:] and n = 3 to 3
    for q in [:1:]
    for f = 2 downto 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray =
[:(2, 3, 3, -2, 1); (1, 3, 3, -2, 1); (0, 3, 3, -2, 1):]
|}];;

[(f, i, j, n, o, u, z)
   for u = -3 downto -3
   for z = 1 downto -3 and j = 2 to 3
   for z in [-1; z; 1; 3; -1] and f = 1 downto z and i = 3 downto 3
   for n = 3 downto f and o = 3 to -3 and f = -3 downto 3];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(f, i, j, n, o, u, z)
    for u = -3 downto -3
    for z = 1 downto -3 and j = 2 to 3
    for z in [|-1; z; 1; 3; -1|] and f = 1 downto z and i = 3 downto 3
    for n = 3 downto f and o = 3 to -3 and f = -3 downto 3|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(f, i, j, n, o, u, z)
    for u = -3 downto -3
    for z = 1 downto -3 and j = 2 to 3
    for z in [:-1; z; 1; 3; -1:] and f = 1 downto z and i = 3 downto 3
    for n = 3 downto f and o = 3 to -3 and f = -3 downto 3:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(e, l) for l = -3 downto 3 and e = 0 downto -2];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(e, l) for l = -3 downto 3 and e = 0 downto -2|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(e, l) for l = -3 downto 3 and e = 0 downto -2:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(j, m) for j = -1 to 1 and m in [-1; -1] when j > 0];;
[%%expect{|
- : (int * int) list = [(1, -1); (1, -1)]
|}];;

[|(j, m) for j = -1 to 1 and m in [|-1; -1|] when j > 0|];;
[%%expect{|
- : (int * int) array = [|(1, -1); (1, -1)|]
|}];;

[:(j, m) for j = -1 to 1 and m in [:-1; -1:] when j > 0:];;
[%%expect{|
- : (int * int) iarray = [:(1, -1); (1, -1):]
|}];;

[(g, p, r)
   for p = 2 downto 2 and r = -2 to -1 and g in [-3; 3]
   when g <> 0
   when abs r mod 2 = 0
   when abs g mod 2 = 1];;
[%%expect{|
- : (int * int * int) list = [(-3, 2, -2); (3, 2, -2)]
|}];;

[|(g, p, r)
    for p = 2 downto 2 and r = -2 to -1 and g in [|-3; 3|]
    when g <> 0
    when abs r mod 2 = 0
    when abs g mod 2 = 1|];;
[%%expect{|
- : (int * int * int) array = [|(-3, 2, -2); (3, 2, -2)|]
|}];;

[:(g, p, r)
    for p = 2 downto 2 and r = -2 to -1 and g in [:-3; 3:]
    when g <> 0
    when abs r mod 2 = 0
    when abs g mod 2 = 1:];;
[%%expect{|
- : (int * int * int) iarray = [:(-3, 2, -2); (3, 2, -2):]
|}];;

[(c, m, s)
   for s = 1 downto 0 and c = -2 to -2
   for m in [1; 2; 1]
   when abs m mod 2 = 1];;
[%%expect{|
- : (int * int * int) list = [(-2, 1, 1); (-2, 1, 1); (-2, 1, 0); (-2, 1, 0)]
|}];;

[|(c, m, s)
    for s = 1 downto 0 and c = -2 to -2
    for m in [|1; 2; 1|]
    when abs m mod 2 = 1|];;
[%%expect{|
- : (int * int * int) array =
[|(-2, 1, 1); (-2, 1, 1); (-2, 1, 0); (-2, 1, 0)|]
|}];;

[:(c, m, s)
    for s = 1 downto 0 and c = -2 to -2
    for m in [:1; 2; 1:]
    when abs m mod 2 = 1:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-2, 1, 1); (-2, 1, 1); (-2, 1, 0); (-2, 1, 0):]
|}];;

[(f, m, x) for m in [2; -3; 3; 3; 3] and x in [] and f in [-2; 2; -2; -1; 3]];;
[%%expect{|
- : (int * int * 'a) list = []
|}];;

[|(l, t, y, z)
    for y in [|-3; -2; -2; 1; 1|]
    and l = 1 downto 0
    and z in [|0; -3|]
    and t = 0 to 1|];;
[%%expect{|
- : (int * int * int * int) array =
[|(1, 0, -3, 0); (1, 1, -3, 0); (1, 0, -3, -3); (1, 1, -3, -3);
  (0, 0, -3, 0); (0, 1, -3, 0); (0, 0, -3, -3); (0, 1, -3, -3);
  (1, 0, -2, 0); (1, 1, -2, 0); (1, 0, -2, -3); (1, 1, -2, -3);
  (0, 0, -2, 0); (0, 1, -2, 0); (0, 0, -2, -3); (0, 1, -2, -3);
  (1, 0, -2, 0); (1, 1, -2, 0); (1, 0, -2, -3); (1, 1, -2, -3);
  (0, 0, -2, 0); (0, 1, -2, 0); (0, 0, -2, -3); (0, 1, -2, -3); (1, 0, 1, 0);
  (1, 1, 1, 0); (1, 0, 1, -3); (1, 1, 1, -3); (0, 0, 1, 0); (0, 1, 1, 0);
  (0, 0, 1, -3); (0, 1, 1, -3); (1, 0, 1, 0); (1, 1, 1, 0); (1, 0, 1, -3);
  (1, 1, 1, -3); (0, 0, 1, 0); (0, 1, 1, 0); (0, 0, 1, -3); (0, 1, 1, -3)|]
|}];;

[:(l, t, y, z)
    for y in [:-3; -2; -2; 1; 1:]
    and l = 1 downto 0
    and z in [:0; -3:]
    and t = 0 to 1:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(1, 0, -3, 0); (1, 1, -3, 0); (1, 0, -3, -3); (1, 1, -3, -3);
  (0, 0, -3, 0); (0, 1, -3, 0); (0, 0, -3, -3); (0, 1, -3, -3);
  (1, 0, -2, 0); (1, 1, -2, 0); (1, 0, -2, -3); (1, 1, -2, -3);
  (0, 0, -2, 0); (0, 1, -2, 0); (0, 0, -2, -3); (0, 1, -2, -3);
  (1, 0, -2, 0); (1, 1, -2, 0); (1, 0, -2, -3); (1, 1, -2, -3);
  (0, 0, -2, 0); (0, 1, -2, 0); (0, 0, -2, -3); (0, 1, -2, -3); (1, 0, 1, 0);
  (1, 1, 1, 0); (1, 0, 1, -3); (1, 1, 1, -3); (0, 0, 1, 0); (0, 1, 1, 0);
  (0, 0, 1, -3); (0, 1, 1, -3); (1, 0, 1, 0); (1, 1, 1, 0); (1, 0, 1, -3);
  (1, 1, 1, -3); (0, 0, 1, 0); (0, 1, 1, 0); (0, 0, 1, -3); (0, 1, 1, -3):]
|}];;

[(i, j, n, q, v)
   for n in [2]
   and j in [-1; 1; -3; 0; -1; -3]
   and i = -1 downto -2
   and v = 3 downto 2
   and q in [1; -2; -2; -2; -1; -1]
   when n < 0];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(i, j, n, q, v)
    for n in [|2|]
    and j in [|-1; 1; -3; 0; -1; -3|]
    and i = -1 downto -2
    and v = 3 downto 2
    and q in [|1; -2; -2; -2; -1; -1|]
    when n < 0|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(i, j, n, q, v)
    for n in [:2:]
    and j in [:-1; 1; -3; 0; -1; -3:]
    and i = -1 downto -2
    and v = 3 downto 2
    and q in [:1; -2; -2; -2; -1; -1:]
    when n < 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(a, c, k, l, n, v, x)
   for c in [3]
   for n = 1 downto 0 and v in [2; 2; 0; 2; 1; -2]
   for _ = 0 to 0 and k = n downto 1
   for l in []
   for x = 3 downto k and a in [0; 3; l; 2; -3; 2]];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(a, c, k, l, n, v, x)
    for c in [|3|]
    for n = 1 downto 0 and v in [|2; 2; 0; 2; 1; -2|]
    for _ = 0 to 0 and k = n downto 1
    for l in [||]
    for x = 3 downto k and a in [|0; 3; l; 2; -3; 2|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, c, k, l, n, v, x)
    for c in [:3:]
    for n = 1 downto 0 and v in [:2; 2; 0; 2; 1; -2:]
    for _ = 0 to 0 and k = n downto 1
    for l in [::]
    for x = 3 downto k and a in [:0; 3; l; 2; -3; 2:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(i, t, w)
   for t in [2; -2; 1; 2; 0; 0; -3]
   when abs t mod 2 = 0
   when abs t mod 2 = 0
   for i = 3 to 0 and w in [t; -1; -1; -2; -3; -3; 0]
   when t <> 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(i, t, w)
    for t in [|2; -2; 1; 2; 0; 0; -3|]
    when abs t mod 2 = 0
    when abs t mod 2 = 0
    for i = 3 to 0 and w in [|t; -1; -1; -2; -3; -3; 0|]
    when t <> 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(i, t, w)
    for t in [:2; -2; 1; 2; 0; 0; -3:]
    when abs t mod 2 = 0
    when abs t mod 2 = 0
    for i = 3 to 0 and w in [:t; -1; -1; -2; -3; -3; 0:]
    when t <> 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(d, l, s)
   for l in [-3; 3; 3; -1; 2; -2; -2]
   when l < 0
   when l > 0
   for d = -2 to -1 and s in [1; 2; -1; -2; 3] and l in [-3]];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(d, l, s)
    for l in [|-3; 3; 3; -1; 2; -2; -2|]
    when l < 0
    when l > 0
    for d = -2 to -1 and s in [|1; 2; -1; -2; 3|] and l in [|-3|]|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(d, l, s)
    for l in [:-3; 3; 3; -1; 2; -2; -2:]
    when l < 0
    when l > 0
    for d = -2 to -1 and s in [:1; 2; -1; -2; 3:] and l in [:-3:]:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(b, c, s) for c = 0 to -1 and s = 3 downto -1 and b = 2 downto -2];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(b, c, s) for c = 0 to -1 and s = 3 downto -1 and b = 2 downto -2|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(b, c, s) for c = 0 to -1 and s = 3 downto -1 and b = 2 downto -2:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(g, m, s) for g = 0 to 0 and m = 2 downto 1 and s in [0]];;
[%%expect{|
- : (int * int * int) list = [(0, 2, 0); (0, 1, 0)]
|}];;

[|(g, m, s) for g = 0 to 0 and m = 2 downto 1 and s in [|0|]|];;
[%%expect{|
- : (int * int * int) array = [|(0, 2, 0); (0, 1, 0)|]
|}];;

[:(g, m, s) for g = 0 to 0 and m = 2 downto 1 and s in [:0:]:];;
[%%expect{|
- : (int * int * int) iarray = [:(0, 2, 0); (0, 1, 0):]
|}];;

[(e, g, s, v)
   for s in [2; -2; 0]
   for e = 0 downto 0
   for g = 1 to 0 and v = e downto -3];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(e, g, s, v)
    for s in [|2; -2; 0|]
    for e = 0 downto 0
    for g = 1 to 0 and v = e downto -3|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(e, g, s, v)
    for s in [:2; -2; 0:]
    for e = 0 downto 0
    for g = 1 to 0 and v = e downto -3:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(e, g, i, j, m, x, y)
   for j in [1; -1] and x = -1 to 2
   for m in [0; -2; -3] and e = -1 downto 3 and i = -1 downto 3
   for g = 2 downto 2
   for y in [-2; -1]];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(e, g, i, j, m, x, y)
    for j in [|1; -1|] and x = -1 to 2
    for m in [|0; -2; -3|] and e = -1 downto 3 and i = -1 downto 3
    for g = 2 downto 2
    for y in [|-2; -1|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(e, g, i, j, m, x, y)
    for j in [:1; -1:] and x = -1 to 2
    for m in [:0; -2; -3:] and e = -1 downto 3 and i = -1 downto 3
    for g = 2 downto 2
    for y in [:-2; -1:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(e, n, q)
   for e in [-2; 0; -3; 2; -3; -1; 1]
   when abs e mod 2 = 1
   for q in [] and n = -1 to -3];;
[%%expect{|
- : (int * int * 'a) list = []
|}];;

[|(e, n, q)
    for e in [|-2; 0; -3; 2; -3; -1; 1|]
    when abs e mod 2 = 1
    for q in [||] and n = -1 to -3|];;
[%%expect{|
- : (int * int * '_weak51) array = [||]
|}];;

[:(e, n, q)
    for e in [:-2; 0; -3; 2; -3; -1; 1:]
    when abs e mod 2 = 1
    for q in [::] and n = -1 to -3:];;
[%%expect{|
- : (int * int * 'a) iarray = [::]
|}];;

[(a, h, i, p)
   for h in [3; -2; -2; 2] and i = 0 downto -1 and p in [-3] and a in [0; -2]];;
[%%expect{|
- : (int * int * int * int) list =
[(0, 3, 0, -3); (-2, 3, 0, -3); (0, 3, -1, -3); (-2, 3, -1, -3);
 (0, -2, 0, -3); (-2, -2, 0, -3); (0, -2, -1, -3); (-2, -2, -1, -3);
 (0, -2, 0, -3); (-2, -2, 0, -3); (0, -2, -1, -3); (-2, -2, -1, -3);
 (0, 2, 0, -3); (-2, 2, 0, -3); (0, 2, -1, -3); (-2, 2, -1, -3)]
|}];;

[|(a, h, i, p)
    for h in [|3; -2; -2; 2|]
    and i = 0 downto -1
    and p in [|-3|]
    and a in [|0; -2|]|];;
[%%expect{|
- : (int * int * int * int) array =
[|(0, 3, 0, -3); (-2, 3, 0, -3); (0, 3, -1, -3); (-2, 3, -1, -3);
  (0, -2, 0, -3); (-2, -2, 0, -3); (0, -2, -1, -3); (-2, -2, -1, -3);
  (0, -2, 0, -3); (-2, -2, 0, -3); (0, -2, -1, -3); (-2, -2, -1, -3);
  (0, 2, 0, -3); (-2, 2, 0, -3); (0, 2, -1, -3); (-2, 2, -1, -3)|]
|}];;

[:(a, h, i, p)
    for h in [:3; -2; -2; 2:]
    and i = 0 downto -1
    and p in [:-3:]
    and a in [:0; -2:]:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(0, 3, 0, -3); (-2, 3, 0, -3); (0, 3, -1, -3); (-2, 3, -1, -3);
  (0, -2, 0, -3); (-2, -2, 0, -3); (0, -2, -1, -3); (-2, -2, -1, -3);
  (0, -2, 0, -3); (-2, -2, 0, -3); (0, -2, -1, -3); (-2, -2, -1, -3);
  (0, 2, 0, -3); (-2, 2, 0, -3); (0, 2, -1, -3); (-2, 2, -1, -3):]
|}];;

[(e, h, o, q, y)
   for h = 3 downto -2
   when abs h mod 2 = 0
   for e in [1; 2; -3; -3; -2; 3] and h in [-2]
   for o in [] and y in [0; 3; -2]
   for q in [-3; 2; 1; 2; 2; -3]];;
[%%expect{|
- : (int * int * 'a * int * int) list = []
|}];;

[|(e, h, o, q, y)
    for h = 3 downto -2
    when abs h mod 2 = 0
    for e in [|1; 2; -3; -3; -2; 3|] and h in [|-2|]
    for o in [||] and y in [|0; 3; -2|]
    for q in [|-3; 2; 1; 2; 2; -3|]|];;
[%%expect{|
- : (int * int * '_weak52 * int * int) array = [||]
|}];;

[:(e, h, o, q, y)
    for h = 3 downto -2
    when abs h mod 2 = 0
    for e in [:1; 2; -3; -3; -2; 3:] and h in [:-2:]
    for o in [::] and y in [:0; 3; -2:]
    for q in [:-3; 2; 1; 2; 2; -3:]:];;
[%%expect{|
- : (int * int * 'a * int * int) iarray = [::]
|}];;

[w for w = 1 downto -1 when w > 0];;
[%%expect{|
- : int list = [1]
|}];;

[|w for w = 1 downto -1 when w > 0|];;
[%%expect{|
- : int array = [|1|]
|}];;

[:w for w = 1 downto -1 when w > 0:];;
[%%expect{|
- : int iarray = [:1:]
|}];;

[(a, b, d, h, n, x)
   for d in [-1; 0; -1; -3; -2] and n = 1 downto -1
   for b = 0 downto -1 and a = n to -3 and x = -3 downto -2 and h in []];;
[%%expect{|
- : (int * int * int * 'a * int * int) list = []
|}];;

[|(a, b, d, h, n, x)
    for d in [|-1; 0; -1; -3; -2|] and n = 1 downto -1
    for b = 0 downto -1 and a = n to -3 and x = -3 downto -2 and h in [||]|];;
[%%expect{|
- : (int * int * int * '_weak53 * int * int) array = [||]
|}];;

[:(a, b, d, h, n, x)
    for d in [:-1; 0; -1; -3; -2:] and n = 1 downto -1
    for b = 0 downto -1 and a = n to -3 and x = -3 downto -2 and h in [::]:];;
[%%expect{|
- : (int * int * int * 'a * int * int) iarray = [::]
|}];;

[(b, c, e, l, m, s, z)
   for m in [-1; -1]
   for e in [3; 0; 2] and l = 0 downto -2
   for c = e to 1 and z = -3 downto l
   for s in [2; 1] and l in [3]
   for b = 0 downto 0];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(b, c, e, l, m, s, z)
    for m in [|-1; -1|]
    for e in [|3; 0; 2|] and l = 0 downto -2
    for c = e to 1 and z = -3 downto l
    for s in [|2; 1|] and l in [|3|]
    for b = 0 downto 0|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(b, c, e, l, m, s, z)
    for m in [:-1; -1:]
    for e in [:3; 0; 2:] and l = 0 downto -2
    for c = e to 1 and z = -3 downto l
    for s in [:2; 1:] and l in [:3:]
    for b = 0 downto 0:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(e, g, m, n)
   for n in [-3; -1; -2]
   for g = 0 downto 3 and e in [] and m = -1 downto n and n = 2 to 0
   when abs n mod 2 = 0];;
[%%expect{|
- : ('a * int * int * int) list = []
|}];;

[|(e, g, m, n)
    for n in [|-3; -1; -2|]
    for g = 0 downto 3 and e in [||] and m = -1 downto n and n = 2 to 0
    when abs n mod 2 = 0|];;
[%%expect{|
- : ('_weak54 * int * int * int) array = [||]
|}];;

[:(e, g, m, n)
    for n in [:-3; -1; -2:]
    for g = 0 downto 3 and e in [::] and m = -1 downto n and n = 2 to 0
    when abs n mod 2 = 0:];;
[%%expect{|
- : ('a * int * int * int) iarray = [::]
|}];;

[(l, n, s)
   for s in [-3; 3]
   when abs s mod 2 = 0
   for n in [] and l = -3 downto 0 and _ = 1 downto -3
   for l = 2 downto 1];;
[%%expect{|
Lines 1-5, characters 0-22:
1 | [(l, n, s)
2 |    for s in [-3; 3]
3 |    when abs s mod 2 = 0
4 |    for n in [] and l = -3 downto 0 and _ = 1 downto -3
5 |    for l = 2 downto 1]..
Warning 26 [unused-var]: unused variable l.

- : (int * 'a * int) list = []
|}];;

[|(l, n, s)
    for s in [|-3; 3|]
    when abs s mod 2 = 0
    for n in [||] and l = -3 downto 0 and _ = 1 downto -3
    for l = 2 downto 1|];;
[%%expect{|
Lines 1-5, characters 0-24:
1 | [|(l, n, s)
2 |     for s in [|-3; 3|]
3 |     when abs s mod 2 = 0
4 |     for n in [||] and l = -3 downto 0 and _ = 1 downto -3
5 |     for l = 2 downto 1|]..
Warning 26 [unused-var]: unused variable l.

- : (int * '_weak55 * int) array = [||]
|}];;

[:(l, n, s)
    for s in [:-3; 3:]
    when abs s mod 2 = 0
    for n in [::] and l = -3 downto 0 and _ = 1 downto -3
    for l = 2 downto 1:];;
[%%expect{|
Lines 1-5, characters 0-24:
1 | [:(l, n, s)
2 |     for s in [:-3; 3:]
3 |     when abs s mod 2 = 0
4 |     for n in [::] and l = -3 downto 0 and _ = 1 downto -3
5 |     for l = 2 downto 1:]..
Warning 26 [unused-var]: unused variable l.

- : (int * 'a * int) iarray = [::]
|}];;

[(s, u) for s in [1; -3; 1] and u in [-3; 3] when abs u mod 2 = 0];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(s, u) for s in [|1; -3; 1|] and u in [|-3; 3|] when abs u mod 2 = 0|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(s, u) for s in [:1; -3; 1:] and u in [:-3; 3:] when abs u mod 2 = 0:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(k, u, v, w)
   for k in [1] and u in [0; 2]
   for v = 0 downto -1
   for w = 0 to -1
   when w > 0];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(k, u, v, w)
    for k in [|1|] and u in [|0; 2|]
    for v = 0 downto -1
    for w = 0 to -1
    when w > 0|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(k, u, v, w)
    for k in [:1:] and u in [:0; 2:]
    for v = 0 downto -1
    for w = 0 to -1
    when w > 0:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(o, s, z)
   for _ = 1 downto -3
   for _ = 2 to -3
   for s in [3; 1; -1; -1; 3; -3] and z = -1 to 0
   for o = 1 downto -3];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(o, s, z)
    for _ = 1 downto -3
    for _ = 2 to -3
    for s in [|3; 1; -1; -1; 3; -3|] and z = -1 to 0
    for o = 1 downto -3|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(o, s, z)
    for _ = 1 downto -3
    for _ = 2 to -3
    for s in [:3; 1; -1; -1; 3; -3:] and z = -1 to 0
    for o = 1 downto -3:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(f, w) for w in [0; -3; -2; -3; -3] and _ = 2 downto -1 and f = 3 downto 0];;
[%%expect{|
- : (int * int) list =
[(3, 0); (2, 0); (1, 0); (0, 0); (3, 0); (2, 0); (1, 0); (0, 0); (3, 0);
 (2, 0); (1, 0); (0, 0); (3, 0); (2, 0); (1, 0); (0, 0); (3, -3); (2, -3);
 (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
 (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -2); (2, -2);
 (1, -2); (0, -2); (3, -2); (2, -2); (1, -2); (0, -2); (3, -2); (2, -2);
 (1, -2); (0, -2); (3, -2); (2, -2); (1, -2); (0, -2); (3, -3); (2, -3);
 (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
 (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
 (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
 (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3)]
|}];;

[|(f, w)
    for w in [|0; -3; -2; -3; -3|] and _ = 2 downto -1 and f = 3 downto 0|];;
[%%expect{|
- : (int * int) array =
[|(3, 0); (2, 0); (1, 0); (0, 0); (3, 0); (2, 0); (1, 0); (0, 0); (3, 0);
  (2, 0); (1, 0); (0, 0); (3, 0); (2, 0); (1, 0); (0, 0); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -2); (2, -2);
  (1, -2); (0, -2); (3, -2); (2, -2); (1, -2); (0, -2); (3, -2); (2, -2);
  (1, -2); (0, -2); (3, -2); (2, -2); (1, -2); (0, -2); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3)|]
|}];;

[:(f, w)
    for w in [:0; -3; -2; -3; -3:] and _ = 2 downto -1 and f = 3 downto 0:];;
[%%expect{|
- : (int * int) iarray =
[:(3, 0); (2, 0); (1, 0); (0, 0); (3, 0); (2, 0); (1, 0); (0, 0); (3, 0);
  (2, 0); (1, 0); (0, 0); (3, 0); (2, 0); (1, 0); (0, 0); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -2); (2, -2);
  (1, -2); (0, -2); (3, -2); (2, -2); (1, -2); (0, -2); (3, -2); (2, -2);
  (1, -2); (0, -2); (3, -2); (2, -2); (1, -2); (0, -2); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3); (3, -3); (2, -3);
  (1, -3); (0, -3); (3, -3); (2, -3); (1, -3); (0, -3):]
|}];;

[(b, j, l, o, r)
   for b in [0; -1; -1] and r = 1 downto 0 and o = 2 downto 1
   for l = -2 downto b and o in [2; -1; 0; -1; 2] and j = 2 to -1];;
[%%expect{|
Lines 1-3, characters 0-66:
1 | [(b, j, l, o, r)
2 |    for b in [0; -1; -1] and r = 1 downto 0 and o = 2 downto 1
3 |    for l = -2 downto b and o in [2; -1; 0; -1; 2] and j = 2 to -1]..
Warning 26 [unused-var]: unused variable o.

- : (int * int * int * int * int) list = []
|}];;

[|(b, j, l, o, r)
    for b in [|0; -1; -1|] and r = 1 downto 0 and o = 2 downto 1
    for l = -2 downto b and o in [|2; -1; 0; -1; 2|] and j = 2 to -1|];;
[%%expect{|
Lines 1-3, characters 0-70:
1 | [|(b, j, l, o, r)
2 |     for b in [|0; -1; -1|] and r = 1 downto 0 and o = 2 downto 1
3 |     for l = -2 downto b and o in [|2; -1; 0; -1; 2|] and j = 2 to -1|]..
Warning 26 [unused-var]: unused variable o.

- : (int * int * int * int * int) array = [||]
|}];;

[:(b, j, l, o, r)
    for b in [:0; -1; -1:] and r = 1 downto 0 and o = 2 downto 1
    for l = -2 downto b and o in [:2; -1; 0; -1; 2:] and j = 2 to -1:];;
[%%expect{|
Lines 1-3, characters 0-70:
1 | [:(b, j, l, o, r)
2 |     for b in [:0; -1; -1:] and r = 1 downto 0 and o = 2 downto 1
3 |     for l = -2 downto b and o in [:2; -1; 0; -1; 2:] and j = 2 to -1:]..
Warning 26 [unused-var]: unused variable o.

- : (int * int * int * int * int) iarray = [::]
|}];;

[(b, h, j, l, r, s, v)
   for b in [-1] and l = 1 to 1 and r in [2; -3; -3; 0]
   for v = -2 downto 2 and j = -2 to 1 and h = -1 downto -2
   for s = -1 to 0 and _ in [3; -1; h; -1; 3]
   for _ in [-3; 3; -1; -1]];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(b, h, j, l, r, s, v)
    for b in [|-1|] and l = 1 to 1 and r in [|2; -3; -3; 0|]
    for v = -2 downto 2 and j = -2 to 1 and h = -1 downto -2
    for s = -1 to 0 and _ in [|3; -1; h; -1; 3|]
    for _ in [|-3; 3; -1; -1|]|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(b, h, j, l, r, s, v)
    for b in [:-1:] and l = 1 to 1 and r in [:2; -3; -3; 0:]
    for v = -2 downto 2 and j = -2 to 1 and h = -1 downto -2
    for s = -1 to 0 and _ in [:3; -1; h; -1; 3:]
    for _ in [:-3; 3; -1; -1:]:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(c, f, v)
   for f in [-3] and v in [0; 3; -3; 0; 0] and c in [1; 0; -3; 3; -2; 3]
   when c < 0];;
[%%expect{|
- : (int * int * int) list =
[(-3, -3, 0); (-2, -3, 0); (-3, -3, 3); (-2, -3, 3); (-3, -3, -3);
 (-2, -3, -3); (-3, -3, 0); (-2, -3, 0); (-3, -3, 0); (-2, -3, 0)]
|}];;

[|(c, f, v)
    for f in [|-3|] and v in [|0; 3; -3; 0; 0|] and c in [|1; 0; -3; 3; -2; 3|]
    when c < 0|];;
[%%expect{|
- : (int * int * int) array =
[|(-3, -3, 0); (-2, -3, 0); (-3, -3, 3); (-2, -3, 3); (-3, -3, -3);
  (-2, -3, -3); (-3, -3, 0); (-2, -3, 0); (-3, -3, 0); (-2, -3, 0)|]
|}];;

[:(c, f, v)
    for f in [:-3:] and v in [:0; 3; -3; 0; 0:] and c in [:1; 0; -3; 3; -2; 3:]
    when c < 0:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-3, -3, 0); (-2, -3, 0); (-3, -3, 3); (-2, -3, 3); (-3, -3, -3);
  (-2, -3, -3); (-3, -3, 0); (-2, -3, 0); (-3, -3, 0); (-2, -3, 0):]
|}];;

[(d, g, i, k, p)
   for g = -2 to -2
   for p = -3 to 2 and d in [-3; -3; 0; 3] and i in []
   for g in [1; -3; 3; -3] and _ = -3 to -3 and k in [-1; 2; -1; g]
   when i > 0];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(d, g, i, k, p)
    for g = -2 to -2
    for p = -3 to 2 and d in [|-3; -3; 0; 3|] and i in [||]
    for g in [|1; -3; 3; -3|] and _ = -3 to -3 and k in [|-1; 2; -1; g|]
    when i > 0|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(d, g, i, k, p)
    for g = -2 to -2
    for p = -3 to 2 and d in [:-3; -3; 0; 3:] and i in [::]
    for g in [:1; -3; 3; -3:] and _ = -3 to -3 and k in [:-1; 2; -1; g:]
    when i > 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(f, t) for f in [-1; -3; 0] for t = f to -2];;
[%%expect{|
- : (int * int) list = [(-3, -3); (-3, -2)]
|}];;

[|(f, t) for f in [|-1; -3; 0|] for t = f to -2|];;
[%%expect{|
- : (int * int) array = [|(-3, -3); (-3, -2)|]
|}];;

[:(f, t) for f in [:-1; -3; 0:] for t = f to -2:];;
[%%expect{|
- : (int * int) iarray = [:(-3, -3); (-3, -2):]
|}];;

[(a, d, k)
   for d = 3 downto 3
   for a in [-3; -3; -3; -2; 1; 2; 0]
   for d in [1]
   for k in [2; -3; 2; 2; 0; 0]
   when abs d mod 2 = 0];;
[%%expect{|
Lines 1-6, characters 0-24:
1 | [(a, d, k)
2 |    for d = 3 downto 3
3 |    for a in [-3; -3; -3; -2; 1; 2; 0]
4 |    for d in [1]
5 |    for k in [2; -3; 2; 2; 0; 0]
6 |    when abs d mod 2 = 0]..
Warning 26 [unused-var]: unused variable d.

- : (int * int * int) list = []
|}];;

[|(a, d, k)
    for d = 3 downto 3
    for a in [|-3; -3; -3; -2; 1; 2; 0|]
    for d in [|1|]
    for k in [|2; -3; 2; 2; 0; 0|]
    when abs d mod 2 = 0|];;
[%%expect{|
Lines 1-6, characters 0-26:
1 | [|(a, d, k)
2 |     for d = 3 downto 3
3 |     for a in [|-3; -3; -3; -2; 1; 2; 0|]
4 |     for d in [|1|]
5 |     for k in [|2; -3; 2; 2; 0; 0|]
6 |     when abs d mod 2 = 0|]..
Warning 26 [unused-var]: unused variable d.

- : (int * int * int) array = [||]
|}];;

[:(a, d, k)
    for d = 3 downto 3
    for a in [:-3; -3; -3; -2; 1; 2; 0:]
    for d in [:1:]
    for k in [:2; -3; 2; 2; 0; 0:]
    when abs d mod 2 = 0:];;
[%%expect{|
Lines 1-6, characters 0-26:
1 | [:(a, d, k)
2 |     for d = 3 downto 3
3 |     for a in [:-3; -3; -3; -2; 1; 2; 0:]
4 |     for d in [:1:]
5 |     for k in [:2; -3; 2; 2; 0; 0:]
6 |     when abs d mod 2 = 0:]..
Warning 26 [unused-var]: unused variable d.

- : (int * int * int) iarray = [::]
|}];;

[(e, i, j, k, w, z)
   for k in [3; 3; 3; 1; -3; 2] and w in [1]
   for e = k to -1
   for z in [-2; -2; 2]
   for i = -3 downto 0 and w in [3; -2; 0; 3; 0]
   for j in [3; z; -1; 0; -1] and i = -1 to 0];;
[%%expect{|
Line 2, characters 36-37:
2 |    for k in [3; 3; 3; 1; -3; 2] and w in [1]
                                        ^
Warning 26 [unused-var]: unused variable w.

Lines 1-6, characters 0-46:
1 | [(e, i, j, k, w, z)
2 |    for k in [3; 3; 3; 1; -3; 2] and w in [1]
3 |    for e = k to -1
4 |    for z in [-2; -2; 2]
5 |    for i = -3 downto 0 and w in [3; -2; 0; 3; 0]
6 |    for j in [3; z; -1; 0; -1] and i = -1 to 0]..
Warning 26 [unused-var]: unused variable i.

- : (int * int * int * int * int * int) list = []
|}];;

[|(e, i, j, k, w, z)
    for k in [|3; 3; 3; 1; -3; 2|] and w in [|1|]
    for e = k to -1
    for z in [|-2; -2; 2|]
    for i = -3 downto 0 and w in [|3; -2; 0; 3; 0|]
    for j in [|3; z; -1; 0; -1|] and i = -1 to 0|];;
[%%expect{|
Line 2, characters 39-40:
2 |     for k in [|3; 3; 3; 1; -3; 2|] and w in [|1|]
                                           ^
Warning 26 [unused-var]: unused variable w.

Lines 1-6, characters 0-50:
1 | [|(e, i, j, k, w, z)
2 |     for k in [|3; 3; 3; 1; -3; 2|] and w in [|1|]
3 |     for e = k to -1
4 |     for z in [|-2; -2; 2|]
5 |     for i = -3 downto 0 and w in [|3; -2; 0; 3; 0|]
6 |     for j in [|3; z; -1; 0; -1|] and i = -1 to 0|]..
Warning 26 [unused-var]: unused variable i.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(e, i, j, k, w, z)
    for k in [:3; 3; 3; 1; -3; 2:] and w in [:1:]
    for e = k to -1
    for z in [:-2; -2; 2:]
    for i = -3 downto 0 and w in [:3; -2; 0; 3; 0:]
    for j in [:3; z; -1; 0; -1:] and i = -1 to 0:];;
[%%expect{|
Line 2, characters 39-40:
2 |     for k in [:3; 3; 3; 1; -3; 2:] and w in [:1:]
                                           ^
Warning 26 [unused-var]: unused variable w.

Lines 1-6, characters 0-50:
1 | [:(e, i, j, k, w, z)
2 |     for k in [:3; 3; 3; 1; -3; 2:] and w in [:1:]
3 |     for e = k to -1
4 |     for z in [:-2; -2; 2:]
5 |     for i = -3 downto 0 and w in [:3; -2; 0; 3; 0:]
6 |     for j in [:3; z; -1; 0; -1:] and i = -1 to 0:]..
Warning 26 [unused-var]: unused variable i.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(d, h, t, x)
   for x = -2 downto -3
   and d in [-3; -3; 3; 2; 0; -2; -1]
   and h in [0; -3; -3; -1; -2]
   for h = -3 downto -1
   and t in [-2; d; h; 3; 0; 1]
   and _ = 3 downto 2];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(d, h, t, x)
    for x = -2 downto -3
    and d in [|-3; -3; 3; 2; 0; -2; -1|]
    and h in [|0; -3; -3; -1; -2|]
    for h = -3 downto -1
    and t in [|-2; d; h; 3; 0; 1|]
    and _ = 3 downto 2|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(d, h, t, x)
    for x = -2 downto -3
    and d in [:-3; -3; 3; 2; 0; -2; -1:]
    and h in [:0; -3; -3; -1; -2:]
    for h = -3 downto -1
    and t in [:-2; d; h; 3; 0; 1:]
    and _ = 3 downto 2:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(e, l, r) for r = -1 downto -2 and l in [3] and e in [2]];;
[%%expect{|
- : (int * int * int) list = [(2, 3, -1); (2, 3, -2)]
|}];;

[|(e, l, r) for r = -1 downto -2 and l in [|3|] and e in [|2|]|];;
[%%expect{|
- : (int * int * int) array = [|(2, 3, -1); (2, 3, -2)|]
|}];;

[:(e, l, r) for r = -1 downto -2 and l in [:3:] and e in [:2:]:];;
[%%expect{|
- : (int * int * int) iarray = [:(2, 3, -1); (2, 3, -2):]
|}];;

[n for _ = 3 downto -1 and n in [2]];;
[%%expect{|
- : int list = [2; 2; 2; 2; 2]
|}];;

[|n for _ = 3 downto -1 and n in [|2|]|];;
[%%expect{|
- : int array = [|2; 2; 2; 2; 2|]
|}];;

[:n for _ = 3 downto -1 and n in [:2:]:];;
[%%expect{|
- : int iarray = [:2; 2; 2; 2; 2:]
|}];;

[(a, e, h, i, l, p)
   for _ = 3 downto 3
   for i in [1] and l in [3; 3; 0; -3; -2]
   for p in [-1; 0; 0]
   for a = 3 downto 1 and e = -3 to -3
   for a in [-1] and h in []];;
[%%expect{|
Lines 1-6, characters 0-29:
1 | [(a, e, h, i, l, p)
2 |    for _ = 3 downto 3
3 |    for i in [1] and l in [3; 3; 0; -3; -2]
4 |    for p in [-1; 0; 0]
5 |    for a = 3 downto 1 and e = -3 to -3
6 |    for a in [-1] and h in []]..
Warning 26 [unused-var]: unused variable a.

- : (int * int * 'a * int * int * int) list = []
|}];;

[|(a, e, h, i, l, p)
    for _ = 3 downto 3
    for i in [|1|] and l in [|3; 3; 0; -3; -2|]
    for p in [|-1; 0; 0|]
    for a = 3 downto 1 and e = -3 to -3
    for a in [|-1|] and h in [||]|];;
[%%expect{|
Lines 1-6, characters 0-35:
1 | [|(a, e, h, i, l, p)
2 |     for _ = 3 downto 3
3 |     for i in [|1|] and l in [|3; 3; 0; -3; -2|]
4 |     for p in [|-1; 0; 0|]
5 |     for a = 3 downto 1 and e = -3 to -3
6 |     for a in [|-1|] and h in [||]|]..
Warning 26 [unused-var]: unused variable a.

- : (int * int * '_weak56 * int * int * int) array = [||]
|}];;

[:(a, e, h, i, l, p)
    for _ = 3 downto 3
    for i in [:1:] and l in [:3; 3; 0; -3; -2:]
    for p in [:-1; 0; 0:]
    for a = 3 downto 1 and e = -3 to -3
    for a in [:-1:] and h in [::]:];;
[%%expect{|
Lines 1-6, characters 0-35:
1 | [:(a, e, h, i, l, p)
2 |     for _ = 3 downto 3
3 |     for i in [:1:] and l in [:3; 3; 0; -3; -2:]
4 |     for p in [:-1; 0; 0:]
5 |     for a = 3 downto 1 and e = -3 to -3
6 |     for a in [:-1:] and h in [::]:]..
Warning 26 [unused-var]: unused variable a.

- : (int * int * 'a * int * int * int) iarray = [::]
|}];;

[(c, f, m, s, x)
   for s in [1; -3; -2; -1; 3; 1; 2]
   for m = 3 to -3
   when s > 0
   for c in [] and x = -2 downto 0
   for f = -3 downto 2];;
[%%expect{|
- : ('a * int * int * int * int) list = []
|}];;

[|(c, f, m, s, x)
    for s in [|1; -3; -2; -1; 3; 1; 2|]
    for m = 3 to -3
    when s > 0
    for c in [||] and x = -2 downto 0
    for f = -3 downto 2|];;
[%%expect{|
- : ('_weak57 * int * int * int * int) array = [||]
|}];;

[:(c, f, m, s, x)
    for s in [:1; -3; -2; -1; 3; 1; 2:]
    for m = 3 to -3
    when s > 0
    for c in [::] and x = -2 downto 0
    for f = -3 downto 2:];;
[%%expect{|
- : ('a * int * int * int * int) iarray = [::]
|}];;

[(a, c, o, r, v)
   for o = 2 downto -3
   for c in [3; 3; 0; o; 0; -3]
   for r = c to o
   for v = -3 downto -2 and a = -2 downto 3
   when abs r mod 2 = 0];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(a, c, o, r, v)
    for o = 2 downto -3
    for c in [|3; 3; 0; o; 0; -3|]
    for r = c to o
    for v = -3 downto -2 and a = -2 downto 3
    when abs r mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(a, c, o, r, v)
    for o = 2 downto -3
    for c in [:3; 3; 0; o; 0; -3:]
    for r = c to o
    for v = -3 downto -2 and a = -2 downto 3
    when abs r mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(g, k, l, p, u, z)
   for p in [3; 3; 3; 0] and l in [1; -3; 2]
   for k in [p; p; p; -3]
   for z in [-3; -1; 2; 2; 1]
   for u = -3 downto -2
   for g in [3; 3; -3]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(g, k, l, p, u, z)
    for p in [|3; 3; 3; 0|] and l in [|1; -3; 2|]
    for k in [|p; p; p; -3|]
    for z in [|-3; -1; 2; 2; 1|]
    for u = -3 downto -2
    for g in [|3; 3; -3|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(g, k, l, p, u, z)
    for p in [:3; 3; 3; 0:] and l in [:1; -3; 2:]
    for k in [:p; p; p; -3:]
    for z in [:-3; -1; 2; 2; 1:]
    for u = -3 downto -2
    for g in [:3; 3; -3:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(d, g, j, m, n, o, u, v, w)
   for _ = 2 downto 2 and n = -3 to -1 and g = -1 downto -1
   for j = 3 to 2 and w in [3; g; -2]
   for u in [1; 2; n] and m in [j; -3; -3; 3; -3; 0] and d = -1 to -2
   for o in [-2; -3; 0; 1; 0; -3; 1] and v = 0 to -3];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int) list = []
|}];;

[|(d, g, j, m, n, o, u, v, w)
    for _ = 2 downto 2 and n = -3 to -1 and g = -1 downto -1
    for j = 3 to 2 and w in [|3; g; -2|]
    for u in [|1; 2; n|] and m in [|j; -3; -3; 3; -3; 0|] and d = -1 to -2
    for o in [|-2; -3; 0; 1; 0; -3; 1|] and v = 0 to -3|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(d, g, j, m, n, o, u, v, w)
    for _ = 2 downto 2 and n = -3 to -1 and g = -1 downto -1
    for j = 3 to 2 and w in [:3; g; -2:]
    for u in [:1; 2; n:] and m in [:j; -3; -3; 3; -3; 0:] and d = -1 to -2
    for o in [:-2; -3; 0; 1; 0; -3; 1:] and v = 0 to -3:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(i, r, z) for z in [1; 2] and r = -1 downto 3 and i = 0 to 1];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(i, r, z) for z in [|1; 2|] and r = -1 downto 3 and i = 0 to 1|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(i, r, z) for z in [:1; 2:] and r = -1 downto 3 and i = 0 to 1:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(a, b, i, m, t, v)
   for b = -3 to 0 and m in [-3; 1; 1; -3; 3; 0]
   when abs b mod 2 = 0
   for a in [0] and b in [b; -1]
   for v = -3 downto 3
   for t = 1 downto 0 and i = 1 downto 2];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(a, b, i, m, t, v)
    for b = -3 to 0 and m in [|-3; 1; 1; -3; 3; 0|]
    when abs b mod 2 = 0
    for a in [|0|] and b in [|b; -1|]
    for v = -3 downto 3
    for t = 1 downto 0 and i = 1 downto 2|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, b, i, m, t, v)
    for b = -3 to 0 and m in [:-3; 1; 1; -3; 3; 0:]
    when abs b mod 2 = 0
    for a in [:0:] and b in [:b; -1:]
    for v = -3 downto 3
    for t = 1 downto 0 and i = 1 downto 2:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(k, o, v) for v = 2 downto 0 and k in [-3; 0; 1] and o = 2 downto 0];;
[%%expect{|
- : (int * int * int) list =
[(-3, 2, 2); (-3, 1, 2); (-3, 0, 2); (0, 2, 2); (0, 1, 2); (0, 0, 2);
 (1, 2, 2); (1, 1, 2); (1, 0, 2); (-3, 2, 1); (-3, 1, 1); (-3, 0, 1);
 (0, 2, 1); (0, 1, 1); (0, 0, 1); (1, 2, 1); (1, 1, 1); (1, 0, 1);
 (-3, 2, 0); (-3, 1, 0); (-3, 0, 0); (0, 2, 0); (0, 1, 0); (0, 0, 0);
 (1, 2, 0); (1, 1, 0); (1, 0, 0)]
|}];;

[|(k, o, v) for v = 2 downto 0 and k in [|-3; 0; 1|] and o = 2 downto 0|];;
[%%expect{|
- : (int * int * int) array =
[|(-3, 2, 2); (-3, 1, 2); (-3, 0, 2); (0, 2, 2); (0, 1, 2); (0, 0, 2);
  (1, 2, 2); (1, 1, 2); (1, 0, 2); (-3, 2, 1); (-3, 1, 1); (-3, 0, 1);
  (0, 2, 1); (0, 1, 1); (0, 0, 1); (1, 2, 1); (1, 1, 1); (1, 0, 1);
  (-3, 2, 0); (-3, 1, 0); (-3, 0, 0); (0, 2, 0); (0, 1, 0); (0, 0, 0);
  (1, 2, 0); (1, 1, 0); (1, 0, 0)|]
|}];;

[:(k, o, v) for v = 2 downto 0 and k in [:-3; 0; 1:] and o = 2 downto 0:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-3, 2, 2); (-3, 1, 2); (-3, 0, 2); (0, 2, 2); (0, 1, 2); (0, 0, 2);
  (1, 2, 2); (1, 1, 2); (1, 0, 2); (-3, 2, 1); (-3, 1, 1); (-3, 0, 1);
  (0, 2, 1); (0, 1, 1); (0, 0, 1); (1, 2, 1); (1, 1, 1); (1, 0, 1);
  (-3, 2, 0); (-3, 1, 0); (-3, 0, 0); (0, 2, 0); (0, 1, 0); (0, 0, 0);
  (1, 2, 0); (1, 1, 0); (1, 0, 0):]
|}];;

[(f, m, q)
   for m in [-1; -2; 1]
   when m < 0
   when abs m mod 2 = 0
   for q = 3 to -1 and f in [0; -3; -3; 0; 3]];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(f, m, q)
    for m in [|-1; -2; 1|]
    when m < 0
    when abs m mod 2 = 0
    for q = 3 to -1 and f in [|0; -3; -3; 0; 3|]|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(f, m, q)
    for m in [:-1; -2; 1:]
    when m < 0
    when abs m mod 2 = 0
    for q = 3 to -1 and f in [:0; -3; -3; 0; 3:]:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(h, l) for l in [3; 1; -2; 1; -1; -2; -1] and h in [1; -2; -1; -1; 1]];;
[%%expect{|
- : (int * int) list =
[(1, 3); (-2, 3); (-1, 3); (-1, 3); (1, 3); (1, 1); (-2, 1); (-1, 1);
 (-1, 1); (1, 1); (1, -2); (-2, -2); (-1, -2); (-1, -2); (1, -2); (1, 1);
 (-2, 1); (-1, 1); (-1, 1); (1, 1); (1, -1); (-2, -1); (-1, -1); (-1, -1);
 (1, -1); (1, -2); (-2, -2); (-1, -2); (-1, -2); (1, -2); (1, -1); (-2, -1);
 (-1, -1); (-1, -1); (1, -1)]
|}];;

[|(h, l) for l in [|3; 1; -2; 1; -1; -2; -1|] and h in [|1; -2; -1; -1; 1|]|];;
[%%expect{|
- : (int * int) array =
[|(1, 3); (-2, 3); (-1, 3); (-1, 3); (1, 3); (1, 1); (-2, 1); (-1, 1);
  (-1, 1); (1, 1); (1, -2); (-2, -2); (-1, -2); (-1, -2); (1, -2); (1, 1);
  (-2, 1); (-1, 1); (-1, 1); (1, 1); (1, -1); (-2, -1); (-1, -1); (-1, -1);
  (1, -1); (1, -2); (-2, -2); (-1, -2); (-1, -2); (1, -2); (1, -1); (-2, -1);
  (-1, -1); (-1, -1); (1, -1)|]
|}];;

[:(h, l) for l in [:3; 1; -2; 1; -1; -2; -1:] and h in [:1; -2; -1; -1; 1:]:];;
[%%expect{|
- : (int * int) iarray =
[:(1, 3); (-2, 3); (-1, 3); (-1, 3); (1, 3); (1, 1); (-2, 1); (-1, 1);
  (-1, 1); (1, 1); (1, -2); (-2, -2); (-1, -2); (-1, -2); (1, -2); (1, 1);
  (-2, 1); (-1, 1); (-1, 1); (1, 1); (1, -1); (-2, -1); (-1, -1); (-1, -1);
  (1, -1); (1, -2); (-2, -2); (-1, -2); (-1, -2); (1, -2); (1, -1); (-2, -1);
  (-1, -1); (-1, -1); (1, -1):]
|}];;

[(a, f, j)
   for a = 3 downto 2
   when a > 0
   for j in [-3; 1; -1; 2; -1; 0; 1] and f in [2]
   when a < 0
   when abs j mod 2 = 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(a, f, j)
    for a = 3 downto 2
    when a > 0
    for j in [|-3; 1; -1; 2; -1; 0; 1|] and f in [|2|]
    when a < 0
    when abs j mod 2 = 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(a, f, j)
    for a = 3 downto 2
    when a > 0
    for j in [:-3; 1; -1; 2; -1; 0; 1:] and f in [:2:]
    when a < 0
    when abs j mod 2 = 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(b, h, j, k, n, p, u, z)
   for h = 2 downto -1 and b = 2 downto 2
   for u = 0 downto -3 and _ in [b; -2; h; -1; 2; -1] and p in [-1; 0; 2]
   for z in [2] and j in [] and k in [3; 1; -2]
   for k in [] and z in [3; 2; 0; 0; -2] and n = -1 to 3];;
[%%expect{|
Line 4, characters 7-8:
4 |    for z in [2] and j in [] and k in [3; 1; -2]
           ^
Warning 26 [unused-var]: unused variable z.

Line 4, characters 32-33:
4 |    for z in [2] and j in [] and k in [3; 1; -2]
                                    ^
Warning 26 [unused-var]: unused variable k.

- : (int * int * 'a * 'b * int * int * int * int) list = []
|}];;

[|(b, h, j, k, n, p, u, z)
    for h = 2 downto -1 and b = 2 downto 2
    for u = 0 downto -3 and _ in [|b; -2; h; -1; 2; -1|] and p in [|-1; 0; 2|]
    for z in [|2|] and j in [||] and k in [|3; 1; -2|]
    for k in [||] and z in [|3; 2; 0; 0; -2|] and n = -1 to 3|];;
[%%expect{|
Line 4, characters 8-9:
4 |     for z in [|2|] and j in [||] and k in [|3; 1; -2|]
            ^
Warning 26 [unused-var]: unused variable z.

Line 4, characters 37-38:
4 |     for z in [|2|] and j in [||] and k in [|3; 1; -2|]
                                         ^
Warning 26 [unused-var]: unused variable k.

- : (int * int * '_weak58 * '_weak59 * int * int * int * int) array = [||]
|}];;

[:(b, h, j, k, n, p, u, z)
    for h = 2 downto -1 and b = 2 downto 2
    for u = 0 downto -3 and _ in [:b; -2; h; -1; 2; -1:] and p in [:-1; 0; 2:]
    for z in [:2:] and j in [::] and k in [:3; 1; -2:]
    for k in [::] and z in [:3; 2; 0; 0; -2:] and n = -1 to 3:];;
[%%expect{|
Line 4, characters 8-9:
4 |     for z in [:2:] and j in [::] and k in [:3; 1; -2:]
            ^
Warning 26 [unused-var]: unused variable z.

Line 4, characters 37-38:
4 |     for z in [:2:] and j in [::] and k in [:3; 1; -2:]
                                         ^
Warning 26 [unused-var]: unused variable k.

- : (int * int * 'a * 'b * int * int * int * int) iarray = [::]
|}];;

[(a, n, q, r, s, t)
   for r = -3 to -1
   for t = 0 to 0 and q in [-2; 2; -1; 2; 0; r; 1]
   when abs q mod 2 = 0
   for s = -1 to 2 and q = -2 downto 0
   for n = -3 downto -1 and a = 0 downto 3];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(a, n, q, r, s, t)
    for r = -3 to -1
    for t = 0 to 0 and q in [|-2; 2; -1; 2; 0; r; 1|]
    when abs q mod 2 = 0
    for s = -1 to 2 and q = -2 downto 0
    for n = -3 downto -1 and a = 0 downto 3|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, n, q, r, s, t)
    for r = -3 to -1
    for t = 0 to 0 and q in [:-2; 2; -1; 2; 0; r; 1:]
    when abs q mod 2 = 0
    for s = -1 to 2 and q = -2 downto 0
    for n = -3 downto -1 and a = 0 downto 3:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(e, j, q) for j = 2 downto 0 and q in [3; 0; -2] and e = 3 downto -1];;
[%%expect{|
- : (int * int * int) list =
[(3, 2, 3); (2, 2, 3); (1, 2, 3); (0, 2, 3); (-1, 2, 3); (3, 2, 0);
 (2, 2, 0); (1, 2, 0); (0, 2, 0); (-1, 2, 0); (3, 2, -2); (2, 2, -2);
 (1, 2, -2); (0, 2, -2); (-1, 2, -2); (3, 1, 3); (2, 1, 3); (1, 1, 3);
 (0, 1, 3); (-1, 1, 3); (3, 1, 0); (2, 1, 0); (1, 1, 0); (0, 1, 0);
 (-1, 1, 0); (3, 1, -2); (2, 1, -2); (1, 1, -2); (0, 1, -2); (-1, 1, -2);
 (3, 0, 3); (2, 0, 3); (1, 0, 3); (0, 0, 3); (-1, 0, 3); (3, 0, 0);
 (2, 0, 0); (1, 0, 0); (0, 0, 0); (-1, 0, 0); (3, 0, -2); (2, 0, -2);
 (1, 0, -2); (0, 0, -2); (-1, 0, -2)]
|}];;

[|(e, j, q) for j = 2 downto 0 and q in [|3; 0; -2|] and e = 3 downto -1|];;
[%%expect{|
- : (int * int * int) array =
[|(3, 2, 3); (2, 2, 3); (1, 2, 3); (0, 2, 3); (-1, 2, 3); (3, 2, 0);
  (2, 2, 0); (1, 2, 0); (0, 2, 0); (-1, 2, 0); (3, 2, -2); (2, 2, -2);
  (1, 2, -2); (0, 2, -2); (-1, 2, -2); (3, 1, 3); (2, 1, 3); (1, 1, 3);
  (0, 1, 3); (-1, 1, 3); (3, 1, 0); (2, 1, 0); (1, 1, 0); (0, 1, 0);
  (-1, 1, 0); (3, 1, -2); (2, 1, -2); (1, 1, -2); (0, 1, -2); (-1, 1, -2);
  (3, 0, 3); (2, 0, 3); (1, 0, 3); (0, 0, 3); (-1, 0, 3); (3, 0, 0);
  (2, 0, 0); (1, 0, 0); (0, 0, 0); (-1, 0, 0); (3, 0, -2); (2, 0, -2);
  (1, 0, -2); (0, 0, -2); (-1, 0, -2)|]
|}];;

[:(e, j, q) for j = 2 downto 0 and q in [:3; 0; -2:] and e = 3 downto -1:];;
[%%expect{|
- : (int * int * int) iarray =
[:(3, 2, 3); (2, 2, 3); (1, 2, 3); (0, 2, 3); (-1, 2, 3); (3, 2, 0);
  (2, 2, 0); (1, 2, 0); (0, 2, 0); (-1, 2, 0); (3, 2, -2); (2, 2, -2);
  (1, 2, -2); (0, 2, -2); (-1, 2, -2); (3, 1, 3); (2, 1, 3); (1, 1, 3);
  (0, 1, 3); (-1, 1, 3); (3, 1, 0); (2, 1, 0); (1, 1, 0); (0, 1, 0);
  (-1, 1, 0); (3, 1, -2); (2, 1, -2); (1, 1, -2); (0, 1, -2); (-1, 1, -2);
  (3, 0, 3); (2, 0, 3); (1, 0, 3); (0, 0, 3); (-1, 0, 3); (3, 0, 0);
  (2, 0, 0); (1, 0, 0); (0, 0, 0); (-1, 0, 0); (3, 0, -2); (2, 0, -2);
  (1, 0, -2); (0, 0, -2); (-1, 0, -2):]
|}];;

[(j, o, r)
   for r in [-3; 0; -1; -3; 3; 0; -2] and j in [-3; 0; -2] and o in [-1; 1]];;
[%%expect{|
- : (int * int * int) list =
[(-3, -1, -3); (-3, 1, -3); (0, -1, -3); (0, 1, -3); (-2, -1, -3);
 (-2, 1, -3); (-3, -1, 0); (-3, 1, 0); (0, -1, 0); (0, 1, 0); (-2, -1, 0);
 (-2, 1, 0); (-3, -1, -1); (-3, 1, -1); (0, -1, -1); (0, 1, -1);
 (-2, -1, -1); (-2, 1, -1); (-3, -1, -3); (-3, 1, -3); (0, -1, -3);
 (0, 1, -3); (-2, -1, -3); (-2, 1, -3); (-3, -1, 3); (-3, 1, 3); (0, -1, 3);
 (0, 1, 3); (-2, -1, 3); (-2, 1, 3); (-3, -1, 0); (-3, 1, 0); (0, -1, 0);
 (0, 1, 0); (-2, -1, 0); (-2, 1, 0); (-3, -1, -2); (-3, 1, -2); (0, -1, -2);
 (0, 1, -2); (-2, -1, -2); (-2, 1, -2)]
|}];;

[|(j, o, r)
    for r in [|-3; 0; -1; -3; 3; 0; -2|]
    and j in [|-3; 0; -2|]
    and o in [|-1; 1|]|];;
[%%expect{|
- : (int * int * int) array =
[|(-3, -1, -3); (-3, 1, -3); (0, -1, -3); (0, 1, -3); (-2, -1, -3);
  (-2, 1, -3); (-3, -1, 0); (-3, 1, 0); (0, -1, 0); (0, 1, 0); (-2, -1, 0);
  (-2, 1, 0); (-3, -1, -1); (-3, 1, -1); (0, -1, -1); (0, 1, -1);
  (-2, -1, -1); (-2, 1, -1); (-3, -1, -3); (-3, 1, -3); (0, -1, -3);
  (0, 1, -3); (-2, -1, -3); (-2, 1, -3); (-3, -1, 3); (-3, 1, 3); (0, -1, 3);
  (0, 1, 3); (-2, -1, 3); (-2, 1, 3); (-3, -1, 0); (-3, 1, 0); (0, -1, 0);
  (0, 1, 0); (-2, -1, 0); (-2, 1, 0); (-3, -1, -2); (-3, 1, -2); (0, -1, -2);
  (0, 1, -2); (-2, -1, -2); (-2, 1, -2)|]
|}];;

[:(j, o, r)
    for r in [:-3; 0; -1; -3; 3; 0; -2:]
    and j in [:-3; 0; -2:]
    and o in [:-1; 1:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-3, -1, -3); (-3, 1, -3); (0, -1, -3); (0, 1, -3); (-2, -1, -3);
  (-2, 1, -3); (-3, -1, 0); (-3, 1, 0); (0, -1, 0); (0, 1, 0); (-2, -1, 0);
  (-2, 1, 0); (-3, -1, -1); (-3, 1, -1); (0, -1, -1); (0, 1, -1);
  (-2, -1, -1); (-2, 1, -1); (-3, -1, -3); (-3, 1, -3); (0, -1, -3);
  (0, 1, -3); (-2, -1, -3); (-2, 1, -3); (-3, -1, 3); (-3, 1, 3); (0, -1, 3);
  (0, 1, 3); (-2, -1, 3); (-2, 1, 3); (-3, -1, 0); (-3, 1, 0); (0, -1, 0);
  (0, 1, 0); (-2, -1, 0); (-2, 1, 0); (-3, -1, -2); (-3, 1, -2); (0, -1, -2);
  (0, 1, -2); (-2, -1, -2); (-2, 1, -2):]
|}];;

[(a, e, i, o, r, t)
   for r = -2 downto -2 and i in [0; -2; -2; 2; -2; 1]
   for a = 0 to -2 and o in [0]
   for r = 0 to -2
   for e in [-2; -3; 3; 1] and t = -1 to -1
   when abs o mod 2 = 0];;
[%%expect{|
Lines 1-6, characters 0-24:
1 | [(a, e, i, o, r, t)
2 |    for r = -2 downto -2 and i in [0; -2; -2; 2; -2; 1]
3 |    for a = 0 to -2 and o in [0]
4 |    for r = 0 to -2
5 |    for e in [-2; -3; 3; 1] and t = -1 to -1
6 |    when abs o mod 2 = 0]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int * int * int) list = []
|}];;

[|(a, e, i, o, r, t)
    for r = -2 downto -2 and i in [|0; -2; -2; 2; -2; 1|]
    for a = 0 to -2 and o in [|0|]
    for r = 0 to -2
    for e in [|-2; -3; 3; 1|] and t = -1 to -1
    when abs o mod 2 = 0|];;
[%%expect{|
Lines 1-6, characters 0-26:
1 | [|(a, e, i, o, r, t)
2 |     for r = -2 downto -2 and i in [|0; -2; -2; 2; -2; 1|]
3 |     for a = 0 to -2 and o in [|0|]
4 |     for r = 0 to -2
5 |     for e in [|-2; -3; 3; 1|] and t = -1 to -1
6 |     when abs o mod 2 = 0|]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, e, i, o, r, t)
    for r = -2 downto -2 and i in [:0; -2; -2; 2; -2; 1:]
    for a = 0 to -2 and o in [:0:]
    for r = 0 to -2
    for e in [:-2; -3; 3; 1:] and t = -1 to -1
    when abs o mod 2 = 0:];;
[%%expect{|
Lines 1-6, characters 0-26:
1 | [:(a, e, i, o, r, t)
2 |     for r = -2 downto -2 and i in [:0; -2; -2; 2; -2; 1:]
3 |     for a = 0 to -2 and o in [:0:]
4 |     for r = 0 to -2
5 |     for e in [:-2; -3; 3; 1:] and t = -1 to -1
6 |     when abs o mod 2 = 0:]..
Warning 26 [unused-var]: unused variable r.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(f, k, t, y)
   for k in [1; -1; -1; -1; 0; -3; 2]
   for t = -3 to -2
   for k = -1 downto 3 and f = 3 downto k
   for y in [2; -3]];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(f, k, t, y)
    for k in [|1; -1; -1; -1; 0; -3; 2|]
    for t = -3 to -2
    for k = -1 downto 3 and f = 3 downto k
    for y in [|2; -3|]|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(f, k, t, y)
    for k in [:1; -1; -1; -1; 0; -3; 2:]
    for t = -3 to -2
    for k = -1 downto 3 and f = 3 downto k
    for y in [:2; -3:]:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(d, g, m, p)
   for g = -3 to -1 and d in [1; -2; 1] and m = -3 to 1
   for p = 2 to -3];;
[%%expect{|
- : (int * int * int * int) list = []
|}];;

[|(d, g, m, p)
    for g = -3 to -1 and d in [|1; -2; 1|] and m = -3 to 1
    for p = 2 to -3|];;
[%%expect{|
- : (int * int * int * int) array = [||]
|}];;

[:(d, g, m, p)
    for g = -3 to -1 and d in [:1; -2; 1:] and m = -3 to 1
    for p = 2 to -3:];;
[%%expect{|
- : (int * int * int * int) iarray = [::]
|}];;

[(k, y) for y = -1 to 3 and k = 3 to 2];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(k, y) for y = -1 to 3 and k = 3 to 2|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(k, y) for y = -1 to 3 and k = 3 to 2:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(f, p) for f = 3 to -1 and p = 2 downto -2];;
[%%expect{|
- : (int * int) list = []
|}];;

[|(f, p) for f = 3 to -1 and p = 2 downto -2|];;
[%%expect{|
- : (int * int) array = [||]
|}];;

[:(f, p) for f = 3 to -1 and p = 2 downto -2:];;
[%%expect{|
- : (int * int) iarray = [::]
|}];;

[(f, k, q, u, v, z)
   for f = 1 to 3 and k in [0; 3; 1; 3; 2; 2; 0]
   when abs k mod 2 = 0
   for z = -3 to 0 and v in [1; 0]
   for q = -2 downto -1 and u = -3 to 1
   when f < 0];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(f, k, q, u, v, z)
    for f = 1 to 3 and k in [|0; 3; 1; 3; 2; 2; 0|]
    when abs k mod 2 = 0
    for z = -3 to 0 and v in [|1; 0|]
    for q = -2 downto -1 and u = -3 to 1
    when f < 0|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(f, k, q, u, v, z)
    for f = 1 to 3 and k in [:0; 3; 1; 3; 2; 2; 0:]
    when abs k mod 2 = 0
    for z = -3 to 0 and v in [:1; 0:]
    for q = -2 downto -1 and u = -3 to 1
    when f < 0:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(e, k) for e = -3 to 0 and k in [-1; -2; -1] when abs k mod 2 = 0];;
[%%expect{|
- : (int * int) list = [(-3, -2); (-2, -2); (-1, -2); (0, -2)]
|}];;

[|(e, k) for e = -3 to 0 and k in [|-1; -2; -1|] when abs k mod 2 = 0|];;
[%%expect{|
- : (int * int) array = [|(-3, -2); (-2, -2); (-1, -2); (0, -2)|]
|}];;

[:(e, k) for e = -3 to 0 and k in [:-1; -2; -1:] when abs k mod 2 = 0:];;
[%%expect{|
- : (int * int) iarray = [:(-3, -2); (-2, -2); (-1, -2); (0, -2):]
|}];;

[(e, l, r, w, y)
   for l = 2 downto 2 and w = 1 to 3 and r in [2; -3] and y in [0; 3; -3]
   for e = 2 downto 2];;
[%%expect{|
- : (int * int * int * int * int) list =
[(2, 2, 2, 1, 0); (2, 2, 2, 1, 3); (2, 2, 2, 1, -3); (2, 2, -3, 1, 0);
 (2, 2, -3, 1, 3); (2, 2, -3, 1, -3); (2, 2, 2, 2, 0); (2, 2, 2, 2, 3);
 (2, 2, 2, 2, -3); (2, 2, -3, 2, 0); (2, 2, -3, 2, 3); (2, 2, -3, 2, -3);
 (2, 2, 2, 3, 0); (2, 2, 2, 3, 3); (2, 2, 2, 3, -3); (2, 2, -3, 3, 0);
 (2, 2, -3, 3, 3); (2, 2, -3, 3, -3)]
|}];;

[|(e, l, r, w, y)
    for l = 2 downto 2 and w = 1 to 3 and r in [|2; -3|] and y in [|0; 3; -3|]
    for e = 2 downto 2|];;
[%%expect{|
- : (int * int * int * int * int) array =
[|(2, 2, 2, 1, 0); (2, 2, 2, 1, 3); (2, 2, 2, 1, -3); (2, 2, -3, 1, 0);
  (2, 2, -3, 1, 3); (2, 2, -3, 1, -3); (2, 2, 2, 2, 0); (2, 2, 2, 2, 3);
  (2, 2, 2, 2, -3); (2, 2, -3, 2, 0); (2, 2, -3, 2, 3); (2, 2, -3, 2, -3);
  (2, 2, 2, 3, 0); (2, 2, 2, 3, 3); (2, 2, 2, 3, -3); (2, 2, -3, 3, 0);
  (2, 2, -3, 3, 3); (2, 2, -3, 3, -3)|]
|}];;

[:(e, l, r, w, y)
    for l = 2 downto 2 and w = 1 to 3 and r in [:2; -3:] and y in [:0; 3; -3:]
    for e = 2 downto 2:];;
[%%expect{|
- : (int * int * int * int * int) iarray =
[:(2, 2, 2, 1, 0); (2, 2, 2, 1, 3); (2, 2, 2, 1, -3); (2, 2, -3, 1, 0);
  (2, 2, -3, 1, 3); (2, 2, -3, 1, -3); (2, 2, 2, 2, 0); (2, 2, 2, 2, 3);
  (2, 2, 2, 2, -3); (2, 2, -3, 2, 0); (2, 2, -3, 2, 3); (2, 2, -3, 2, -3);
  (2, 2, 2, 3, 0); (2, 2, 2, 3, 3); (2, 2, 2, 3, -3); (2, 2, -3, 3, 0);
  (2, 2, -3, 3, 3); (2, 2, -3, 3, -3):]
|}];;

[(i, m, q, u, w, x)
   for i in [2; 2; -3; 2] and m = -2 to 0
   for m in [3; i; -2; -2; -3] and q in [-2; i; 2; -3; -3; -2]
   when q < 0
   for w in [3; 2; 1; 3; -2]
   for x = 3 to q and u = -3 to -2];;
[%%expect{|
Lines 1-6, characters 0-35:
1 | [(i, m, q, u, w, x)
2 |    for i in [2; 2; -3; 2] and m = -2 to 0
3 |    for m in [3; i; -2; -2; -3] and q in [-2; i; 2; -3; -3; -2]
4 |    when q < 0
5 |    for w in [3; 2; 1; 3; -2]
6 |    for x = 3 to q and u = -3 to -2]..
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int * int * int) list = []
|}];;

[|(i, m, q, u, w, x)
    for i in [|2; 2; -3; 2|] and m = -2 to 0
    for m in [|3; i; -2; -2; -3|] and q in [|-2; i; 2; -3; -3; -2|]
    when q < 0
    for w in [|3; 2; 1; 3; -2|]
    for x = 3 to q and u = -3 to -2|];;
[%%expect{|
Lines 1-6, characters 0-37:
1 | [|(i, m, q, u, w, x)
2 |     for i in [|2; 2; -3; 2|] and m = -2 to 0
3 |     for m in [|3; i; -2; -2; -3|] and q in [|-2; i; 2; -3; -3; -2|]
4 |     when q < 0
5 |     for w in [|3; 2; 1; 3; -2|]
6 |     for x = 3 to q and u = -3 to -2|]..
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int * int * int) array = [||]
|}];;

[:(i, m, q, u, w, x)
    for i in [:2; 2; -3; 2:] and m = -2 to 0
    for m in [:3; i; -2; -2; -3:] and q in [:-2; i; 2; -3; -3; -2:]
    when q < 0
    for w in [:3; 2; 1; 3; -2:]
    for x = 3 to q and u = -3 to -2:];;
[%%expect{|
Lines 1-6, characters 0-37:
1 | [:(i, m, q, u, w, x)
2 |     for i in [:2; 2; -3; 2:] and m = -2 to 0
3 |     for m in [:3; i; -2; -2; -3:] and q in [:-2; i; 2; -3; -3; -2:]
4 |     when q < 0
5 |     for w in [:3; 2; 1; 3; -2:]
6 |     for x = 3 to q and u = -3 to -2:]..
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(i, j, k, q, r, t, u, y)
   for j in [-2; -2; -2]
   for q = -1 downto 2 and r in [-2] and u in [-3; -2; j; -3; j; -3]
   for y in [j; 2; 3; 2; -1; 3; u] and t = 1 downto 1 and i = 1 to -1
   for k = 2 downto -3 and _ = u downto 1];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) list = []
|}];;

[|(i, j, k, q, r, t, u, y)
    for j in [|-2; -2; -2|]
    for q = -1 downto 2 and r in [|-2|] and u in [|-3; -2; j; -3; j; -3|]
    for y in [|j; 2; 3; 2; -1; 3; u|] and t = 1 downto 1 and i = 1 to -1
    for k = 2 downto -3 and _ = u downto 1|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(i, j, k, q, r, t, u, y)
    for j in [:-2; -2; -2:]
    for q = -1 downto 2 and r in [:-2:] and u in [:-3; -2; j; -3; j; -3:]
    for y in [:j; 2; 3; 2; -1; 3; u:] and t = 1 downto 1 and i = 1 to -1
    for k = 2 downto -3 and _ = u downto 1:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(j, m, n, p, r, v, z)
   for r in [2; -1; -2; -3; 1] and z in [-2; 0; 2; 0; 3]
   for m in [2] and n in [z; -3; 0; 1; 3]
   for j in [3] and v in [3; -1]
   for p = 1 to 3 and n in [-3; -1; 3; 3]
   for m in []];;
[%%expect{|
Line 3, characters 7-8:
3 |    for m in [2] and n in [z; -3; 0; 1; 3]
           ^
Warning 26 [unused-var]: unused variable m.

Line 3, characters 20-21:
3 |    for m in [2] and n in [z; -3; 0; 1; 3]
                        ^
Warning 26 [unused-var]: unused variable n.

- : (int * 'a * int * int * int * int * int) list = []
|}];;

[|(j, m, n, p, r, v, z)
    for r in [|2; -1; -2; -3; 1|] and z in [|-2; 0; 2; 0; 3|]
    for m in [|2|] and n in [|z; -3; 0; 1; 3|]
    for j in [|3|] and v in [|3; -1|]
    for p = 1 to 3 and n in [|-3; -1; 3; 3|]
    for m in [||]|];;
[%%expect{|
Line 3, characters 8-9:
3 |     for m in [|2|] and n in [|z; -3; 0; 1; 3|]
            ^
Warning 26 [unused-var]: unused variable m.

Line 3, characters 23-24:
3 |     for m in [|2|] and n in [|z; -3; 0; 1; 3|]
                           ^
Warning 26 [unused-var]: unused variable n.

- : (int * '_weak60 * int * int * int * int * int) array = [||]
|}];;

[:(j, m, n, p, r, v, z)
    for r in [:2; -1; -2; -3; 1:] and z in [:-2; 0; 2; 0; 3:]
    for m in [:2:] and n in [:z; -3; 0; 1; 3:]
    for j in [:3:] and v in [:3; -1:]
    for p = 1 to 3 and n in [:-3; -1; 3; 3:]
    for m in [::]:];;
[%%expect{|
Line 3, characters 8-9:
3 |     for m in [:2:] and n in [:z; -3; 0; 1; 3:]
            ^
Warning 26 [unused-var]: unused variable m.

Line 3, characters 23-24:
3 |     for m in [:2:] and n in [:z; -3; 0; 1; 3:]
                           ^
Warning 26 [unused-var]: unused variable n.

- : (int * 'a * int * int * int * int * int) iarray = [::]
|}];;

[(n, q, v) for q = 2 downto 2 and n = -3 to 0 for v in []];;
[%%expect{|
- : (int * int * 'a) list = []
|}];;

[|(n, q, v) for q = 2 downto 2 and n = -3 to 0 for v in [||]|];;
[%%expect{|
- : (int * int * '_weak61) array = [||]
|}];;

[:(n, q, v) for q = 2 downto 2 and n = -3 to 0 for v in [::]:];;
[%%expect{|
- : (int * int * 'a) iarray = [::]
|}];;

[(a, c, f, i, m, s, v, w, y)
   for i in [-2; 3; -1; 0; 2; 2; -3]
   for y = -3 downto -2 and m = -2 to -2 and v = 0 to 0
   for c in [0; 3] and m = 2 to -1 and w = 0 downto 0
   for a in [0; 2; -2; 0; 2] and f in [1; 2; 1; -3] and s = 1 downto 0];;
[%%expect{|
Lines 1-5, characters 0-71:
1 | [(a, c, f, i, m, s, v, w, y)
2 |    for i in [-2; 3; -1; 0; 2; 2; -3]
3 |    for y = -3 downto -2 and m = -2 to -2 and v = 0 to 0
4 |    for c in [0; 3] and m = 2 to -1 and w = 0 downto 0
5 |    for a in [0; 2; -2; 0; 2] and f in [1; 2; 1; -3] and s = 1 downto 0]..
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int * int * int * int * int * int) list = []
|}];;

[|(a, c, f, i, m, s, v, w, y)
    for i in [|-2; 3; -1; 0; 2; 2; -3|]
    for y = -3 downto -2 and m = -2 to -2 and v = 0 to 0
    for c in [|0; 3|] and m = 2 to -1 and w = 0 downto 0
    for a in [|0; 2; -2; 0; 2|] and f in [|1; 2; 1; -3|] and s = 1 downto 0|];;
[%%expect{|
Lines 1-5, characters 0-77:
1 | [|(a, c, f, i, m, s, v, w, y)
2 |     for i in [|-2; 3; -1; 0; 2; 2; -3|]
3 |     for y = -3 downto -2 and m = -2 to -2 and v = 0 to 0
4 |     for c in [|0; 3|] and m = 2 to -1 and w = 0 downto 0
5 |     for a in [|0; 2; -2; 0; 2|] and f in [|1; 2; 1; -3|] and s = 1 downto 0|]..
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(a, c, f, i, m, s, v, w, y)
    for i in [:-2; 3; -1; 0; 2; 2; -3:]
    for y = -3 downto -2 and m = -2 to -2 and v = 0 to 0
    for c in [:0; 3:] and m = 2 to -1 and w = 0 downto 0
    for a in [:0; 2; -2; 0; 2:] and f in [:1; 2; 1; -3:] and s = 1 downto 0:];;
[%%expect{|
Lines 1-5, characters 0-77:
1 | [:(a, c, f, i, m, s, v, w, y)
2 |     for i in [:-2; 3; -1; 0; 2; 2; -3:]
3 |     for y = -3 downto -2 and m = -2 to -2 and v = 0 to 0
4 |     for c in [:0; 3:] and m = 2 to -1 and w = 0 downto 0
5 |     for a in [:0; 2; -2; 0; 2:] and f in [:1; 2; 1; -3:] and s = 1 downto 0:]..
Warning 26 [unused-var]: unused variable m.

- : (int * int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[(f, i, o, r, t, w)
   for i = 3 downto 1 and w = 3 downto 0
   for o in [-1; -3; -2; -3] and t in [0; 2; 1]
   for r = -2 downto 2 and f = -1 to -2];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(f, i, o, r, t, w)
    for i = 3 downto 1 and w = 3 downto 0
    for o in [|-1; -3; -2; -3|] and t in [|0; 2; 1|]
    for r = -2 downto 2 and f = -1 to -2|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(f, i, o, r, t, w)
    for i = 3 downto 1 and w = 3 downto 0
    for o in [:-1; -3; -2; -3:] and t in [:0; 2; 1:]
    for r = -2 downto 2 and f = -1 to -2:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(f, j, t, u)
   for f = -1 downto -2 and j in [1]
   for t = 1 to 2 and u in [-2; 1; -1; -3; 1; 2]];;
[%%expect{|
- : (int * int * int * int) list =
[(-1, 1, 1, -2); (-1, 1, 1, 1); (-1, 1, 1, -1); (-1, 1, 1, -3);
 (-1, 1, 1, 1); (-1, 1, 1, 2); (-1, 1, 2, -2); (-1, 1, 2, 1); (-1, 1, 2, -1);
 (-1, 1, 2, -3); (-1, 1, 2, 1); (-1, 1, 2, 2); (-2, 1, 1, -2); (-2, 1, 1, 1);
 (-2, 1, 1, -1); (-2, 1, 1, -3); (-2, 1, 1, 1); (-2, 1, 1, 2);
 (-2, 1, 2, -2); (-2, 1, 2, 1); (-2, 1, 2, -1); (-2, 1, 2, -3);
 (-2, 1, 2, 1); (-2, 1, 2, 2)]
|}];;

[|(f, j, t, u)
    for f = -1 downto -2 and j in [|1|]
    for t = 1 to 2 and u in [|-2; 1; -1; -3; 1; 2|]|];;
[%%expect{|
- : (int * int * int * int) array =
[|(-1, 1, 1, -2); (-1, 1, 1, 1); (-1, 1, 1, -1); (-1, 1, 1, -3);
  (-1, 1, 1, 1); (-1, 1, 1, 2); (-1, 1, 2, -2); (-1, 1, 2, 1);
  (-1, 1, 2, -1); (-1, 1, 2, -3); (-1, 1, 2, 1); (-1, 1, 2, 2);
  (-2, 1, 1, -2); (-2, 1, 1, 1); (-2, 1, 1, -1); (-2, 1, 1, -3);
  (-2, 1, 1, 1); (-2, 1, 1, 2); (-2, 1, 2, -2); (-2, 1, 2, 1);
  (-2, 1, 2, -1); (-2, 1, 2, -3); (-2, 1, 2, 1); (-2, 1, 2, 2)|]
|}];;

[:(f, j, t, u)
    for f = -1 downto -2 and j in [:1:]
    for t = 1 to 2 and u in [:-2; 1; -1; -3; 1; 2:]:];;
[%%expect{|
- : (int * int * int * int) iarray =
[:(-1, 1, 1, -2); (-1, 1, 1, 1); (-1, 1, 1, -1); (-1, 1, 1, -3);
  (-1, 1, 1, 1); (-1, 1, 1, 2); (-1, 1, 2, -2); (-1, 1, 2, 1);
  (-1, 1, 2, -1); (-1, 1, 2, -3); (-1, 1, 2, 1); (-1, 1, 2, 2);
  (-2, 1, 1, -2); (-2, 1, 1, 1); (-2, 1, 1, -1); (-2, 1, 1, -3);
  (-2, 1, 1, 1); (-2, 1, 1, 2); (-2, 1, 2, -2); (-2, 1, 2, 1);
  (-2, 1, 2, -1); (-2, 1, 2, -3); (-2, 1, 2, 1); (-2, 1, 2, 2):]
|}];;

[(d, m, o)
   for m in [1; -2; 3] and d in [-2; 1; -2; 0; 1; -1] and o in [2; 1; 1; -3]];;
[%%expect{|
- : (int * int * int) list =
[(-2, 1, 2); (-2, 1, 1); (-2, 1, 1); (-2, 1, -3); (1, 1, 2); (1, 1, 1);
 (1, 1, 1); (1, 1, -3); (-2, 1, 2); (-2, 1, 1); (-2, 1, 1); (-2, 1, -3);
 (0, 1, 2); (0, 1, 1); (0, 1, 1); (0, 1, -3); (1, 1, 2); (1, 1, 1);
 (1, 1, 1); (1, 1, -3); (-1, 1, 2); (-1, 1, 1); (-1, 1, 1); (-1, 1, -3);
 (-2, -2, 2); (-2, -2, 1); (-2, -2, 1); (-2, -2, -3); (1, -2, 2); (1, -2, 1);
 (1, -2, 1); (1, -2, -3); (-2, -2, 2); (-2, -2, 1); (-2, -2, 1);
 (-2, -2, -3); (0, -2, 2); (0, -2, 1); (0, -2, 1); (0, -2, -3); (1, -2, 2);
 (1, -2, 1); (1, -2, 1); (1, -2, -3); (-1, -2, 2); (-1, -2, 1); (-1, -2, 1);
 (-1, -2, -3); (-2, 3, 2); (-2, 3, 1); (-2, 3, 1); (-2, 3, -3); (1, 3, 2);
 (1, 3, 1); (1, 3, 1); (1, 3, -3); (-2, 3, 2); (-2, 3, 1); (-2, 3, 1);
 (-2, 3, -3); (0, 3, 2); (0, 3, 1); (0, 3, 1); (0, 3, -3); (1, 3, 2);
 (1, 3, 1); (1, 3, 1); (1, 3, -3); (-1, 3, 2); (-1, 3, 1); (-1, 3, 1);
 (-1, 3, -3)]
|}];;

[|(d, m, o)
    for m in [|1; -2; 3|]
    and d in [|-2; 1; -2; 0; 1; -1|]
    and o in [|2; 1; 1; -3|]|];;
[%%expect{|
- : (int * int * int) array =
[|(-2, 1, 2); (-2, 1, 1); (-2, 1, 1); (-2, 1, -3); (1, 1, 2); (1, 1, 1);
  (1, 1, 1); (1, 1, -3); (-2, 1, 2); (-2, 1, 1); (-2, 1, 1); (-2, 1, -3);
  (0, 1, 2); (0, 1, 1); (0, 1, 1); (0, 1, -3); (1, 1, 2); (1, 1, 1);
  (1, 1, 1); (1, 1, -3); (-1, 1, 2); (-1, 1, 1); (-1, 1, 1); (-1, 1, -3);
  (-2, -2, 2); (-2, -2, 1); (-2, -2, 1); (-2, -2, -3); (1, -2, 2);
  (1, -2, 1); (1, -2, 1); (1, -2, -3); (-2, -2, 2); (-2, -2, 1); (-2, -2, 1);
  (-2, -2, -3); (0, -2, 2); (0, -2, 1); (0, -2, 1); (0, -2, -3); (1, -2, 2);
  (1, -2, 1); (1, -2, 1); (1, -2, -3); (-1, -2, 2); (-1, -2, 1); (-1, -2, 1);
  (-1, -2, -3); (-2, 3, 2); (-2, 3, 1); (-2, 3, 1); (-2, 3, -3); (1, 3, 2);
  (1, 3, 1); (1, 3, 1); (1, 3, -3); (-2, 3, 2); (-2, 3, 1); (-2, 3, 1);
  (-2, 3, -3); (0, 3, 2); (0, 3, 1); (0, 3, 1); (0, 3, -3); (1, 3, 2);
  (1, 3, 1); (1, 3, 1); (1, 3, -3); (-1, 3, 2); (-1, 3, 1); (-1, 3, 1);
  (-1, 3, -3)|]
|}];;

[:(d, m, o)
    for m in [:1; -2; 3:]
    and d in [:-2; 1; -2; 0; 1; -1:]
    and o in [:2; 1; 1; -3:]:];;
[%%expect{|
- : (int * int * int) iarray =
[:(-2, 1, 2); (-2, 1, 1); (-2, 1, 1); (-2, 1, -3); (1, 1, 2); (1, 1, 1);
  (1, 1, 1); (1, 1, -3); (-2, 1, 2); (-2, 1, 1); (-2, 1, 1); (-2, 1, -3);
  (0, 1, 2); (0, 1, 1); (0, 1, 1); (0, 1, -3); (1, 1, 2); (1, 1, 1);
  (1, 1, 1); (1, 1, -3); (-1, 1, 2); (-1, 1, 1); (-1, 1, 1); (-1, 1, -3);
  (-2, -2, 2); (-2, -2, 1); (-2, -2, 1); (-2, -2, -3); (1, -2, 2);
  (1, -2, 1); (1, -2, 1); (1, -2, -3); (-2, -2, 2); (-2, -2, 1); (-2, -2, 1);
  (-2, -2, -3); (0, -2, 2); (0, -2, 1); (0, -2, 1); (0, -2, -3); (1, -2, 2);
  (1, -2, 1); (1, -2, 1); (1, -2, -3); (-1, -2, 2); (-1, -2, 1); (-1, -2, 1);
  (-1, -2, -3); (-2, 3, 2); (-2, 3, 1); (-2, 3, 1); (-2, 3, -3); (1, 3, 2);
  (1, 3, 1); (1, 3, 1); (1, 3, -3); (-2, 3, 2); (-2, 3, 1); (-2, 3, 1);
  (-2, 3, -3); (0, 3, 2); (0, 3, 1); (0, 3, 1); (0, 3, -3); (1, 3, 2);
  (1, 3, 1); (1, 3, 1); (1, 3, -3); (-1, 3, 2); (-1, 3, 1); (-1, 3, 1);
  (-1, 3, -3):]
|}];;

[(d, g, h, k, m, p, t)
   for k = -2 downto -3 and t in [0; -1; -1; -2; 1]
   for h in [-2; -3; 2; 3; 2]
   for d = k to 0 and g = t to -3
   when abs d mod 2 = 1
   for m = -1 downto 2 and p = 1 to 3];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(d, g, h, k, m, p, t)
    for k = -2 downto -3 and t in [|0; -1; -1; -2; 1|]
    for h in [|-2; -3; 2; 3; 2|]
    for d = k to 0 and g = t to -3
    when abs d mod 2 = 1
    for m = -1 downto 2 and p = 1 to 3|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(d, g, h, k, m, p, t)
    for k = -2 downto -3 and t in [:0; -1; -1; -2; 1:]
    for h in [:-2; -3; 2; 3; 2:]
    for d = k to 0 and g = t to -3
    when abs d mod 2 = 1
    for m = -1 downto 2 and p = 1 to 3:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(a, d, e, g, v, z)
   for d = 2 downto 1
   for g = 2 to -1 and v in [-2] and d in [-1; -3] and a in [2; 2; 1; 0; 2]
   for e in [2; 3] and z = 1 downto 3 and g = -2 to -2];;
[%%expect{|
Lines 1-4, characters 0-55:
1 | [(a, d, e, g, v, z)
2 |    for d = 2 downto 1
3 |    for g = 2 to -1 and v in [-2] and d in [-1; -3] and a in [2; 2; 1; 0; 2]
4 |    for e in [2; 3] and z = 1 downto 3 and g = -2 to -2]..
Warning 26 [unused-var]: unused variable d.

Lines 1-4, characters 0-55:
1 | [(a, d, e, g, v, z)
2 |    for d = 2 downto 1
3 |    for g = 2 to -1 and v in [-2] and d in [-1; -3] and a in [2; 2; 1; 0; 2]
4 |    for e in [2; 3] and z = 1 downto 3 and g = -2 to -2]..
Warning 26 [unused-var]: unused variable g.

- : (int * int * int * int * int * int) list = []
|}];;

[|(b, c, r, t, z)
    for r in [|1; -3|] and b in [|-3; 2; -2; 1; -2; -3|]
    for c in [|3; -1; 2; -3; 2; 1; -3|] and t in [||] and z = 3 to -2
    when abs t mod 2 = 1
    when abs r mod 2 = 0|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(b, c, r, t, z)
    for r in [:1; -3:] and b in [:-3; 2; -2; 1; -2; -3:]
    for c in [:3; -1; 2; -3; 2; 1; -3:] and t in [::] and z = 3 to -2
    when abs t mod 2 = 1
    when abs r mod 2 = 0:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(b, c, d, j, t, x)
   for x in [-3; 2; -3] and d in [-3; -2] and b in [3; -2; 3; 2; -1; 3]
   for j = -2 downto 3 and _ in [-3; -1]
   when j <> 0
   for c = -3 downto x and t in [1; 2]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(b, c, d, j, t, x)
    for x in [|-3; 2; -3|] and d in [|-3; -2|] and b in [|3; -2; 3; 2; -1; 3|]
    for j = -2 downto 3 and _ in [|-3; -1|]
    when j <> 0
    for c = -3 downto x and t in [|1; 2|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(b, c, d, j, t, x)
    for x in [:-3; 2; -3:] and d in [:-3; -2:] and b in [:3; -2; 3; 2; -1; 3:]
    for j = -2 downto 3 and _ in [:-3; -1:]
    when j <> 0
    for c = -3 downto x and t in [:1; 2:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(h, w) for w in [0; -1] and h in [-2; 1; -3; 3; -3; -2; -3]];;
[%%expect{|
- : (int * int) list =
[(-2, 0); (1, 0); (-3, 0); (3, 0); (-3, 0); (-2, 0); (-3, 0); (-2, -1);
 (1, -1); (-3, -1); (3, -1); (-3, -1); (-2, -1); (-3, -1)]
|}];;

[|(h, w) for w in [|0; -1|] and h in [|-2; 1; -3; 3; -3; -2; -3|]|];;
[%%expect{|
- : (int * int) array =
[|(-2, 0); (1, 0); (-3, 0); (3, 0); (-3, 0); (-2, 0); (-3, 0); (-2, -1);
  (1, -1); (-3, -1); (3, -1); (-3, -1); (-2, -1); (-3, -1)|]
|}];;

[:(h, w) for w in [:0; -1:] and h in [:-2; 1; -3; 3; -3; -2; -3:]:];;
[%%expect{|
- : (int * int) iarray =
[:(-2, 0); (1, 0); (-3, 0); (3, 0); (-3, 0); (-2, 0); (-3, 0); (-2, -1);
  (1, -1); (-3, -1); (3, -1); (-3, -1); (-2, -1); (-3, -1):]
|}];;

[(e, h, k, p, t, v)
   for v in [2; 0; 2; 0; -3; 2]
   for h in [2; 3; -1; -2; -3] and p = 2 downto 0 and t in []
   for k in [0; -3]
   for v in [-3] and _ in [k; 2; -3; -3] and e = 0 downto -3];;
[%%expect{|
Line 2, characters 7-8:
2 |    for v in [2; 0; 2; 0; -3; 2]
           ^
Warning 26 [unused-var]: unused variable v.

- : (int * int * int * int * 'a * int) list = []
|}];;

[|(e, h, k, p, t, v)
    for v in [|2; 0; 2; 0; -3; 2|]
    for h in [|2; 3; -1; -2; -3|] and p = 2 downto 0 and t in [||]
    for k in [|0; -3|]
    for v in [|-3|] and _ in [|k; 2; -3; -3|] and e = 0 downto -3|];;
[%%expect{|
Line 2, characters 8-9:
2 |     for v in [|2; 0; 2; 0; -3; 2|]
            ^
Warning 26 [unused-var]: unused variable v.

- : (int * int * int * int * '_weak62 * int) array = [||]
|}];;

[:(e, h, k, p, t, v)
    for v in [:2; 0; 2; 0; -3; 2:]
    for h in [:2; 3; -1; -2; -3:] and p = 2 downto 0 and t in [::]
    for k in [:0; -3:]
    for v in [:-3:] and _ in [:k; 2; -3; -3:] and e = 0 downto -3:];;
[%%expect{|
Line 2, characters 8-9:
2 |     for v in [:2; 0; 2; 0; -3; 2:]
            ^
Warning 26 [unused-var]: unused variable v.

- : (int * int * int * int * 'a * int) iarray = [::]
|}];;

[b for b = 3 to -3 when abs b mod 2 = 0 when b > 0];;
[%%expect{|
- : int list = []
|}];;

[|b for b = 3 to -3 when abs b mod 2 = 0 when b > 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:b for b = 3 to -3 when abs b mod 2 = 0 when b > 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(b, f, l, p, q, u)
   for l in [-1; -3]
   when l > 0
   for f = -1 to 0 and q = 2 downto 3 and b = 2 to l
   for p = l downto 3 and u in [2]];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(b, f, l, p, q, u)
    for l in [|-1; -3|]
    when l > 0
    for f = -1 to 0 and q = 2 downto 3 and b = 2 to l
    for p = l downto 3 and u in [|2|]|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(b, f, l, p, q, u)
    for l in [:-1; -3:]
    when l > 0
    for f = -1 to 0 and q = 2 downto 3 and b = 2 to l
    for p = l downto 3 and u in [:2:]:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[(a, l, s, t, v, z)
   for a in [-3] and v in [0; 1; 3; 0; -1; -3]
   for t in [2] and s = 0 to 2 and l = 1 to a and z = 1 to 1];;
[%%expect{|
- : (int * int * int * int * int * int) list = []
|}];;

[|(a, l, s, t, v, z)
    for a in [|-3|] and v in [|0; 1; 3; 0; -1; -3|]
    for t in [|2|] and s = 0 to 2 and l = 1 to a and z = 1 to 1|];;
[%%expect{|
- : (int * int * int * int * int * int) array = [||]
|}];;

[:(a, l, s, t, v, z)
    for a in [:-3:] and v in [:0; 1; 3; 0; -1; -3:]
    for t in [:2:] and s = 0 to 2 and l = 1 to a and z = 1 to 1:];;
[%%expect{|
- : (int * int * int * int * int * int) iarray = [::]
|}];;

[y for y = 2 downto 3 when abs y mod 2 = 0];;
[%%expect{|
- : int list = []
|}];;

[|y for y = 2 downto 3 when abs y mod 2 = 0|];;
[%%expect{|
- : int array = [||]
|}];;

[:y for y = 2 downto 3 when abs y mod 2 = 0:];;
[%%expect{|
- : int iarray = [::]
|}];;

[(d, f, g, h, p, u, z)
   for d in [1; -1] and h in [-1; 3]
   for f = -2 downto d and u in []
   for z in [h; -2; -2; 2; -2] and g = 2 downto 3
   for p in [2; 0]
   when abs u mod 2 = 1];;
[%%expect{|
- : (int * int * int * int * int * int * int) list = []
|}];;

[|(d, f, g, h, p, u, z)
    for d in [|1; -1|] and h in [|-1; 3|]
    for f = -2 downto d and u in [||]
    for z in [|h; -2; -2; 2; -2|] and g = 2 downto 3
    for p in [|2; 0|]
    when abs u mod 2 = 1|];;
[%%expect{|
- : (int * int * int * int * int * int * int) array = [||]
|}];;

[:(d, f, g, h, p, u, z)
    for d in [:1; -1:] and h in [:-1; 3:]
    for f = -2 downto d and u in [::]
    for z in [:h; -2; -2; 2; -2:] and g = 2 downto 3
    for p in [:2; 0:]
    when abs u mod 2 = 1:];;
[%%expect{|
- : (int * int * int * int * int * int * int) iarray = [::]
|}];;

[(r, s) for r in [0; 2; -2] and s in [1; -1]];;
[%%expect{|
- : (int * int) list = [(0, 1); (0, -1); (2, 1); (2, -1); (-2, 1); (-2, -1)]
|}];;

[|(r, s) for r in [|0; 2; -2|] and s in [|1; -1|]|];;
[%%expect{|
- : (int * int) array =
[|(0, 1); (0, -1); (2, 1); (2, -1); (-2, 1); (-2, -1)|]
|}];;

[:(r, s) for r in [:0; 2; -2:] and s in [:1; -1:]:];;
[%%expect{|
- : (int * int) iarray =
[:(0, 1); (0, -1); (2, 1); (2, -1); (-2, 1); (-2, -1):]
|}];;

[(e, h, i, r, y)
   for _ = 0 downto 0 and i in [0; -1; 0]
   for h in [0; 0; i]
   for e = -1 downto 3 and i = 0 downto -1
   for y = 3 to 3 and r in [-2; 1; 0; 0; 0]];;
[%%expect{|
- : (int * int * int * int * int) list = []
|}];;

[|(e, h, i, r, y)
    for _ = 0 downto 0 and i in [|0; -1; 0|]
    for h in [|0; 0; i|]
    for e = -1 downto 3 and i = 0 downto -1
    for y = 3 to 3 and r in [|-2; 1; 0; 0; 0|]|];;
[%%expect{|
- : (int * int * int * int * int) array = [||]
|}];;

[:(e, h, i, r, y)
    for _ = 0 downto 0 and i in [:0; -1; 0:]
    for h in [:0; 0; i:]
    for e = -1 downto 3 and i = 0 downto -1
    for y = 3 to 3 and r in [:-2; 1; 0; 0; 0:]:];;
[%%expect{|
- : (int * int * int * int * int) iarray = [::]
|}];;

[(e, j) for e in [3; 0; -1] and j in [3; 3; -1; 1; 3]];;
[%%expect{|
- : (int * int) list =
[(3, 3); (3, 3); (3, -1); (3, 1); (3, 3); (0, 3); (0, 3); (0, -1); (0, 1);
 (0, 3); (-1, 3); (-1, 3); (-1, -1); (-1, 1); (-1, 3)]
|}];;

[|(e, j) for e in [|3; 0; -1|] and j in [|3; 3; -1; 1; 3|]|];;
[%%expect{|
- : (int * int) array =
[|(3, 3); (3, 3); (3, -1); (3, 1); (3, 3); (0, 3); (0, 3); (0, -1); (0, 1);
  (0, 3); (-1, 3); (-1, 3); (-1, -1); (-1, 1); (-1, 3)|]
|}];;

[:(e, j) for e in [:3; 0; -1:] and j in [:3; 3; -1; 1; 3:]:];;
[%%expect{|
- : (int * int) iarray =
[:(3, 3); (3, 3); (3, -1); (3, 1); (3, 3); (0, 3); (0, 3); (0, -1); (0, 1);
  (0, 3); (-1, 3); (-1, 3); (-1, -1); (-1, 1); (-1, 3):]
|}];;

[(r, u) for r in [2; 0] for u in [-2; r; 2]];;
[%%expect{|
- : (int * int) list = [(2, -2); (2, 2); (2, 2); (0, -2); (0, 0); (0, 2)]
|}];;

[|(r, u) for r in [|2; 0|] for u in [|-2; r; 2|]|];;
[%%expect{|
- : (int * int) array = [|(2, -2); (2, 2); (2, 2); (0, -2); (0, 0); (0, 2)|]
|}];;

[:(r, u) for r in [:2; 0:] for u in [:-2; r; 2:]:];;
[%%expect{|
- : (int * int) iarray = [:(2, -2); (2, 2); (2, 2); (0, -2); (0, 0); (0, 2):]
|}];;

[(c, d, k, o, t, v)
   for c = -3 to 2 and v in [1; 0; 1; 0; -3]
   for o = 2 to -2 and k in [-2; 3; -3; c; -1] and _ in [2; 2] and t in []
   for d in [3; -1; -3; -3; -3; -1]];;
[%%expect{|
- : (int * int * int * int * 'a * int) list = []
|}];;

[|(n, r, w)
    for w in [|0|] and n in [|2; 2; 2; -3; -1|]
    when n <> 0
    for r = -2 downto 3
    when abs n mod 2 = 0
    when r > 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(n, r, w)
    for w in [:0:] and n in [:2; 2; 2; -3; -1:]
    when n <> 0
    for r = -2 downto 3
    when abs n mod 2 = 0
    when r > 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(d, e, l, n, u)
   for u = -2 to 3 and d = -3 to 2 and n in [1; -1; -2]
   when n < 0
   when d > 0
   for e in [3; 2] and l = 0 downto 2 and u = 3 downto -3];;
[%%expect{|
Lines 1-5, characters 0-58:
1 | [(d, e, l, n, u)
2 |    for u = -2 to 3 and d = -3 to 2 and n in [1; -1; -2]
3 |    when n < 0
4 |    when d > 0
5 |    for e in [3; 2] and l = 0 downto 2 and u = 3 downto -3]..
Warning 26 [unused-var]: unused variable u.

- : (int * int * int * int * int) list = []
|}];;

[|(d, e, l, n, u)
    for u = -2 to 3 and d = -3 to 2 and n in [|1; -1; -2|]
    when n < 0
    when d > 0
    for e in [|3; 2|] and l = 0 downto 2 and u = 3 downto -3|];;
[%%expect{|
Lines 1-5, characters 0-62:
1 | [|(d, e, l, n, u)
2 |     for u = -2 to 3 and d = -3 to 2 and n in [|1; -1; -2|]
3 |     when n < 0
4 |     when d > 0
5 |     for e in [|3; 2|] and l = 0 downto 2 and u = 3 downto -3|]..
Warning 26 [unused-var]: unused variable u.

- : (int * int * int * int * int) array = [||]
|}];;

[:(d, e, l, n, u)
    for u = -2 to 3 and d = -3 to 2 and n in [:1; -1; -2:]
    when n < 0
    when d > 0
    for e in [:3; 2:] and l = 0 downto 2 and u = 3 downto -3:];;
[%%expect{|
Lines 1-5, characters 0-62:
1 | [:(d, e, l, n, u)
2 |     for u = -2 to 3 and d = -3 to 2 and n in [:1; -1; -2:]
3 |     when n < 0
4 |     when d > 0
5 |     for e in [:3; 2:] and l = 0 downto 2 and u = 3 downto -3:]..
Warning 26 [unused-var]: unused variable u.

- : (int * int * int * int * int) iarray = [::]
|}];;

[(c, v) for c = 3 downto -1 and v in [0; -3; -3; 2] when abs c mod 2 = 0];;
[%%expect{|
- : (int * int) list =
[(2, 0); (2, -3); (2, -3); (2, 2); (0, 0); (0, -3); (0, -3); (0, 2)]
|}];;

[|(c, v) for c = 3 downto -1 and v in [|0; -3; -3; 2|] when abs c mod 2 = 0|];;
[%%expect{|
- : (int * int) array =
[|(2, 0); (2, -3); (2, -3); (2, 2); (0, 0); (0, -3); (0, -3); (0, 2)|]
|}];;

[:(c, v) for c = 3 downto -1 and v in [:0; -3; -3; 2:] when abs c mod 2 = 0:];;
[%%expect{|
- : (int * int) iarray =
[:(2, 0); (2, -3); (2, -3); (2, 2); (0, 0); (0, -3); (0, -3); (0, 2):]
|}];;

[(d, e, x)
   for x in [-2; 1]
   when abs x mod 2 = 1
   for d = 2 to -3 and e = 0 downto 0];;
[%%expect{|
- : (int * int * int) list = []
|}];;

[|(d, e, x)
    for x in [|-2; 1|]
    when abs x mod 2 = 1
    for d = 2 to -3 and e = 0 downto 0|];;
[%%expect{|
- : (int * int * int) array = [||]
|}];;

[:(d, e, x)
    for x in [:-2; 1:]
    when abs x mod 2 = 1
    for d = 2 to -3 and e = 0 downto 0:];;
[%%expect{|
- : (int * int * int) iarray = [::]
|}];;

[(d, h, k, m, r, s, w, x)
   for s = 1 to 1 and w = 0 to 1
   for d in [3; 2; 3; 3; -2] and r in []
   for m in [] and h in [-3; 2; -3; 2; 2; 1]
   for k = 1 downto r and h in [1; 2; 1; 3; 3] and x in [0]];;
[%%expect{|
Line 4, characters 19-20:
4 |    for m in [] and h in [-3; 2; -3; 2; 2; 1]
                       ^
Warning 26 [unused-var]: unused variable h.

- : (int * int * int * 'a * int * int * int * int) list = []
|}];;

[|(d, h, k, m, r, s, w, x)
    for s = 1 to 1 and w = 0 to 1
    for d in [|3; 2; 3; 3; -2|] and r in [||]
    for m in [||] and h in [|-3; 2; -3; 2; 2; 1|]
    for k = 1 downto r and h in [|1; 2; 1; 3; 3|] and x in [|0|]|];;
[%%expect{|
Line 4, characters 22-23:
4 |     for m in [||] and h in [|-3; 2; -3; 2; 2; 1|]
                          ^
Warning 26 [unused-var]: unused variable h.

- : (int * int * int * '_weak63 * int * int * int * int) array = [||]
|}];;

[:(d, h, k, m, r, s, w, x)
    for s = 1 to 1 and w = 0 to 1
    for d in [:3; 2; 3; 3; -2:] and r in [::]
    for m in [::] and h in [:-3; 2; -3; 2; 2; 1:]
    for k = 1 downto r and h in [:1; 2; 1; 3; 3:] and x in [:0:]:];;
[%%expect{|
Line 4, characters 22-23:
4 |     for m in [::] and h in [:-3; 2; -3; 2; 2; 1:]
                          ^
Warning 26 [unused-var]: unused variable h.

- : (int * int * int * 'a * int * int * int * int) iarray = [::]
|}];;

[(d, f, g, l, o, p, t, z)
   for f in [-2] and o in [-1; -2; -3]
   for d = -3 downto -2 and p = 0 to 0
   for l = -1 to -3
   for z in [1; 1; 0; 3; -3] and g = 3 downto 1 and t = -2 to -2];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) list = []
|}];;

[|(d, f, g, l, o, p, t, z)
    for f in [|-2|] and o in [|-1; -2; -3|]
    for d = -3 downto -2 and p = 0 to 0
    for l = -1 to -3
    for z in [|1; 1; 0; 3; -3|] and g = 3 downto 1 and t = -2 to -2|];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) array = [||]
|}];;

[:(d, f, g, l, o, p, t, z)
    for f in [:-2:] and o in [:-1; -2; -3:]
    for d = -3 downto -2 and p = 0 to 0
    for l = -1 to -3
    for z in [:1; 1; 0; 3; -3:] and g = 3 downto 1 and t = -2 to -2:];;
[%%expect{|
- : (int * int * int * int * int * int * int * int) iarray = [::]
|}];;

[s for s in [3; -3; 0; -3; -2; -2; 1] when s > 0];;
[%%expect{|
- : int list = [3; 1]
|}];;

[|s for s in [|3; -3; 0; -3; -2; -2; 1|] when s > 0|];;
[%%expect{|
- : int array = [|3; 1|]
|}];;

[:s for s in [:3; -3; 0; -3; -2; -2; 1:] when s > 0:];;
[%%expect{|
- : int iarray = [:3; 1:]
|}];;

[(c, h, l, n)
   for _ = 0 to 2 and c in [3; -2]
   for l in [-2; 0; -2; -3; -3; c; 0]
   when l < 0
   for n in [] and h in [1; 3; -3; 1; 3; 0]
   when c > 0];;
[%%expect{|
- : (int * int * int * 'a) list = []
|}];;

[|(c, h, l, n)
    for _ = 0 to 2 and c in [|3; -2|]
    for l in [|-2; 0; -2; -3; -3; c; 0|]
    when l < 0
    for n in [||] and h in [|1; 3; -3; 1; 3; 0|]
    when c > 0|];;
[%%expect{|
- : (int * int * int * '_weak64) array = [||]
|}];;

[:(c, h, l, n)
    for _ = 0 to 2 and c in [:3; -2:]
    for l in [:-2; 0; -2; -3; -3; c; 0:]
    when l < 0
    for n in [::] and h in [:1; 3; -3; 1; 3; 0:]
    when c > 0:];;
[%%expect{|
- : (int * int * int * 'a) iarray = [::]
|}];;
